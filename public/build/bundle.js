var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function a(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}const c="undefined"!=typeof window;let l=c?()=>window.performance.now():()=>Date.now(),h=c?e=>requestAnimationFrame(e):e;const f=new Set;function p(e){f.forEach(t=>{t.c(e)||(f.delete(t),t.f())}),0!==f.size&&h(p)}function d(e){let t;return 0===f.size&&h(p),{promise:new Promise(n=>{f.add(t={c:e,f:n})}),abort(){f.delete(t)}}}function v(e,t){e.appendChild(t)}function y(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode.removeChild(e)}function g(e){return document.createElement(e)}function b(e){return document.createTextNode(e)}function _(){return b(" ")}function w(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function C(e,t){t=""+t,e.data!==t&&(e.data=t)}function S(e,t){(null!=t||e.value)&&(e.value=t)}function E(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function I(e,t,n){e.classList[n?"add":"remove"](t)}let k,P,R=0,N={};function x(e,t,n,r,i,o,a,s=0){const u=16.666/r;let c="{\n";for(let e=0;e<=1;e+=u){const r=t+(n-t)*o(e);c+=100*e+`%{${a(r,1-r)}}\n`}const l=c+`100% {${a(n,1-n)}}\n}`,h=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(l)}_${s}`;if(!N[h]){if(!k){const e=g("style");document.head.appendChild(e),k=e.sheet}N[h]=!0,k.insertRule(`@keyframes ${h} ${l}`,k.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${h} ${r}ms linear ${i}ms 1 both`,R+=1,h}function A(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--R&&h(()=>{if(R)return;let e=k.cssRules.length;for(;e--;)k.deleteRule(e);N={}})}function D(e){P=e}function O(){if(!P)throw new Error("Function called outside component initialization");return P}function M(e,t){O().$$.context.set(e,t)}const L=[],F=[],j=[],U=[],V=Promise.resolve();let q=!1;function B(e){j.push(e)}let G=!1;const K=new Set;function W(){if(!G){G=!0;do{for(let e=0;e<L.length;e+=1){const t=L[e];D(t),z(t.$$)}for(L.length=0;F.length;)F.pop()();for(let e=0;e<j.length;e+=1){const t=j[e];K.has(t)||(K.add(t),t())}j.length=0}while(L.length);for(;U.length;)U.pop()();q=!1,G=!1,K.clear()}}function z(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}let H;function Q(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const $=new Set;let Y;function X(){Y={r:0,c:[],p:Y}}function J(){Y.r||o(Y.c),Y=Y.p}function Z(e,t){e&&e.i&&($.delete(e),e.i(t))}function ee(e,t,n,r){if(e&&e.o){if($.has(e))return;$.add(e),Y.c.push(()=>{$.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const te={duration:0};function ne(n,r,i,s){let u=r(n,i),c=s?0:1,h=null,f=null,p=null;function v(){p&&A(n,p)}function y(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(r){const{delay:i=0,duration:a=300,easing:s=t,tick:m=e,css:g}=u||te,b={start:l()+i,b:r};r||(b.group=Y,Y.r+=1),h?f=b:(g&&(v(),p=x(n,c,r,a,i,s,g)),r&&m(0,1),h=y(b,a),B(()=>Q(n,r,"start")),d(e=>{if(f&&e>f.start&&(h=y(f,a),f=null,Q(n,h.b,"start"),g&&(v(),p=x(n,c,h.b,h.duration,0,s,u.css))),h)if(e>=h.end)m(c=h.b,1-c),Q(n,h.b,"end"),f||(h.b?v():--h.group.r||o(h.group.c)),h=null;else if(e>=h.start){const t=e-h.start;c=h.a+h.d*s(t/h.duration),m(c,1-c)}return!(!h&&!f)}))}return{run(e){a(u)?(H||(H=Promise.resolve(),H.then(()=>{H=null})),H).then(()=>{u=u(),m(e)}):m(e)},end(){v(),h=f=null}}}function re(e){e&&e.c()}function ie(e,t,n){const{fragment:i,on_mount:s,on_destroy:u,after_update:c}=e.$$;i&&i.m(t,n),B(()=>{const t=s.map(r).filter(a);u?u.push(...t):o(t),e.$$.on_mount=[]}),c.forEach(B)}function oe(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ae(e,t){-1===e.$$.dirty[0]&&(L.push(e),q||(q=!0,V.then(W)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function se(t,n,r,a,s,u,c=[-1]){const l=P;D(t);const h=n.props||{},f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:s,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:i(),dirty:c};let p=!1;f.ctx=r?r(t,h,(e,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=i)&&(f.bound[e]&&f.bound[e](i),p&&ae(t,e)),n}):[],f.update(),p=!0,o(f.before_update),f.fragment=!!a&&a(f.ctx),n.target&&(n.hydrate?f.fragment&&f.fragment.l(function(e){return Array.from(e.childNodes)}(n.target)):f.fragment&&f.fragment.c(),n.intro&&Z(t.$$.fragment),ie(t,n.target,n.anchor),W()),D(l)}class ue{$destroy(){oe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const ce=[];function le(t,n=e){let r;const i=[];function o(e){if(s(t,e)&&(t=e,r)){const e=!ce.length;for(let e=0;e<i.length;e+=1){const n=i[e];n[1](),ce.push(n,t)}if(e){for(let e=0;e<ce.length;e+=2)ce[e][0](ce[e+1]);ce.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(a,s=e){const u=[a,s];return i.push(u),1===i.length&&(r=n(o)||e),a(t),()=>{const e=i.indexOf(u);-1!==e&&i.splice(e,1),0===i.length&&(r(),r=null)}}}}const he=le("login"),fe=le(!1),pe=le(null),de=le([]);class ve{constructor(){this.keyFunctions={}}assignFunction(e,t){this.keyFunctions[e]=t}run(e,t){this.keyFunctions.hasOwnProperty(e)?null!=t?this.keyFunctions[e](t):this.keyFunctions[e]():console.warn(`any callback associated with '${e}'`)}}const ye=new ve,me=le({scale:1}),ge=new ve,be=le([!1,!1,!1,!1]);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var _e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},we=function(e,t){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ce=!1,Se="${JSCORE_VERSION}",Ee=function(e,t){if(!e)throw Ie(t)},Ie=function(e){return new Error("Firebase Database ("+Se+") INTERNAL ASSERT FAILED: "+e)},ke=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Pe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ke(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Re=function(e){try{return Pe.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ne(e){return xe(void 0,e)}function xe(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=xe(e[n],t[n]));return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ae=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function De(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Te({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Pe.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Pe.encodeString(JSON.stringify(o),!1),""].join(".")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oe(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Me(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oe())}function Le(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function Fe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function je(){return!0===Ce}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ue=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Ve.prototype.create),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}we(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),Ve=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?qe(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new Ue(i,s,r);return u},e}();function qe(e,t){return e.replace(Be,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var Be=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ge(e){return JSON.parse(e)}function Ke(e){return JSON.stringify(e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var We=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=Ge(Re(o[0])||""),n=Ge(Re(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ze(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function He(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Qe(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function $e(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ye=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function Xe(e,t){var n=new Je(e,t);return n.subscribe.bind(n)}var Je=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Ze),void 0===r.error&&(r.error=Ze),void 0===r.complete&&(r.complete=Ze);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function Ze(){}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var et=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function tt(e,t){return e+" failed: "+t+" argument "}function nt(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(tt(e,t)+"must be a valid function.")}function rt(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(tt(e,t)+"must be a valid context object.")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var it=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ot(e){return e&&e._delegate?e._delegate:e}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function at(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function st(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function ut(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ct(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function lt(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}var ht=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),ft=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Ae;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(e){}try{for(var r=ut(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=ct(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService({instanceIdentifier:u});s.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return at(this,void 0,void 0,(function(){var e;return st(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(lt(lt([],ct(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),ct(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e="[DEFAULT]"),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var s=ut(this.instancesDeferred.entries()),u=s.next();!u.done;u=s.next()){var c=ct(u.value,2),l=c[0],h=c[1];o===this.normalizeInstanceIdentifier(l)&&h.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return this.invokeOnInitCallbacks(a,o),a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=ut(i),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,"[DEFAULT]"===t?void 0:t),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(e){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e="[DEFAULT]"),this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var pt,dt=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new ft(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function vt(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yt,mt=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(yt||(yt={}));var gt,bt={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},_t=yt.INFO,wt=((pt={})[yt.DEBUG]="log",pt[yt.VERBOSE]="log",pt[yt.INFO]="info",pt[yt.WARN]="warn",pt[yt.ERROR]="error",pt),Tt=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=wt[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,vt(["["+i+"]  "+e.name+":"],n))}},Ct=function(){function e(e){this.name=e,this._logLevel=_t,this._logHandler=Tt,this._userLogHandler=null,mt.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in yt))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?bt[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,vt([this,yt.DEBUG],e)),this._logHandler.apply(this,vt([this,yt.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,vt([this,yt.VERBOSE],e)),this._logHandler.apply(this,vt([this,yt.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,vt([this,yt.INFO],e)),this._logHandler.apply(this,vt([this,yt.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,vt([this,yt.WARN],e)),this._logHandler.apply(this,vt([this,yt.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,vt([this,yt.ERROR],e)),this._logHandler.apply(this,vt([this,yt.ERROR],e))},e}();function St(e){mt.forEach((function(t){t.setLogLevel(e)}))}var Et,It=((gt={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",gt["bad-app-name"]="Illegal App name: '{$appName}",gt["duplicate-app"]="Firebase App named '{$appName}' already exists",gt["app-deleted"]="Firebase App named '{$appName}' already deleted",gt["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",gt["invalid-log-argument"]="First argument to `onLog` must be null or a function.",gt),kt=new Ve("app","Firebase",It),Pt="@firebase/app",Rt=((Et={})[Pt]="fire-core",Et["@firebase/analytics"]="fire-analytics",Et["@firebase/app-check"]="fire-app-check",Et["@firebase/auth"]="fire-auth",Et["@firebase/database"]="fire-rtdb",Et["@firebase/functions"]="fire-fn",Et["@firebase/installations"]="fire-iid",Et["@firebase/messaging"]="fire-fcm",Et["@firebase/performance"]="fire-perf",Et["@firebase/remote-config"]="fire-rc",Et["@firebase/storage"]="fire-gcs",Et["@firebase/firestore"]="fire-fst",Et["fire-js"]="fire-js",Et["firebase-wrapper"]="fire-js-all",Et),Nt=new Ct("@firebase/app"),xt=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Ne(e),this.container=new dt(t.name),this._addComponent(new ht("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(e){return r._addComponent(e)}))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){var n;void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){Nt.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw kt.create("app-deleted",{appName:this.name_})},e}();xt.prototype.name&&xt.prototype.options||xt.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function At(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw kt.create("bad-app-name",{appName:String(a)});if(ze(t,a))throw kt.create("duplicate-app",{appName:a});var s=new e(n,o,r);return t[a]=s,s},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=Rt[e])&&void 0!==r?r:e;n&&(i+="-"+n);var a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){var u=['Unable to register library "'+i+'" with version "'+t+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&s&&u.push("and"),s&&u.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void Nt.warn(u.join(" "))}o(new ht(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},setLogLevel:St,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw kt.create("invalid-log-argument");!function(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=bt[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:yt[n].toLowerCase(),message:a,args:i,type:t.name})}},r=0,i=mt;r<i.length;r++){n(i[r])}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t)},apps:null,SDK_VERSION:"8.6.8",INTERNAL:{registerComponent:o,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){if("serverAuth"===t)return null;return t}}};function i(e){if(!ze(t,e=e||"[DEFAULT]"))throw kt.create("no-app",{appName:e});return t[e]}function o(o){var a=o.name;if(n.has(a))return Nt.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===o.type?r[a]:null;if(n.set(a,o),"PUBLIC"===o.type){var s=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[a])throw kt.create("invalid-app-argument",{appName:a});return e[a]()};void 0!==o.serviceProps&&xe(s,o.serviceProps),r[a]=s,e.prototype[a]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,a);return n.apply(this,o.multipleInstances?e:[])}}for(var u=0,c=Object.keys(t);u<c.length;u++){var l=c[u];t[l]._addComponent(o)}return"PUBLIC"===o.type?r[a]:null}return(r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Dt=function e(){var t=At(xt);return t.INTERNAL=_e(_e({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){xe(t,e)},createSubscribe:Xe,ErrorFactory:Ve,deepExtend:xe}),t}(),Ot=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Nt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Mt=self.firebase.SDK_VERSION;Mt&&Mt.indexOf("LITE")>=0&&Nt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Lt=Dt.initializeApp;Dt.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Le()&&Nt.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Lt.apply(void 0,e)};var Ft=Dt;!function(e,t){e.INTERNAL.registerComponent(new ht("platform-logger",(function(e){return new Ot(e)}),"PRIVATE")),e.registerVersion(Pt,"0.6.27",t),e.registerVersion("fire-js","")}(Ft);
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ft.registerVersion("firebase","8.6.8","app"),Ft.SDK_VERSION="8.6.8",function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};var n=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}return globalThis}(this);function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}!function(e,r){if(r){var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Promise",(function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function r(){this.a=null}function o(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;r.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c((function(){t.g()}))}this.a.push(e)};var a=n.setTimeout;r.prototype.c=function(e){a(e,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.f(e)}}}this.a=null},r.prototype.f=function(e){this.c((function(){throw e}))},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.g)}},t.prototype.m=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.s(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.h(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.g(e)}"function"==typeof t?this.u(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new r;return t.prototype.s=function(e){var t=this.f();e.Ra(t.resolve,t.reject)},t.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.Ra(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Ra=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=o,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=i(e),a=r.next();!a.done;a=r.next())o(a.value).Ra(t,n)}))},t.all=function(e){var n=i(e),r=n.next();return r.done?o([]):new t((function(e,t){function i(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,o(r.value).Ra(i(a.length-1),t),r=n.next()}while(!r.done)}))},t}));var o=o||{},a=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&s.test(e)?e:""}function l(){}function h(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function f(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){return"function"==h(e)}function d(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function m(e,t,n){return e.call.apply(e.bind,arguments)}function g(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function b(e,t,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function _(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function w(e,t){function n(){}n.prototype=t.prototype,e.bb=t.prototype,e.prototype=new n,e.prototype.constructor=e}function T(e){return e}function C(e,t,n){this.code=I+e,this.message=t||k[e]||"",this.a=n||null}function S(e){var t=e&&e.code;return t?new C(t.substring(I.length),e.message,e.serverResponse):null}w(C,Error),C.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},C.prototype.toJSON=function(){return this.w()};var E,I="auth/",k={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},P={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function R(e){for(var t in P)if(P[t].id===e)return{firebaseEndpoint:(e=P[t]).Ua,secureTokenEndpoint:e.$a,identityPlatformEndpoint:e.Xa};return null}function N(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function x(e){if(Error.captureStackTrace)Error.captureStackTrace(this,x);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function A(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");x.call(this,n+e[r])}function D(e,t){throw new A("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function O(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function M(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function L(){this.b=this.a=null}E=R("__EID__")?"__EID__":void 0,w(x,Error),x.prototype.name="CustomError",w(A,x),A.prototype.name="AssertionError",O.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var F=new O((function(){return new U}),(function(e){e.reset()}));function j(){var e=mt,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function U(){this.next=this.b=this.a=null}L.prototype.add=function(e,t){var n=F.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},q=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};var B=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=[],i=0,o="string"==typeof e?e.split(""):e,a=0;a<n;a++)if(a in o){var s=o[a];t.call(void 0,s,a,e)&&(r[i++]=s)}return r},G=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},K=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function W(e,t){return 0<=V(e,t)}function z(e,t){var n;return(n=0<=(t=V(e,t)))&&Array.prototype.splice.call(e,t,1),n}function H(e,t){!function(e,t){for(var n="string"==typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,(function(n,r){t.call(void 0,n,r,e)&&1==Array.prototype.splice.call(e,r,1).length&&0}))}function Q(e){return Array.prototype.concat.apply([],arguments)}function $(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var Y,X=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},J=/&/g,Z=/</g,ee=/>/g,te=/"/g,ne=/'/g,re=/\x00/g,ie=/[\x00&<>"']/;function oe(e,t){return-1!=e.indexOf(t)}function ae(e,t){return e<t?-1:e>t?1:0}e:{var se=a.navigator;if(se){var ue=se.userAgent;if(ue){Y=ue;break e}}Y=""}function ce(e){return oe(Y,e)}function le(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function he(e){for(var t in e)return!1;return!0}function fe(e){var t,n={};for(t in e)n[t]=e[t];return n}var pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<pe.length;o++)n=pe[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ve(e,t){e:{try{var n=e&&e.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break e}}catch(e){}i=null}if(i&&void 0!==i[t]&&(!e||!(e instanceof i[t])&&(e instanceof i.Location||e instanceof i.Element))){if(d(e))try{var o=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(e){o="<object could not be stringified>"}else o=void 0===e?"undefined":null===e?"null":typeof e;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,o)}}function ye(e,t){this.a=e===_e&&t||"",this.b=be}function me(e){return e instanceof ye&&e.constructor===ye&&e.b===be?e.a:(D("expected object of type Const, got '"+e+"'"),"type_error:Const")}ye.prototype.ta=!0,ye.prototype.sa=function(){return this.a},ye.prototype.toString=function(){return"Const{"+this.a+"}"};var ge,be={},_e={};function we(){if(void 0===ge){var e=null,t=a.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:T,createScript:T,createScriptURL:T})}catch(e){a.console&&a.console.error(e.message)}ge=e}else ge=e}return ge}function Te(e,t){this.a=t===ke?e:""}function Ce(e){return e instanceof Te&&e.constructor===Te?e.a:(D("expected object of type TrustedResourceUrl, got '"+e+"' of type "+h(e)),"type_error:TrustedResourceUrl")}function Se(e,t){var n=me(e);if(!Ie.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(e){var t=we();return new Te(e=t?t.createScriptURL(e):e,ke)}(e=n.replace(Ee,(function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof ye?me(e):encodeURIComponent(String(e))})))}Te.prototype.ta=!0,Te.prototype.sa=function(){return this.a.toString()},Te.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Ee=/%{(\w+)}/g,Ie=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ke={};function Pe(e,t){this.a=t===Me?e:""}function Re(e){return e instanceof Pe&&e.constructor===Pe?e.a:(D("expected object of type SafeUrl, got '"+e+"' of type "+h(e)),"type_error:SafeUrl")}Pe.prototype.ta=!0,Pe.prototype.sa=function(){return this.a.toString()},Pe.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ne=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,xe=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Ae=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function De(e){if(e instanceof Pe)return e;if(e="object"==typeof e&&e.ta?e.sa():String(e),Ae.test(e))e=new Pe(e,Me);else{var t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(xe);e=t&&Ne.test(t[1])?new Pe(e,Me):null}return e}function Oe(e){return e instanceof Pe?e:(e="object"==typeof e&&e.ta?e.sa():String(e),Ae.test(e)||(e="about:invalid#zClosurez"),new Pe(e,Me))}var Me={},Le=new Pe("about:invalid#zClosurez",Me);function Fe(e,t,n){this.a=n===je?e:""}Fe.prototype.ta=!0,Fe.prototype.sa=function(){return this.a.toString()},Fe.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var je={};function Ue(e,t,n,r){return e=e instanceof Pe?e:Oe(e),t=t||a,n=n instanceof ye?me(n):n||"",t.open(Re(e),n,r,void 0)}function Ve(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function qe(e){return ie.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(J,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(Z,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(ee,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(te,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(ne,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(re,"&#0;"))),e}function Be(e){return Be[" "](e),e}Be[" "]=l;var Ge,Ke,We=ce("Opera"),ze=ce("Trident")||ce("MSIE"),He=ce("Edge"),Qe=He||ze,$e=ce("Gecko")&&!(oe(Y.toLowerCase(),"webkit")&&!ce("Edge"))&&!(ce("Trident")||ce("MSIE"))&&!ce("Edge"),Ye=oe(Y.toLowerCase(),"webkit")&&!ce("Edge");function Xe(){var e=a.document;return e?e.documentMode:void 0}e:{var Je="",Ze=(Ke=Y,$e?/rv:([^\);]+)(\)|;)/.exec(Ke):He?/Edge\/([\d\.]+)/.exec(Ke):ze?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ke):Ye?/WebKit\/(\S+)/.exec(Ke):We?/(?:Version)[ \/]?(\S+)/.exec(Ke):void 0);if(Ze&&(Je=Ze?Ze[1]:""),ze){var et=Xe();if(null!=et&&et>parseFloat(Je)){Ge=String(et);break e}}Ge=Je}var tt,nt={};function rt(e){return function(e,t){var n=nt;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=X(String(Ge)).split("."),r=X(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=ae(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ae(0==a[2].length,0==s[2].length)||ae(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}if(a.document&&ze){var it=Xe();tt=it||(parseInt(Ge,10)||void 0)}else tt=void 0;var ot=tt;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Ke){}var at=!ze||9<=Number(ot);function st(e){var t=document;return"string"==typeof e?t.getElementById(e):e}function ut(e,t){le(t,(function(t,n){t&&"object"==typeof t&&t.ta&&(t=t.sa()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:ht.hasOwnProperty(n)?e.setAttribute(ht[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t}))}var ct,lt,ht={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ft(e,t,n){function r(n){n&&t.appendChild("string"==typeof n?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!f(o)||d(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(d(o)){var a="function"==typeof o.item||"string"==typeof o.item;break e}if(p(o)){a="function"==typeof o.item;break e}}a=!1}q(a?$(o):o,r)}}}function pt(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function dt(e){a.setTimeout((function(){throw e}),0)}function vt(e,t){lt||function(){if(a.Promise&&a.Promise.resolve){var e=a.Promise.resolve(void 0);lt=function(){e.then(gt)}}else lt=function(){var e=gt;!p(a.setImmediate)||a.Window&&a.Window.prototype&&!ce("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ct||(ct=function(){var e=a.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ce("Presto")&&(e=function(){var e=pt(document,"IFRAME");e.style.display="none",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=b((function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()}),this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!ce("Trident")&&!ce("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).Hb;n.Hb=null,e()}},function(e){r.next={Hb:e},r=r.next,t.port2.postMessage(0)}}return function(e){a.setTimeout(e,0)}}()),ct(e)):a.setImmediate(e)}}(),yt||(lt(),yt=!0),mt.add(e,t)}var yt=!1,mt=new L;function gt(){for(var e;e=j();){try{e.a.call(e.b)}catch(e){dt(e)}M(F,e)}yt=!1}function bt(e,t){if(this.a=_t,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=l)try{var n=this;e.call(t,(function(e){At(n,wt,e)}),(function(e){if(!(e instanceof Vt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}At(n,Tt,e)}))}catch(e){At(this,Tt,e)}}var _t=0,wt=2,Tt=3;function Ct(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ct.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var St=new O((function(){return new Ct}),(function(e){e.reset()}));function Et(e,t,n){var r=St.get();return r.g=e,r.b=t,r.f=n,r}function It(e){if(e instanceof bt)return e;var t=new bt(l);return At(t,wt,e),t}function kt(e){return new bt((function(t,n){n(e)}))}function Pt(e,t,n){Dt(e,t,n,null)||vt(_(t,e))}function Rt(e){return new bt((function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)Pt(e[o],_(i,o,!0),_(i,o,!1));else t(r)}))}function Nt(e,t){e.b||e.a!=wt&&e.a!=Tt||Ot(e),e.f?e.f.next=t:e.b=t,e.f=t}function xt(e,t,n,r){var i=Et(null,null,null);return i.a=new bt((function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(e){o(e)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof Vt?o(t):e(i)}catch(e){o(e)}}:o})),i.a.c=e,Nt(e,i),i.a}function At(e,t,n){e.a==_t&&(e===n&&(t=Tt,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Dt(n,e.$c,e.ad,e)||(e.i=n,e.a=t,e.c=null,Ot(e),t!=Tt||n instanceof Vt||function(e,t){e.g=!0,vt((function(){e.g&&Ut.call(null,t)}))}(e,n)))}function Dt(e,t,n,r){if(e instanceof bt)return Nt(e,Et(t||l,n||null,r)),!0;if(N(e))return e.then(t,n,r),!0;if(d(e))try{var i=e.then;if(p(i))return function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,(function(e){a||(a=!0,n.call(i,e))}),o)}catch(e){o(e)}}(e,i,t,n,r),!0}catch(e){return n.call(r,e),!0}return!1}function Ot(e){e.h||(e.h=!0,vt(e.gc,e))}function Mt(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function Lt(e,t,n,r){if(n==Tt&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,jt(t,n,r);else try{t.c?t.g.call(t.f):jt(t,n,r)}catch(e){Ut.call(null,e)}M(St,t)}function jt(e,t,n){t==wt?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}bt.prototype.then=function(e,t,n){return xt(this,p(e)?e:null,p(t)?t:null,n)},bt.prototype.$goog_Thenable=!0,(e=bt.prototype).oa=function(e,t){return(e=Et(e,e,t)).c=!0,Nt(this,e),this},e.o=function(e,t){return xt(this,null,e,t)},e.cancel=function(e){if(this.a==_t){var t=new Vt(e);vt((function(){!function e(t,n){if(t.a==_t)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==t&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==_t&&1==i?e(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Mt(r),Lt(r,o,Tt,n)))}t.c=null}else At(t,Tt,n)}(this,t)}),this)}},e.$c=function(e){this.a=_t,At(this,wt,e)},e.ad=function(e){this.a=_t,At(this,Tt,e)},e.gc=function(){for(var e;e=Mt(this);)Lt(this,e,this.a,this.i);this.h=!1};var Ut=dt;function Vt(e){x.call(this,e)}function qt(){this.ya=this.ya,this.pa=this.pa}w(Vt,x),Vt.prototype.name="cancel";function Bt(e){if(!e.ya&&(e.ya=!0,e.Da(),0))(function(e){Object.prototype.hasOwnProperty.call(e,v)&&e[v]||(e[v]=++y)})(e)}qt.prototype.ya=!1,qt.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Gt=Object.freeze||function(e){return e},Kt=!ze||9<=Number(ot),Wt=ze&&!rt("9"),zt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",l,t),a.removeEventListener("test",l,t)}catch(e){}return e}();function Ht(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function Qt(e,t){if(Ht.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if($e){e:{try{Be(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:$t[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}Ht.prototype.preventDefault=function(){this.defaultPrevented=!0},w(Qt,Ht);var $t=Gt({2:"touch",3:"pen",4:"mouse"});Qt.prototype.preventDefault=function(){Qt.bb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Wt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}},Qt.prototype.g=function(){return this.a};var Yt="closure_listenable_"+(1e6*Math.random()|0),Xt=0;function Jt(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Wa=i,this.key=++Xt,this.wa=this.Qa=!1}function Zt(e){e.wa=!0,e.listener=null,e.proxy=null,e.src=null,e.Wa=null}function en(e){this.src=e,this.a={},this.b=0}function tn(e,t){var n=t.type;n in e.a&&z(e.a[n],t)&&(Zt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function nn(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.wa&&o.listener==t&&o.capture==!!n&&o.Wa==r)return i}return-1}en.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=nn(e,t,r,i);return-1<a?(t=e[a],n||(t.Qa=!1)):((t=new Jt(t,this.src,o,!!r,i)).Qa=n,e.push(t)),t};var rn="closure_lm_"+(1e6*Math.random()|0),on={};function an(e,t,n,r,i){if(r&&r.once)un(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)an(e,t[o],n,r,i);else n=mn(n),e&&e[Yt]?bn(e,t,n,d(r)?!!r.capture:!!r,i):sn(e,t,n,!1,r,i)}function sn(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i,s=vn(e);if(s||(e[rn]=s=new en(e)),!(n=s.add(t,n,r,a,o)).proxy)if(r=function(){var e=dn,t=Kt?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)zt||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(hn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function un(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)un(e,t[o],n,r,i);else n=mn(n),e&&e[Yt]?_n(e,t,n,d(r)?!!r.capture:!!r,i):sn(e,t,n,!0,r,i)}function cn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)cn(e,t[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=mn(n),e&&e[Yt]?(e=e.v,(t=String(t).toString())in e.a&&(-1<(n=nn(o=e.a[t],n,r,i))&&(Zt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=vn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=nn(t,n,r,i)),(n=-1<e?t[e]:null)&&ln(n))}function ln(e){if("number"!=typeof e&&e&&!e.wa){var t=e.src;if(t&&t[Yt])tn(t.v,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(hn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=vn(t))?(tn(n,e),0==n.b&&(n.src=null,t[rn]=null)):Zt(e)}}}function hn(e){return e in on?on[e]:on[e]="on"+e}function fn(e,t,n,r){var i=!0;if((e=vn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.wa&&(o=pn(o,r),i=i&&!1!==o)}return i}function pn(e,t){var n=e.listener,r=e.Wa||e.src;return e.Qa&&ln(e),n.call(r,t)}function dn(e,t){if(e.wa)return!0;if(!Kt){if(!t)e:{t=["window","event"];for(var n=a,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Qt(r=t,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=fn(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=fn(r[i],e,!1,t),n=n&&o}return n}return pn(e,new Qt(t,this))}function vn(e){return(e=e[rn])instanceof en?e:null}var yn="__closure_events_fn_"+(1e9*Math.random()>>>0);function mn(e){return p(e)?e:(e[yn]||(e[yn]=function(t){return e.handleEvent(t)}),e[yn])}function gn(){qt.call(this),this.v=new en(this),this.bc=this,this.hb=null}function bn(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function _n(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function wn(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&tn(e.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function Tn(e,t,n){if(p(e))n&&(e=b(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=b(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function Cn(e){var t=null;return new bt((function(n,r){-1==(t=Tn((function(){n(void 0)}),e))&&r(Error("Failed to schedule timer."))})).o((function(e){throw a.clearTimeout(t),e}))}function Sn(e){if(e.X&&"function"==typeof e.X)return e.X();if("string"==typeof e)return e.split("");if(f(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function En(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.X||"function"!=typeof e.X){if(f(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function In(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof In)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function kn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Pn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Pn(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Pn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}w(gn,qt),gn.prototype[Yt]=!0,gn.prototype.addEventListener=function(e,t,n,r){an(this,e,t,n,r)},gn.prototype.removeEventListener=function(e,t,n,r){cn(this,e,t,n,r)},gn.prototype.dispatchEvent=function(e){var t,n=this.hb;if(n)for(t=[];n;n=n.hb)t.push(n);n=this.bc;var r=e.type||e;if("string"==typeof e)e=new Ht(e,n);else if(e instanceof Ht)e.target=e.target||n;else{var i=e;de(e=new Ht(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.b=t[o];i=wn(a,r,!0,e)&&i}if(i=wn(a=e.b=n,r,!0,e)&&i,i=wn(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=wn(a=e.b=t[o],r,!1,e)&&i;return i},gn.prototype.Da=function(){if(gn.bb.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Zt(n[r]);delete t.a[e],t.b--}}this.hb=null},(e=In.prototype).X=function(){kn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.Y=function(){return kn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return Pn(this.b,e)?this.b[e]:t},e.set=function(e,t){Pn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Rn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Nn(e,t){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,e instanceof Nn?(this.i=void 0!==t?t:e.i,xn(this,e.c),this.l=e.l,this.a=e.a,An(this,e.g),this.f=e.f,Dn(this,Jn(e.b)),this.h=e.h):e&&(n=String(e).match(Rn))?(this.i=!!t,xn(this,n[1]||"",!0),this.l=jn(n[2]||""),this.a=jn(n[3]||"",!0),An(this,n[4]),this.f=jn(n[5]||"",!0),Dn(this,n[6]||"",!0),this.h=jn(n[7]||"")):(this.i=!!t,this.b=new zn(null,this.i))}function xn(e,t,n){e.c=n?jn(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function An(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.g=t}else e.g=null}function Dn(e,t,n){t instanceof zn?(e.b=t,function(e,t){t&&!e.f&&(Hn(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&($n(this,t),Xn(this,n,e))}),e)),e.f=t}(e.b,e.i)):(n||(t=Un(t,Kn)),e.b=new zn(t,e.i))}function On(e,t,n){e.b.set(t,n)}function Mn(e,t){return e.b.get(t)}function Ln(e){return e instanceof Nn?new Nn(e):new Nn(e,void 0)}function Fn(e,t,n,r){var i=new Nn(null,void 0);return e&&xn(i,e),t&&(i.a=t),n&&An(i,n),r&&(i.f=r),i}function jn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Un(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Vn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Vn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Nn.prototype.toString=function(){var e=[],t=this.c;t&&e.push(Un(t,qn,!0),":");var n=this.a;return(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(Un(t,qn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(Un(n,"/"==n.charAt(0)?Gn:Bn,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",Un(n,Wn)),e.join("")},Nn.prototype.resolve=function(e){var t=new Nn(this),n=!!e.c;n?xn(t,e.c):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r=e.f;if(n)An(t,e.g);else if(n=!!e.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=t.f.lastIndexOf("/");-1!=i&&(r=t.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(oe(i,"./")||oe(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.f=r:n=""!==e.b.toString(),n?Dn(t,Jn(e.b)):n=!!e.h,n&&(t.h=e.h),t};var qn=/[#\/\?@]/g,Bn=/[#\?:]/g,Gn=/[#\?]/g,Kn=/[#\?@]/g,Wn=/#/g;function zn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Hn(e){e.a||(e.a=new In,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Qn(e){var t=En(e);if(void 0===t)throw Error("Keys are undefined");var n=new zn(null,void 0);e=Sn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?Xn(n,i,o):n.add(i,o)}return n}function $n(e,t){Hn(e),t=Zn(e,t),Pn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Pn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&kn(e)))}function Yn(e,t){return Hn(e),t=Zn(e,t),Pn(e.a.b,t)}function Xn(e,t,n){$n(e,t),0<n.length&&(e.c=null,e.a.set(Zn(e,t),$(n)),e.b+=n.length)}function Jn(e){var t=new zn;return t.c=e.c,e.a&&(t.a=new In(e.a),t.b=e.b),t}function Zn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function er(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),e(t,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(a=n[i])&&(r.push(o),ir(i,r),r.push(":"),e(t,a,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":ir(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new tr,e,t),t.join("")}function tr(){}(e=zn.prototype).add=function(e,t){Hn(this),this.c=null,e=Zn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(e,t){Hn(this),this.a.forEach((function(n,r){q(n,(function(n){e.call(t,n,r,this)}),this)}),this)},e.Y=function(){Hn(this);for(var e=this.a.X(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.X=function(e){Hn(this);var t=[];if("string"==typeof e)Yn(this,e)&&(t=Q(t,this.a.get(Zn(this,e))));else{e=this.a.X();for(var n=0;n<e.length;n++)t=Q(t,e[n])}return t},e.set=function(e,t){return Hn(this),this.c=null,Yn(this,e=Zn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.X(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var nr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},rr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ir(e,t){t.push('"',e.replace(rr,(function(e){var t=nr[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),nr[e]=t),t})),'"')}function or(){var e=Sr();return ze&&!!ot&&11==ot||/Edge\/\d+/.test(e)}function ar(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function sr(e,t){t=t||a.window;var n="about:blank";e&&(n=Re(De(e)||Le)),t.location.href=n}function ur(e){return!!((e=(e||Sr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function cr(e){e=e||a.window;try{e.close()}catch(e){}}function lr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Sr().toLowerCase(),r&&(t.target=r,oe(n,"crios/")&&(t.target="_blank")),wr(Sr())==br&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Pe?n:De(void 0!==n.href?n.href:String(n))||Le,n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((ce("iPhone")&&!ce("iPod")&&!ce("iPad")||ce("iPad")||ce("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(ve(a=pt(document,"A"),"HTMLAnchorElement"),t=t instanceof Pe?t:Oe(t),a.href=Re(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=Ue("",r,n,a),e=Re(t),a&&(Qe&&oe(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+qe(e)+'">',e=new Fe(e=(r=we())?r.createHTML(e):e,null,je),r=a.document)&&(r.write(function(e){return e instanceof Fe&&e.constructor===Fe?e.a:(D("expected object of type SafeHtml, got '"+e+"' of type "+h(e)),"type_error:SafeHtml")}(e)),r.close())):(a=Ue(t,r,n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(e){}return a}var hr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fr=/^[^@]+@[^@]+$/;function pr(){var e=null;return new bt((function(t){"complete"==a.document.readyState?t():(e=function(){t()},un(window,"load",e))})).o((function(t){throw cn(window,"load",e),t}))}function dr(e){return e=e||Sr(),!("file:"!==Rr()&&"ionic:"!==Rr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function vr(){var e=a.window;try{return!(!e||e==e.top)}catch(e){return!1}}function yr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function mr(){return Ft.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Ft.INTERNAL.hasOwnProperty("node")?"Node":yr()?"Worker":"Browser"}function gr(){var e=mr();return"ReactNative"===e||"Node"===e}var br="Firefox",_r="Chrome";function wr(e){var t=e.toLowerCase();return oe(t,"opera/")||oe(t,"opr/")||oe(t,"opios/")?"Opera":oe(t,"iemobile")?"IEMobile":oe(t,"msie")||oe(t,"trident/")?"IE":oe(t,"edge/")?"Edge":oe(t,"firefox/")?br:oe(t,"silk/")?"Silk":oe(t,"blackberry")?"Blackberry":oe(t,"webos")?"Webos":!oe(t,"safari/")||oe(t,"chrome/")||oe(t,"crios/")||oe(t,"android")?!oe(t,"chrome/")&&!oe(t,"crios/")||oe(t,"edge/")?oe(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":_r:"Safari"}var Tr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Cr(e,t){t=t||[];var n,r=[],i={};for(n in Tr)i[Tr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=mr())?r=wr(i=Sr()):"Worker"===r&&(r=wr(i=Sr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function Sr(){return a.navigator&&a.navigator.userAgent||""}function Er(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function Ir(){try{var e=a.localStorage,t=Or();if(e)return e.setItem(t,"1"),e.removeItem(t),!or()||!!a.indexedDB}catch(e){return yr()&&!!a.indexedDB}return!1}function kr(){return(Pr()||"chrome-extension:"===Rr()||dr())&&!gr()&&Ir()&&!yr()}function Pr(){return"http:"===Rr()||"https:"===Rr()}function Rr(){return a.location&&a.location.protocol||null}function Nr(e){return!ur(e=e||Sr())&&wr(e)!=br}function xr(e){return void 0===e?null:er(e)}function Ar(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function Dr(e){if(null!==e)return JSON.parse(e)}function Or(e){return e||Math.floor(1e9*Math.random()).toString()}function Mr(e){return"Safari"!=wr(e=e||Sr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Lr(){var e=a.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Fr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=Sr(),t=mr(),this.b=ur(e)||"ReactNative"===t}function jr(){var e=a.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function Ur(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function Vr(){return!(!Er("fireauth.oauthhelper",a)&&!Er("fireauth.iframe",a))}Fr.prototype.get=function(){var e=a.navigator;return!e||"boolean"!=typeof e.onLine||!Pr()&&"chrome-extension:"!==Rr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var qr,Br={};function Gr(e){Br[e]||(Br[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Kr={};Object.defineProperty(Kr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Kr,"abcd",{configurable:!0,enumerable:!0,value:2}),qr=2==Kr.abcd}catch(Ke){qr=!1}function Wr(e,t,n){qr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function zr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Wr(e,n,t[n])}function Hr(e){var t={};return zr(t,e),t}function Qr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Wr(t,n,Qr(e[n]));return t}function $r(e){var t=e&&(e[ei]?"phone":null);if(!(t&&e&&e[Zr]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");Wr(this,"uid",e[Zr]),Wr(this,"displayName",e[Xr]||null);var n=null;e[Jr]&&(n=new Date(e[Jr]).toUTCString()),Wr(this,"enrollmentTime",n),Wr(this,"factorId",t)}function Yr(e){try{var t=new ti(e)}catch(e){t=null}return t}$r.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Xr="displayName",Jr="enrolledAt",Zr="mfaEnrollmentId",ei="phoneInfo";function ti(e){$r.call(this,e),Wr(this,"phoneNumber",e[ei])}function ni(e){var t={},n=e[ai],r=e[ui],i=e[ci];if(e=Yr(e[si]),!i||i!=ii&&i!=oi&&!n||i==oi&&!r||i==ri&&!e)throw Error("Invalid checkActionCode response!");i==oi?(t[hi]=n||null,t[pi]=n||null,t[li]=r):(t[hi]=r||null,t[pi]=r||null,t[li]=n||null),t[fi]=e||null,Wr(this,vi,i),Wr(this,di,Qr(t))}w(ti,$r),ti.prototype.w=function(){var e=ti.bb.w.call(this);return e.phoneNumber=this.phoneNumber,e};var ri="REVERT_SECOND_FACTOR_ADDITION",ii="EMAIL_SIGNIN",oi="VERIFY_AND_CHANGE_EMAIL",ai="email",si="mfaInfo",ui="newEmail",ci="requestType",li="email",hi="fromEmail",fi="multiFactorInfo",pi="previousEmail",di="data",vi="operation";function yi(e){var t=Mn(e=Ln(e),mi)||null,n=Mn(e,gi)||null,r=Mn(e,wi)||null;if(r=r&&Ci[r]||null,!t||!n||!r)throw new C("argument-error",mi+", "+gi+"and "+wi+" are required in a valid action code URL.");zr(this,{apiKey:t,operation:r,code:n,continueUrl:Mn(e,bi)||null,languageCode:Mn(e,_i)||null,tenantId:Mn(e,Ti)||null})}var mi="apiKey",gi="oobCode",bi="continueUrl",_i="languageCode",wi="mode",Ti="tenantId",Ci={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ri,signIn:ii,verifyAndChangeEmail:oi,verifyEmail:"VERIFY_EMAIL"};function Si(e){try{return new yi(e)}catch(e){return null}}function Ei(e){var t=e[Ni];if(void 0===t)throw new C("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new C("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[Ii];if(n&&"object"==typeof n){t=n[Di];var r=n[xi];if(n=n[Ai],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",xi+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",Ai+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new C("argument-error",Di+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",Ii+" property must be a non null object when specified.");if(this.f=null,(t=e[Ri])&&"object"==typeof t){if("string"==typeof(t=t[Oi])&&t.length)this.f=t;else if(void 0!==t)throw new C("argument-error",Oi+" property must be a non empty string when specified.")}else if(void 0!==t)throw new C("argument-error",Ri+" property must be a non null object when specified.");if(void 0!==(t=e[Pi])&&"boolean"!=typeof t)throw new C("argument-error",Pi+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[ki])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new C("argument-error",ki+" property must be a non empty string when specified.");this.i=e||null}var Ii="android",ki="dynamicLinkDomain",Pi="handleCodeInApp",Ri="iOS",Ni="url",xi="installApp",Ai="minimumVersion",Di="packageName",Oi="bundleId";function Mi(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var Li=null;function Fi(e){var t=[];return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Li[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!Li){Li={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Li[o]&&(Li[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){t.push(e)})),t}function ji(e){var t=Vi(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.h=e,this.a=t.exp,this.i=t.sub,e=Date.now()/1e3,this.g=t.iat||(e>this.a?this.a:e),this.b=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.c=!!t.is_anonymous||"anonymous"==this.b}function Ui(e){try{return new ji(e)}catch(e){return null}}function Vi(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{var r=Fi(e);for(e=[],n=t=0;t<r.length;){var i=r[t++];if(128>i)e[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[t++];var a=r[t++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(s>>10)),e[n++]=String.fromCharCode(56320+(1023&s))}else o=r[t++],a=r[t++],e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(e.join(""))}catch(e){}return null}ji.prototype.T=function(){return this.f},ji.prototype.l=function(){return this.c},ji.prototype.toString=function(){return this.h};var qi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Bi=["client_id","response_type","scope","redirect_uri","state"],Gi={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:Bi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:Bi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:Bi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:qi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Ki(e){for(var t in Gi)if(Gi[t].fa==e)return Gi[t];return null}function Wi(e){var t={};t["facebook.com"]=Yi,t["google.com"]=Ji,t["github.com"]=Xi,t["twitter.com"]=Zi;var n=e&&e[Hi];try{if(n)return t[n]?new t[n](e):new $i(e);if(void 0!==e[zi])return new Qi(e)}catch(e){}return null}var zi="idToken",Hi="providerId";function Qi(e){var t=e[Hi];if(!t&&e[zi]){var n=Ui(e[zi]);n&&n.b&&(t=n.b)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Wr(this,"providerId",t),Wr(this,"isNewUser",n)}function $i(e){Qi.call(this,e),Wr(this,"profile",Qr((e=Dr(e.rawUserInfo||"{}"))||{}))}function Yi(e){if($i.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Xi(e){if($i.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Wr(this,"username",this.profile&&this.profile.login||null)}function Ji(e){if($i.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Zi(e){if($i.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Wr(this,"username",e.screenName||null)}function eo(e){var t=Ln(e),n=Mn(t,"link"),r=Mn(Ln(n),"link");return t=Mn(t,"deep_link_id"),Mn(Ln(t),"link")||t||r||n||e}function to(e,t){if(!e&&!t)throw new C("internal-error","Internal assert: no raw session string available");if(e&&t)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?no:ro}w($i,Qi),w(Yi,$i),w(Xi,$i),w(Ji,$i),w(Zi,$i);var no="enroll",ro="signin";function io(){}function oo(e,t){return e.then((function(e){if(e[Ha]){var n=Ui(e[Ha]);if(!n||t!=n.i)throw new C("user-mismatch");return e}throw new C("user-mismatch")})).o((function(e){throw e&&e.code&&e.code==I+"user-not-found"?new C("user-mismatch"):e}))}function ao(e,t){if(!t)throw new C("internal-error","failed to construct a credential");this.a=t,Wr(this,"providerId",e),Wr(this,"signInMethod",e)}function so(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function uo(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new ao(e.providerId,e.pendingToken)}catch(e){}return null}function co(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&Wr(this,"idToken",t.idToken),t.accessToken&&Wr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&Wr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");Wr(this,"accessToken",t.oauthToken),Wr(this,"secret",t.oauthTokenSecret)}Wr(this,"providerId",e),Wr(this,"signInMethod",n)}function lo(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Qn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function ho(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new co(e.providerId,t,e.signInMethod)}catch(e){}}return null}function fo(e,t){this.Qc=t||[],zr(this,{providerId:e,isOAuthProvider:!0}),this.Jb={},this.qb=(Ki(e)||{}).Ja||null,this.pb=null}function po(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');fo.call(this,e,[])}function vo(e){fo.call(this,e,Bi),this.a=[]}function yo(){vo.call(this,"facebook.com")}function mo(e){if(!e)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return d(e)&&(t=e.accessToken),(new yo).credential({accessToken:t})}function go(){vo.call(this,"github.com")}function bo(e){if(!e)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return d(e)&&(t=e.accessToken),(new go).credential({accessToken:t})}function _o(){vo.call(this,"google.com"),this.Ca("profile")}function wo(e,t){var n=e;return d(e)&&(n=e.idToken,t=e.accessToken),(new _o).credential({idToken:n,accessToken:t})}function To(){fo.call(this,"twitter.com",qi)}function Co(e,t){var n=e;if(d(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new co("twitter.com",n,"twitter.com")}function So(e,t,n){this.a=e,this.f=t,Wr(this,"providerId","password"),Wr(this,"signInMethod",n===Io.EMAIL_LINK_SIGN_IN_METHOD?Io.EMAIL_LINK_SIGN_IN_METHOD:Io.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Eo(e){return e&&e.email&&e.password?new So(e.email,e.password,e.signInMethod):null}function Io(){zr(this,{providerId:"password",isOAuthProvider:!1})}function ko(e,t){if(!(t=Po(t)))throw new C("argument-error","Invalid email link!");return new So(e,t.code,Io.EMAIL_LINK_SIGN_IN_METHOD)}function Po(e){return(e=Si(e=eo(e)))&&e.operation===ii?e:null}function Ro(e){if(!(e.fb&&e.eb||e.La&&e.ea))throw new C("internal-error");this.a=e,Wr(this,"providerId","phone"),this.fa="phone",Wr(this,"signInMethod","phone")}function No(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return q(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){e[n]&&(t[n]=e[n])})),new Ro(t)}return null}function xo(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.fb,code:e.a.eb}}function Ao(e){try{this.a=e||Ft.auth()}catch(e){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}zr(this,{providerId:"phone",isOAuthProvider:!1})}function Do(e,t){if(!e)throw new C("missing-verification-id");if(!t)throw new C("missing-verification-code");return new Ro({fb:e,eb:t})}function Oo(e){if(e.temporaryProof&&e.phoneNumber)return new Ro({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return wo(o,n);case"facebook.com":return mo(n);case"github.com":return bo(n);case"twitter.com":return Co(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new ao(t,a):new co(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new vo(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(e){return null}}function Mo(e){if(!e.isOAuthProvider)throw new C("invalid-oauth-provider")}function Lo(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Fo(e){return(e=e||{}).type?new Lo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&S(e.error),e.postBody,e.tenantId):null}function jo(){this.b=null,this.a=[]}to.prototype.Ha=function(){return this.a?It(this.a):It(this.b)},to.prototype.w=function(){return this.type==no?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},io.prototype.ka=function(){},io.prototype.b=function(){},io.prototype.c=function(){},io.prototype.w=function(){},ao.prototype.ka=function(e){return vs(e,so(this))},ao.prototype.b=function(e,t){var n=so(this);return n.idToken=t,ys(e,n)},ao.prototype.c=function(e,t){return oo(ms(e,so(this)),t)},ao.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},co.prototype.ka=function(e){return vs(e,lo(this))},co.prototype.b=function(e,t){var n=lo(this);return n.idToken=t,ys(e,n)},co.prototype.c=function(e,t){return oo(ms(e,lo(this)),t)},co.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},fo.prototype.Ka=function(e){return this.Jb=fe(e),this},w(po,fo),w(vo,fo),vo.prototype.Ca=function(e){return W(this.a,e)||this.a.push(e),this},vo.prototype.Rb=function(){return $(this.a)},vo.prototype.credential=function(e,t){var n;if(!(n=d(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new co(this.providerId,n,this.providerId)},w(yo,vo),Wr(yo,"PROVIDER_ID","facebook.com"),Wr(yo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),w(go,vo),Wr(go,"PROVIDER_ID","github.com"),Wr(go,"GITHUB_SIGN_IN_METHOD","github.com"),w(_o,vo),Wr(_o,"PROVIDER_ID","google.com"),Wr(_o,"GOOGLE_SIGN_IN_METHOD","google.com"),w(To,fo),Wr(To,"PROVIDER_ID","twitter.com"),Wr(To,"TWITTER_SIGN_IN_METHOD","twitter.com"),So.prototype.ka=function(e){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Js(e,Es,{email:this.a,oobCode:this.f}):Js(e,Hs,{email:this.a,password:this.f})},So.prototype.b=function(e,t){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Js(e,Is,{idToken:t,email:this.a,oobCode:this.f}):Js(e,Us,{idToken:t,email:this.a,password:this.f})},So.prototype.c=function(e,t){return oo(this.ka(e),t)},So.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},zr(Io,{PROVIDER_ID:"password"}),zr(Io,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),zr(Io,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ro.prototype.ka=function(e){return e.gb(xo(this))},Ro.prototype.b=function(e,t){var n=xo(this);return n.idToken=t,Js(e,$s,n)},Ro.prototype.c=function(e,t){var n=xo(this);return n.operation="REAUTH",oo(e=Js(e,Ys,n),t)},Ro.prototype.w=function(){var e={providerId:"phone"};return this.a.fb&&(e.verificationId=this.a.fb),this.a.eb&&(e.verificationCode=this.a.eb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},Ao.prototype.gb=function(e,t){var n=this.a.a;return It(t.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":var i=d(e)?e.session:null,o=d(e)?e.phoneNumber:e;return(i&&i.type==no?i.Ha().then((function(e){return function(e,t){return Js(e,qs,t).then((function(e){return e.phoneSessionInfo.sessionInfo}))}(n,{idToken:e,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==ro?i.Ha().then((function(t){return function(e,t){return Js(e,Bs,t).then((function(e){return e.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:t,mfaEnrollmentId:e.multiFactorHint&&e.multiFactorHint.uid||e.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(e,t){return Js(e,Fs,t)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(e){return"function"==typeof t.reset&&t.reset(),e}),(function(e){throw"function"==typeof t.reset&&t.reset(),e}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},zr(Ao,{PROVIDER_ID:"phone"}),zr(Ao,{PHONE_SIGN_IN_METHOD:"phone"}),Lo.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},Lo.prototype.T=function(){return this.h},Lo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Uo,Vo=null;function qo(e){var t="unauthorized-domain",n=void 0,r=Ln(e);e=r.a,"chrome-extension"==(r=r.c)?n=Ve("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=Ve("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",C.call(this,t,n)}function Bo(e,t,n){C.call(this,e,n),(e=t||{}).Kb&&Wr(this,"email",e.Kb),e.ea&&Wr(this,"phoneNumber",e.ea),e.credential&&Wr(this,"credential",e.credential),e.$b&&Wr(this,"tenantId",e.$b)}function Go(e){if(e.code){var t=e.code||"";0==t.indexOf(I)&&(t=t.substring(I.length));var n={credential:Oo(e),$b:e.tenantId};if(e.email)n.Kb=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new C(t,e.message||void 0);return new Bo(t,n,e.message)}return null}function Ko(){}function Wo(e){return e.c||(e.c=e.b())}function zo(){}function Ho(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function Qo(){}function $o(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=b(this.qc,this),this.a.onerror=b(this.Tb,this),this.a.onprogress=b(this.rc,this),this.a.ontimeout=b(this.vc,this)}function Yo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Xo(e,t,n){this.reset(e,t,n,void 0,void 0)}function Jo(e){this.f=e,this.b=this.c=this.a=null}function Zo(e,t){this.name=e,this.value=t}w(qo,C),w(Bo,C),Bo.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&de(e,t),e},Bo.prototype.toJSON=function(){return this.w()},Ko.prototype.c=null,w(zo,Ko),zo.prototype.a=function(){var e=Ho(this);return e?new ActiveXObject(e):new XMLHttpRequest},zo.prototype.b=function(){var e={};return Ho(this)&&(e[0]=!0,e[1]=!0),e},Uo=new zo,w(Qo,Ko),Qo.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new $o;throw Error("Unsupported browser")},Qo.prototype.b=function(){return{}},(e=$o.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Yo(this,4)},e.Tb=function(){this.status=500,this.response=this.responseText="",Yo(this,4)},e.vc=function(){this.Tb()},e.rc=function(){this.status=200,Yo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Xo.prototype.a=null,Xo.prototype.reset=function(e,t,n,r,i){delete this.a},Zo.prototype.toString=function(){return this.name};var ea=new Zo("SEVERE",1e3),ta=new Zo("WARNING",900),na=new Zo("CONFIG",700),ra=new Zo("FINE",500);Jo.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c?t.c:t.a?e(t.a):(D("Root logger has no level set."),null)}(this).value)for(p(t)&&(t=t()),e=new Xo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var ia={},oa=null;function aa(e){var t;if(oa||(oa=new Jo(""),ia[""]=oa,oa.c=na),!(t=ia[e])){t=new Jo(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=aa(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,ia[e]=t}return t}function sa(e,t){e&&e.log(ra,t,void 0)}function ua(e){this.f=e}function ca(e){gn.call(this),this.u=e,this.h=void 0,this.readyState=la,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=aa("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}w(ua,Ko),ua.prototype.a=function(){return new ca(this.f)},ua.prototype.b=function(e){return function(){return e}}({}),w(ca,gn);var la=0;function ha(e){e.c.read().then(e.pc.bind(e)).catch(e.Va.bind(e))}function fa(e){e.readyState=4,e.g=null,e.c=null,e.m=null,pa(e)}function pa(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function da(e){gn.call(this),this.headers=new In,this.D=e||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=va,this.u=this.S=!1}(e=ca.prototype).open=function(e,t){if(this.readyState!=la)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,pa(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.uc.bind(this),this.Va.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,fa(this)),this.readyState=la},e.uc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,pa(this)),this.a&&(this.readyState=3,pa(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==a.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,ha(this)):e.text().then(this.tc.bind(this),this.Va.bind(this)))))},e.pc=function(e){if(this.a){var t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?fa(this):pa(this),3==this.readyState&&ha(this)}},e.tc=function(e){this.a&&(this.response=this.responseText=e,fa(this))},e.sc=function(e){this.a&&(this.response=e,fa(this))},e.Va=function(e){var t=this.i;t&&t.log(ta,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&fa(this)},e.setRequestHeader=function(e,t){this.l.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(ta,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(ta,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),w(da,gn);var va="";da.prototype.b=aa("goog.net.XhrIo");var ya=/^https?$/i,ma=["POST","PUT"];function ga(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.P=n,e.J=!1,e.c=!0,e.a=e.D?e.D.a():Uo.a(),e.C=e.D?Wo(e.D):Wo(Uo),e.a.onreadystatechange=b(e.Wb,e);try{sa(e.b,ka(e,"Opening Xhr")),e.N=!0,e.a.open(n,String(t),!0),e.N=!1}catch(t){return sa(e.b,ka(e,"Error opening Xhr: "+t.message)),void _a(e,t)}t=r||"";var o=new In(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(f(e)||"string"==typeof e)q(e,t,void 0);else for(var n=En(e),r=Sn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,(function(e,t){o.set(t,e)})),i=function(e){e:{for(var t=ba,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(o.Y()),r=a.FormData&&t instanceof a.FormData,!W(ma,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(e,t){this.a.setRequestHeader(t,e)}),e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.S&&(e.a.withCredentials=e.S);try{Sa(e),0<e.g&&(e.u=function(e){return ze&&rt(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(e.a),sa(e.b,ka(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=b(e.Ma,e)):e.s=Tn(e.Ma,e.g,e)),sa(e.b,ka(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){sa(e.b,ka(e,"Send error: "+t.message)),_a(e,t)}}function ba(e){return"content-type"==e.toLowerCase()}function _a(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,wa(e),Ca(e)}function wa(e){e.J||(e.J=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Ta(e){if(e.c&&void 0!==o)if(e.C[1]&&4==Ea(e)&&2==Ia(e))sa(e.b,ka(e,"Local request error detected and ignored"));else if(e.i&&4==Ea(e))Tn(e.Wb,0,e);else if(e.dispatchEvent("readystatechange"),4==Ea(e)){sa(e.b,ka(e,"Request complete")),e.c=!1;try{var t,n=Ia(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.l).match(Rn)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!ya.test(s?s.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var c=2<Ea(e)?e.a.statusText:""}catch(t){sa(e.b,"Can not get status: "+t.message),c=""}e.h=c+" ["+Ia(e)+"]",wa(e)}}finally{Ca(e)}}}function Ca(e,t){if(e.a){Sa(e);var n=e.a,r=e.C[0]?l:null;e.a=null,e.C=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(ea,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function Sa(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(a.clearTimeout(e.s),e.s=null)}function Ea(e){return e.a?e.a.readyState:0}function Ia(e){try{return 2<Ea(e)?e.a.status:-1}catch(e){return-1}}function ka(e,t){return t+" ["+e.P+" "+e.l+" "+Ia(e)+"]"}function Pa(e){var t=Ua;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Ra(e,t,n){e.a=!0,e.c=n,e.f=!t,Da(e)}function Na(e){if(e.a){if(!e.v)throw new Oa(e);e.v=!1}}function xa(e,t,n,r){e.g.push([t,n,r]),e.a&&Da(e)}function Aa(e){return K(e.g,(function(e){return p(e[1])}))}function Da(e){if(e.h&&e.a&&Aa(e)){var t=e.h,n=Fa[t];n&&(a.clearTimeout(n.a),delete Fa[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],s=i[1];if(i=i[2],o=e.f?s:o)try{var u=o.call(i||e.s,t);void 0!==u&&(e.f=e.f&&(u==t||u instanceof Error),e.c=t=u),(N(t)||"function"==typeof a.Promise&&t instanceof a.Promise)&&(r=!0,e.i=!0)}catch(r){t=r,e.f=!0,Aa(e)||(n=!0)}}e.c=t,r&&(u=b(e.m,e,!0),r=b(e.m,e,!1),t instanceof Pa?(xa(t,u,r),t.C=!0):t.then(u,r)),n&&(t=new La(t),Fa[t.a]=t,e.h=t.a)}function Oa(){x.call(this)}function Ma(){x.call(this)}function La(e){this.a=a.setTimeout(b(this.c,this),0),this.b=e}(e=da.prototype).Ma=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",sa(this.b,ka(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(sa(this.b,ka(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ca(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ca(this,!0)),da.bb.Da.call(this)},e.Wb=function(){this.ya||(this.N||this.i||this.f?Ta(this):this.Jc())},e.Jc=function(){Ta(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case va:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(ea,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return sa(this.b,"Can not get response: "+e.message),null}},Pa.prototype.cancel=function(e){if(this.a)this.c instanceof Pa&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(e=new Ma(this),Na(this),Ra(this,!1,e))}},Pa.prototype.m=function(e,t){this.i=!1,Ra(this,e,t)},Pa.prototype.then=function(e,t,n){var r,i,o=new bt((function(e,t){r=e,i=t}));return xa(this,r,(function(e){e instanceof Ma?o.cancel():i(e)})),o.then(e,t,n)},Pa.prototype.$goog_Thenable=!0,w(Oa,x),Oa.prototype.message="Deferred has already fired",Oa.prototype.name="AlreadyCalledError",w(Ma,x),Ma.prototype.message="Deferred was canceled",Ma.prototype.name="CanceledError",La.prototype.c=function(){throw delete Fa[this.a],this.b};var Fa={};function ja(e){var t,n=document,r=Ce(e).toString(),i=pt(document,"SCRIPT"),o={Xb:i,Ma:void 0},s=new Pa(o);return t=window.setTimeout((function(){Va(i,!0);var e=new Ga(Ba,"Timeout reached for loading script "+r);Na(s),Ra(s,!1,e)}),5e3),o.Ma=t,i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Va(i,!1,t),Na(s),Ra(s,!0,null))},i.onerror=function(){Va(i,!0,t);var e=new Ga(qa,"Error while loading script "+r);Na(s),Ra(s,!1,e)},de(o={},{type:"text/javascript",charset:"UTF-8"}),ut(i,o),function(e,t){ve(e,"HTMLScriptElement"),e.src=Ce(t),(t=e.ownerDocument&&e.ownerDocument.defaultView)&&t!=a?t=c(t.document):(null===u&&(u=c(a.document)),t=u),t&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),s}function Ua(){if(this&&this.Xb){var e=this.Xb;e&&"SCRIPT"==e.tagName&&Va(e,!0,this.Ma)}}function Va(e,t,n){null!=n&&a.clearTimeout(n),e.onload=l,e.onerror=l,e.onreadystatechange=l,t&&window.setTimeout((function(){e&&e.parentNode&&e.parentNode.removeChild(e)}),0)}var qa=0,Ba=1;function Ga(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),x.call(this,n),this.code=e}function Ka(e){this.f=e}function Wa(e,t,n){if(this.c=e,e=t||{},this.l=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||Qa,this.g=fe(e.secureTokenHeaders||$a),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=e.firebaseTimeout||Ya,this.a=fe(e.firebaseHeaders||Xa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==mr(),!(n=a.XMLHttpRequest||n&&Ft.INTERNAL.node&&Ft.INTERNAL.node.XMLHttpRequest)&&!yr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,yr()?this.f=new ua(self):gr()?this.f=new Ka(n):this.f=new Qo,this.b=null}w(Ga,x),w(Ka,Ko),Ka.prototype.a=function(){return new this.f},Ka.prototype.b=function(){return{}};var za,Ha="idToken",Qa=new Fr(3e4,6e4),$a={"Content-Type":"application/x-www-form-urlencoded"},Ya=new Fr(3e4,6e4),Xa={"Content-Type":"application/json"};function Ja(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Za(e,t){t&&(e.l=es("https://securetoken.googleapis.com/v1/token",t),e.h=es("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=es("https://identitytoolkit.googleapis.com/v2/",t))}function es(e,t){return e=Ln(e),t=Ln(t.url),e.f=e.a+e.f,xn(e,t.c),e.a=t.a,An(e,t.g),e.toString()}function ts(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function ns(e,t,n,r,i,o,s){(function(){var e=Sr();return!((e=wr(e)!=_r?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e)&&(!ze||!ot||9<ot)})()||yr()?e=b(e.u,e):(za||(za=new bt((function(e,t){!function(e,t){if(((window.gapi||{}).client||{}).request)e();else{a[is]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){xa(e,null,t,void 0)}(ja(Se(rs,{onload:is})),(function(){t(Error("CORS_UNSUPPORTED"))}))}}(e,t)}))),e=b(e.s,e)),e(t,n,r,i,o,s)}Wa.prototype.T=function(){return this.b},Wa.prototype.u=function(e,t,n,r,i,o){if(yr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new da(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout((function(){s.dispatchEvent("timeout")}),o)}bn(s,"complete",(function(){u&&clearTimeout(u);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return sa(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(t){e=null}t&&t(e)})),_n(s,"ready",(function(){u&&clearTimeout(u),Bt(this)})),_n(s,"timeout",(function(){u&&clearTimeout(u),Bt(this),t&&t(null)})),ga(s,e,n,r,i)};var rs=new ye(_e,"https://apis.google.com/js/client.js?onload=%{onload}"),is="__fcb"+Math.floor(1e6*Math.random()).toString();function os(e,t,n,r,i,o,a){var s=Ln(t+n);On(s,"key",e.c),a&&On(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&On(s,c,i[c]);return new bt((function(t,n){ns(e,s.toString(),(function(e){e?e.error?n(eu(e,o||{})):t(e):n(new C("network-request-failed"))}),r,u?void 0:er(Ar(i)),e.a,e.v.get())}))}function as(e){if("string"!=typeof(e=e.email)||!fr.test(e))throw new C("invalid-email")}function ss(e){"email"in e&&as(e)}function us(e){if(!e[Ha]){if(e.mfaPendingCredential)throw new C("multi-factor-auth-required",null,fe(e));throw new C("internal-error")}}function cs(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new C("internal-error")}else{if(!e.sessionInfo)throw new C("missing-verification-id");if(!e.code)throw new C("missing-verification-code")}}Wa.prototype.s=function(e,t,n,r,i){var o=this;za.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a),t&&t(e)}})})).o((function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})}))},Wa.prototype.Ab=function(){return Js(this,Vs,{})},Wa.prototype.Cb=function(e,t){return Js(this,js,{idToken:e,email:t})},Wa.prototype.Db=function(e,t){return Js(this,Us,{idToken:e,password:t})};var ls={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function hs(e){if(!e.phoneVerificationInfo)throw new C("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new C("missing-verification-code")}function fs(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new C("internal-error")}function ps(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&(Yn(e=new zn(e.postBody),"nonce")&&(t.nonce=e.get("nonce")))),t}function ds(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Go(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Go(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Go(e)):e.errorMessage&&(t=Zs(e.errorMessage)),t)throw t;us(e)}function vs(e,t){return t.returnIdpCredential=!0,Js(e,Gs,t)}function ys(e,t){return t.returnIdpCredential=!0,Js(e,Ws,t)}function ms(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Js(e,Ks,t)}function gs(e){if(!e.oobCode)throw new C("invalid-action-code")}(e=Wa.prototype).Eb=function(e,t){var n={idToken:e},r=[];return le(ls,(function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Js(this,js,n)},e.wb=function(e,t){return de(e={requestType:"PASSWORD_RESET",email:e},t),Js(this,Ds,e)},e.xb=function(e,t){return de(e={requestType:"EMAIL_SIGNIN",email:e},t),Js(this,Ns,e)},e.vb=function(e,t){return de(e={requestType:"VERIFY_EMAIL",idToken:e},t),Js(this,xs,e)},e.Fb=function(e,t,n){return de(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),Js(this,As,e)},e.gb=function(e){return Js(this,Qs,e)},e.ob=function(e,t){return Js(this,Ls,{oobCode:e,newPassword:t})},e.Sa=function(e){return Js(this,_s,{oobCode:e})},e.kb=function(e){return Js(this,bs,{oobCode:e})};var bs={endpoint:"setAccountInfo",A:gs,Z:"email",B:!0},_s={endpoint:"resetPassword",A:gs,G:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new C("internal-error")},B:!0},ws={endpoint:"signupNewUser",A:function(e){if(as(e),!e.password)throw new C("weak-password")},G:us,V:!0,B:!0},Ts={endpoint:"createAuthUri",B:!0},Cs={endpoint:"deleteAccount",O:["idToken"]},Ss={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(e){if(!Array.isArray(e.deleteProvider))throw new C("internal-error")}},Es={endpoint:"emailLinkSignin",O:["email","oobCode"],A:as,G:us,V:!0,B:!0},Is={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:as,G:us,V:!0},ks={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:hs,G:us,B:!0,Na:!0},Ps={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:hs,G:us,B:!0,Na:!0},Rs={endpoint:"getAccountInfo"},Ns={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new C("internal-error");as(e)},Z:"email",B:!0},xs={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new C("internal-error")},Z:"email",B:!0},As={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new C("internal-error")},Z:"email",B:!0},Ds={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("PASSWORD_RESET"!=e.requestType)throw new C("internal-error");as(e)},Z:"email",B:!0},Os={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Ms={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(e){if(!e.recaptchaSiteKey)throw new C("internal-error")}},Ls={endpoint:"resetPassword",A:gs,Z:"email",B:!0},Fs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},js={endpoint:"setAccountInfo",O:["idToken"],A:ss,V:!0},Us={endpoint:"setAccountInfo",O:["idToken"],A:function(e){if(ss(e),!e.password)throw new C("weak-password")},G:us,V:!0},Vs={endpoint:"signupNewUser",G:us,V:!0,B:!0},qs={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(e){if(!e.phoneEnrollmentInfo)throw new C("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new C("internal-error")},B:!0,Na:!0},Bs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new C("internal-error")},B:!0,Na:!0},Gs={endpoint:"verifyAssertion",A:fs,Za:ps,G:ds,V:!0,B:!0},Ks={endpoint:"verifyAssertion",A:fs,Za:ps,G:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new C("user-not-found");if(e.errorMessage)throw Zs(e.errorMessage);us(e)},V:!0,B:!0},Ws={endpoint:"verifyAssertion",A:function(e){if(fs(e),!e.idToken)throw new C("internal-error")},Za:ps,G:ds,V:!0},zs={endpoint:"verifyCustomToken",A:function(e){if(!e.token)throw new C("invalid-custom-token")},G:us,V:!0,B:!0},Hs={endpoint:"verifyPassword",A:function(e){if(as(e),!e.password)throw new C("wrong-password")},G:us,V:!0,B:!0},Qs={endpoint:"verifyPhoneNumber",A:cs,G:us,B:!0},$s={endpoint:"verifyPhoneNumber",A:function(e){if(!e.idToken)throw new C("internal-error");cs(e)},G:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Go(e);us(e)}},Ys={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:cs,G:us,B:!0},Xs={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(e){if(!!e[Ha]^!!e.refreshToken)throw new C("internal-error")},B:!0,Na:!0};function Js(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return!1}return!0}(n,t.O))return kt(new C("internal-error"));var r,i=!!t.Na,o=t.Vb||"POST";return It(n).then(t.A).then((function(){return t.V&&(n.returnSecureToken=!0),t.B&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),os(e,i?e.i:e.h,t.endpoint,o,n,t.Ib,t.mb||!1)})).then((function(e){return r=e,t.Za?t.Za(n,r):r})).then(t.G).then((function(){if(!t.Z)return r;if(!(t.Z in r))throw new C("internal-error");return r[t.Z]}))}function Zs(e){return eu({error:{errors:[{message:e}],code:400,message:e}})}function eu(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",de(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],t);return!t&&e&&(t=xr(e)),new C("internal-error",t)}function tu(e){this.b=e,this.a=null,this.sb=function(e){return(ou||(ou=new bt((function(e,t){function n(){Lr(),Er("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Lr(),t(Error("Network Error"))},timeout:ru.get()})}if(Er("gapi.iframes.Iframe"))e();else if(Er("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){Er("gapi.load")?n():t(Error("Network Error"))},It(ja(r=Se(nu,{onload:r}))).o((function(){t(Error("Network Error"))}))}})).o((function(e){throw ou=null,e})))).then((function(){return new bt((function(t,n){Er("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:Er("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),iu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var nu=new ye(_e,"https://apis.google.com/js/api.js?onload=%{onload}"),ru=new Fr(3e4,6e4),iu=new Fr(5e3,15e3),ou=null;function au(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,this.g?e=Fn((e=Ln(this.g.url)).c,e.a,e.g,"/emulator/auth/iframe"):e=Fn("https",this.l,null,"/__/auth/iframe"),this.a=e,On(this.a,"apiKey",this.h),On(this.a,"appName",this.i),this.b=null,this.c=[]}function su(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function uu(e){try{return Ft.app(e).auth().Ga()}catch(e){return[]}}function cu(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function lu(e){var t=ar();return function(e){return Js(e,Os,{}).then((function(e){return e.authorizedDomains||[]}))}(e).then((function(e){e:{var n=Ln(t),r=n.c;n=n.a;for(var i=0;i<e.length;i++){var o=e[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Ln(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:hr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){e=!0;break e}}e=!1}if(!e)throw new qo(ar())}))}function hu(e){return e.m||(e.m=pr().then((function(){if(!e.u){var t=e.c,n=e.i,r=uu(e.b),i=new au(e.s,e.g,e.b,e.f);i.f=t,i.b=n,i.c=$(r||[]),e.u=i.toString()}e.v=new tu(e.u),function(e){if(!e.v)throw Error("IfcHandler must be initialized!");!function(e,t){e.sb.then((function(){e.a.register("authEvent",t,Er("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(e.v,(function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=Fo(t.authEvent),n=0;n<e.h.length;n++)r=e.h[n](t)||r;return(n={}).status=r?"ACK":"ERROR",It(n)}return n.status="ERROR",It(n)}))}(e)}))),e.m}function fu(e){return e.l||(e.C=e.c?Cr(e.c,uu(e.b)):null,e.l=new Wa(e.g,R(e.i),e.C),e.f&&Za(e.l,e.f)),e.l}function pu(e,t,n,r,i,o,a,s,u,c,l,h){return(e=new su(e,t,n,r,i,h)).l=o,e.g=a,e.i=s,e.b=fe(u||null),e.f=c,e.zb(l).toString()}function du(e){if(this.a=e||Ft.INTERNAL.reactNative&&Ft.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function vu(e){this.b=e,this.a={},this.f=b(this.c,this)}au.prototype.toString=function(){return this.f?On(this.a,"v",this.f):$n(this.a.b,"v"),this.b?On(this.a,"eid",this.b):$n(this.a.b,"eid"),this.c.length?On(this.a,"fw",this.c.join(",")):$n(this.a.b,"fw"),this.a.toString()},su.prototype.zb=function(e){return this.h=e,this},su.prototype.toString=function(){if(this.v){var e=Ln(this.v.url);e=Fn(e.c,e.a,e.g,"/emulator/auth/handler")}else e=Fn("https",this.u,null,"/__/auth/handler");if(On(e,"apiKey",this.s),On(e,"appName",this.c),On(e,"authType",this.m),this.a.isOAuthProvider){var t=this.a;try{var n=Ft.app(this.c).auth().la()}catch(e){n=null}for(var r in t.pb=n,On(e,"providerId",this.a.providerId),t=Ar((n=this.a).Jb))t[r]=t[r].toString();r=n.Qc,t=fe(t);for(var i=0;i<r.length;i++){var o=r[i];o in t&&delete t[o]}n.qb&&n.pb&&!t[n.qb]&&(t[n.qb]=n.pb),he(t)||On(e,"customParameters",xr(t))}if("function"==typeof this.a.Rb&&((n=this.a.Rb()).length&&On(e,"scopes",n.join(","))),this.l?On(e,"redirectUrl",this.l):$n(e.b,"redirectUrl"),this.g?On(e,"eventId",this.g):$n(e.b,"eventId"),this.i?On(e,"v",this.i):$n(e.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Mn(e,a)&&On(e,a,this.b[a]);return this.h?On(e,"tid",this.h):$n(e.b,"tid"),this.f?On(e,"eid",this.f):$n(e.b,"eid"),(a=uu(this.c)).length&&On(e,"fw",a.join(",")),e.toString()},(e=cu.prototype).Pb=function(e,t,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(e){var t={type:"webStorageSupport"};return hu(e).then((function(){return function(e,t){return e.sb.then((function(){return new bt((function(n){e.a.send(t.type,t,n,Er("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(e.v,t)})).then((function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(e&&cr(e),t(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(e){return new bt((function(t){return function n(){Cn(2e3).then((function(){if(e&&!e.closed)return n();t()}))}()}))}(e)})).then((function(){if(!a)return Cn(n).then((function(){t(r)}))}))},e.Yb=function(){var e=Sr();return!Nr(e)&&!Mr(e)},e.Ub=function(){return!1},e.Nb=function(e,t,n,r,i,o,a,s){if(!e)return kt(new C("popup-blocked"));if(a&&!Nr())return this.ma().o((function(t){cr(e),i(t)})),r(),It();this.a||(this.a=lu(fu(this)));var u=this;return this.a.then((function(){var t=u.ma().o((function(t){throw cr(e),i(t),t}));return r(),t})).then((function(){(Mo(n),a)||sr(pu(u.s,u.g,u.b,t,n,null,o,u.c,void 0,u.i,s,u.f),e)})).o((function(e){throw"auth/network-request-failed"==e.code&&(u.a=null),e}))},e.Ob=function(e,t,n,r){this.a||(this.a=lu(fu(this)));var i=this;return this.a.then((function(){Mo(t),sr(pu(i.s,i.g,i.b,e,t,ar(),n,i.c,void 0,i.i,r,i.f))})).o((function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e}))},e.ma=function(){var e=this;return hu(this).then((function(){return e.v.sb})).o((function(){throw e.a=null,new C("network-request-failed")}))},e.ac=function(){return!0},e.Ea=function(e){this.h.push(e)},e.Ta=function(e){H(this.h,(function(t){return t==e}))},(e=du.prototype).get=function(e){return It(this.a.getItem(e)).then((function(e){return e&&Dr(e)}))},e.set=function(e,t){return It(this.a.setItem(e,xr(t)))},e.U=function(e){return It(this.a.removeItem(e))},e.ca=function(){},e.ia=function(){};var yu,mu=[];function gu(e,t,n){he(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function bu(e){this.a=e}function _u(e){this.c=e,this.b=!1,this.a=[]}function wu(e,t,n,r){var i,o,a,s,u=n||{},c=null;if(e.b)return kt(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new bt((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},e.a.push(c),h.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(t){return Tu(e,c),t})).o((function(t){throw Tu(e,c),t}))}function Tu(e,t){if(t){var n=t.messageChannel,r=t.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),H(e.a,(function(e){return e==t}))}}function Cu(){if(!ku())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var e=this;yr()&&self?(this.v=function(){var e=yr()?self:null;if(q(mu,(function(n){n.b==e&&(t=n)})),!t){var t=new vu(e);mu.push(t)}return t}(),gu(this.v,"keyChanged",(function(t,n){return Au(e).then((function(t){return 0<t.length&&q(e.a,(function(e){e(t)})),{keyProcessed:W(t,n.key)}}))})),gu(this.v,"ping",(function(){return It(["keyChanged"])}))):function(){var e=a.navigator;return e&&e.serviceWorker?It().then((function(){return e.serviceWorker.ready})).then((function(e){return e.active||null})).o((function(){return null})):It(null)}().then((function(t){(e.h=t)&&(e.g=new _u(new bu(t)),wu(e.g,"ping",null,!0).then((function(t){t[0].fulfilled&&W(t[0].value,"keyChanged")&&(e.s=!0)})).o((function(){})))}))}function Su(e){return new bt((function(t,n){var r=e.m.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):function(e){return new bt((function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}}))}(e).then((function(){return Su(e)})).then((function(e){t(e)})).o((function(e){n(e)}))}}))}function Eu(e){return e.i||(e.i=Su(e)),e.i}function Iu(e,t){var n=0;return new bt((function r(i,o){Eu(e).then(t).then(i).o((function(t){if(!(3<++n))return Eu(e).then((function(t){return t.close(),e.i=void 0,r(i,o)})).o((function(e){o(e)}));o(t)}))}))}function ku(){try{return!!a.indexedDB}catch(e){return!1}}function Pu(e){return e.objectStore("firebaseLocalStorage")}function Ru(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function Nu(e){return new bt((function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}}))}function xu(e,t){return e.g&&e.h&&function(){var e=a.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?wu(e.g,"keyChanged",{key:t},e.s).then((function(){})).o((function(){})):It()}function Au(e){return Eu(e).then((function(e){var t=Pu(Ru(e,!1));return t.getAll?Nu(t.getAll()):new bt((function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}}))})).then((function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=function e(t,n){var r,i=[];for(r in t)r in n?typeof t[r]!=typeof n[r]?i.push(r):"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(e.c,n),e.c=n}return r}))}function Du(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Ou(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=It().then((function(){if(ku()){var e=Or(),r="__sak"+e;return yu||(yu=new Cu),(n=yu).set(r,e).then((function(){return n.get(r)})).then((function(t){if(t!==e)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return t.c}))}return t.c})).then((function(e){return t.type=e.type,e.ca((function(e){q(t.a,(function(t){t(e)}))})),e}))}function Mu(){this.a={},this.type="inMemory"}function Lu(){if(!function(){var e="Node"==mr();if(!(e=Fu()||e&&Ft.INTERNAL.node&&Ft.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==mr())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Fu()||Ft.INTERNAL.node.localStorage,this.type="localStorage"}function Fu(){try{var e=a.localStorage,t=Or();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function ju(){this.type="nullStorage"}function Uu(){if(!function(){var e="Node"==mr();if(!(e=Vu()||e&&Ft.INTERNAL.node&&Ft.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==mr())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Vu()||Ft.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Vu(){try{var e=a.sessionStorage,t=Or();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function qu(){var e={};e.Browser=Ku,e.Node=Wu,e.ReactNative=zu,e.Worker=Hu,this.a=e[mr()]}vu.prototype.c=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];q(r,(function(t){i.push(It().then((function(){return t(e.origin,e.data.data)})))})),Rt(i).then((function(r){var i=[];q(r,(function(e){i.push({fulfilled:e.Qb,value:e.value,reason:e.reason?e.reason.message:void 0})})),q(i,(function(e){for(var t in e)void 0===e[t]&&delete e[t]})),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})}))}},bu.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},_u.prototype.close=function(){for(;0<this.a.length;)Tu(this,this.a[0]);this.b=!0},(e=Cu.prototype).set=function(e,t){var n=this,r=!1;return Iu(this,(function(t){return Nu((t=Pu(Ru(t,!0))).get(e))})).then((function(i){return Iu(n,(function(o){if(o=Pu(Ru(o,!0)),i)return i.value=t,Nu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=e,a.value=t,Nu(o.add(a))}))})).then((function(){return n.c[e]=t,xu(n,e)})).oa((function(){r&&n.b--}))},e.get=function(e){return Iu(this,(function(t){return Nu(Pu(Ru(t,!1)).get(e))})).then((function(e){return e&&e.value}))},e.U=function(e){var t=this,n=!1;return Iu(this,(function(r){return n=!0,t.b++,Nu(Pu(Ru(r,!0)).delete(e))})).then((function(){return delete t.c[e],xu(t,e)})).oa((function(){n&&t.b--}))},e.ca=function(e){0==this.a.length&&function(e){Du(e),function t(){e.f=setTimeout((function(){e.l=Au(e).then((function(t){0<t.length&&q(e.a,(function(e){e(t)}))})).then((function(){t()})).o((function(e){"STOP_EVENT"!=e.message&&t()}))}),800)}()}(this),this.a.push(e)},e.ia=function(e){H(this.a,(function(t){return t==e})),0==this.a.length&&Du(this)},(e=Ou.prototype).get=function(e){return this.b.then((function(t){return t.get(e)}))},e.set=function(e,t){return this.b.then((function(n){return n.set(e,t)}))},e.U=function(e){return this.b.then((function(t){return t.U(e)}))},e.ca=function(e){this.a.push(e)},e.ia=function(e){H(this.a,(function(t){return t==e}))},(e=Mu.prototype).get=function(e){return It(this.a[e])},e.set=function(e,t){return this.a[e]=t,It()},e.U=function(e){return delete this.a[e],It()},e.ca=function(){},e.ia=function(){},(e=Lu.prototype).get=function(e){var t=this;return It().then((function(){return Dr(t.a.getItem(e))}))},e.set=function(e,t){var n=this;return It().then((function(){var r=xr(t);null===r?n.U(e):n.a.setItem(e,r)}))},e.U=function(e){var t=this;return It().then((function(){t.a.removeItem(e)}))},e.ca=function(e){a.window&&an(a.window,"storage",e)},e.ia=function(e){a.window&&cn(a.window,"storage",e)},(e=ju.prototype).get=function(){return It(null)},e.set=function(){return It()},e.U=function(){return It()},e.ca=function(){},e.ia=function(){},(e=Uu.prototype).get=function(e){var t=this;return It().then((function(){return Dr(t.a.getItem(e))}))},e.set=function(e,t){var n=this;return It().then((function(){var r=xr(t);null===r?n.U(e):n.a.setItem(e,r)}))},e.U=function(e){var t=this;return It().then((function(){t.a.removeItem(e)}))},e.ca=function(){},e.ia=function(){};var Bu,Gu,Ku={F:Lu,cb:Uu},Wu={F:Lu,cb:Uu},zu={F:du,cb:ju},Hu={F:Lu,cb:ju},Qu={rd:"local",NONE:"none",td:"session"};function $u(){var e=!(Mr(Sr())||!vr()),t=Nr(),n=Ir();this.m=e,this.h=t,this.l=n,this.a={},Bu||(Bu=new qu),e=Bu;try{this.g=!or()&&Vr()||!a.indexedDB?new e.a.F:new Ou(yr()?new Mu:new e.a.F)}catch(e){this.g=new Mu,this.h=!0}try{this.i=new e.a.cb}catch(e){this.i=new Mu}this.v=new Mu,this.f=b(this.Zb,this),this.b={}}function Yu(){return Gu||(Gu=new $u),Gu}function Xu(e,t){switch(t){case"session":return e.i;case"none":return e.v;default:return e.g}}function Ju(e,t){return"firebase:"+e.name+(t?":"+t:"")}function Zu(e,t,n){return n=Ju(t,n),"local"==t.F&&(e.b[n]=null),Xu(e,t.F).U(n)}function ec(e){e.c&&(clearInterval(e.c),e.c=null)}function tc(e){this.a=e,this.b=Yu()}(e=$u.prototype).get=function(e,t){return Xu(this,e.F).get(Ju(e,t))},e.set=function(e,t,n){var r=Ju(e,n),i=this,o=Xu(this,e.F);return o.set(r,t).then((function(){return o.get(r)})).then((function(t){"local"==e.F&&(i.b[r]=t)}))},e.addListener=function(e,t,n){e=Ju(e,t),this.l&&(this.b[e]=a.localStorage.getItem(e)),he(this.a)&&(Xu(this,"local").ca(this.f),this.h||(or()||!Vr())&&a.indexedDB||!this.l||function(e){ec(e),e.c=setInterval((function(){for(var t in e.a){var n=a.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new Qt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Zb(n))}}),1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Ju(e,t),this.a[e]&&(H(this.a[e],(function(e){return e==n})),0==this.a[e].length&&delete this.a[e]),he(this.a)&&(Xu(this,"local").ia(this.f),ec(this))},e.Zb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?Xu(this,"local").ia(this.f):ec(this),this.m)if(n=a.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?a.localStorage.setItem(t,r):a.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===a.localStorage.getItem(t)||(o.b[t]=a.localStorage.getItem(t),o.nb(t))},ze&&ot&&10==ot&&a.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else q(e,b(this.nb,this))},e.nb=function(e){this.a[e]&&q(this.a[e],(function(e){e()}))};var nc,rc={name:"authEvent",F:"local"};function ic(){this.a=Yu()}function oc(e,t){this.b=ac,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===nc&&(nc=a.Int32Array?new Int32Array(pc):pc),this.reset()}w(oc,(function(){this.b=-1}));for(var ac=64,sc=ac-1,uc=[],cc=0;cc<sc;cc++)uc[cc]=0;var lc=Q(128,uc);function hc(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|nc[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function fc(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"==typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(hc(e),i=0);else{if(!f(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(hc(e),i=0)}}e.c=i,e.g+=n}oc.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):$(this.h)};var pc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function dc(){oc.call(this,8,vc)}w(dc,oc);var vc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function yc(e,t,n,r,i,o){this.v=e,this.i=t,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.C=new ic,this.g=new tc(this.h),this.f=null,this.b=[],this.a=this.c=null}function mc(e){return new C("invalid-cordova-configuration",e)}function gc(e){var t=new dc;fc(t,e),e=[];var n=8*t.g;56>t.c?fc(t,lc,56-t.c):fc(t,lc,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(hc(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return G(e,(function(e){return 1<(e=e.toString(16)).length?e:"0"+e})).join("")}(e)}function bc(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function _c(e){return e.f||(e.f=e.ma().then((function(){return new bt((function(t){e.Ea((function n(r){return t(r),e.Ta(n),!1})),function(e){function t(t){r=!0,i&&i.cancel(),wc(e).then((function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=eo(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Dr(Mn(o=Ln(i),"firebaseError")||null))?S(o):null)?new Lo(r.c,r.b,null,null,o,null,r.T()):new Lo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}bc(e,i)}))}var n=new Lo("unknown",null,null,null,new C("no-auth-event")),r=!1,i=Cn(500).then((function(){return wc(e).then((function(){r||bc(e,n)}))})),o=a.handleOpenURL;a.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(Er("BuildInfo.packageName",a).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(e){console.error(e)}},Vo||(Vo=new jo),function(e){var t=Vo;t.a.push(e),t.b||(t.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=Er("universalLinks.subscribe",a))&&e(null,t.b))}(t)}(e)}))}))),e.f}function wc(e){var t=null;return function(e){return e.b.get(rc,e.a).then((function(e){return Fo(e)}))}(e.g).then((function(n){return t=n,Zu((n=e.g).b,rc,n.a)})).then((function(){return t}))}function Tc(e){this.a=e,this.b=Yu()}(e=yc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(dr(void 0)?pr().then((function(){return new bt((function(e,t){var n=a.document,r=setTimeout((function(){t(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),e()}),!1)}))})):kt(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Er("universalLinks.subscribe",a))throw mc("cordova-universal-links-plugin-fix is not installed");if(void 0===Er("BuildInfo.packageName",a))throw mc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Er("cordova.plugins.browsertab.openUrl",a))throw mc("cordova-plugin-browsertab is not installed");if("function"!=typeof Er("cordova.InAppBrowser.open",a))throw mc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},e.Pb=function(e,t){return t(new C("operation-not-supported-in-this-environment")),It()},e.Nb=function(){return kt(new C("operation-not-supported-in-this-environment"))},e.ac=function(){return!1},e.Yb=function(){return!0},e.Ub=function(){return!0},e.Ob=function(e,t,n,r){if(this.c)return kt(new C("redirect-operation-pending"));var i=this,o=a.document,s=null,u=null,c=null,l=null;return this.c=It().then((function(){return Mo(t),_c(i)})).then((function(){return function(e,t,n,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),s=new Lo(t,r,null,o,new C("no-auth-event"),null,i),u=Er("BuildInfo.packageName",a);if("string"!=typeof u)throw new C("invalid-cordova-configuration");var c=Er("BuildInfo.displayName",a),l={};if(Sr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!Sr().toLowerCase().match(/android/))return kt(new C("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=gc(o),l.sessionId=o;var h=pu(e.v,e.i,e.l,t,n,null,r,e.m,l,e.u,i,e.s);return e.ma().then((function(){var t=e.h;return e.C.a.set(rc,s.w(),t)})).then((function(){var t=Er("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof t)throw new C("invalid-cordova-configuration");var n=null;t((function(t){if(t){if("function"!=typeof(n=Er("cordova.plugins.browsertab.openUrl",a)))throw new C("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Er("cordova.InAppBrowser.open",a)))throw new C("invalid-cordova-configuration");t=Sr(),e.a=n(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,e,t,n,r)})).then((function(){return new bt((function(e,t){u=function(){var t=Er("cordova.plugins.browsertab.close",a);return e(),"function"==typeof t&&t(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),c=function(){s||(s=Cn(2e3).then((function(){t(new C("redirect-cancelled-by-user"))})))},l=function(){jr()&&c()},o.addEventListener("resume",c,!1),Sr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(e){return wc(i).then((function(){throw e}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),s&&s.cancel(),u&&i.Ta(u),i.c=null}))},e.Ea=function(e){this.b.push(e),_c(this).o((function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new Lo("unknown",null,null,null,new C("no-auth-event")),e(t))}))},e.Ta=function(e){H(this.b,(function(t){return t==e}))};var Cc={name:"pendingRedirect",F:"session"};function Sc(e){return Zu(e.b,Cc,e.a)}function Ec(e,t,n,r){this.i={},this.u=0,this.D=e,this.v=t,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=b(this.s,this),this.b=new Vc,this.C=new Wc,this.g=new Tc(jc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Ic(this.D,this.v,this.m,E,this.J)}function Ic(e,t,n,r,i){var o=Ft.SDK_VERSION||null;return dr()?new yc(e,t,n,o,r,i):new cu(e,t,n,o,r,i)}function kc(e){e.f||(e.f=!0,e.a.Ea(e.l));var t=e.a;return e.a.ma().o((function(n){throw e.a==t&&e.reset(),n}))}function Pc(e){e.a.Yb()&&kc(e).o((function(t){var n=new Lo("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Oc(t)&&e.s(n)})),e.a.Ub()||qc(e.b)}function Rc(e,t){W(e.h,t)||e.h.push(t),e.f||function(e){return e.b.get(Cc,e.a).then((function(e){return"pending"==e}))}(e.g).then((function(t){t?Sc(e.g).then((function(){kc(e).o((function(t){var n=new Lo("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Oc(t)&&e.s(n)}))})):Pc(e)})).o((function(){Pc(e)}))}function Nc(e,t){H(e.h,(function(e){return e==t}))}Ec.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Ic(this.D,this.v,this.m,null,this.J),this.i={}},Ec.prototype.s=function(e){if(!e)throw new C("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=Date.now())),t=!0;break}}return qc(this.b),t};var xc=new Fr(2e3,1e4),Ac=new Fr(3e4,6e4);function Dc(e,t,n,r,i,o,a){return e.a.Nb(t,n,r,(function(){e.f||(e.f=!0,e.a.Ea(e.l))}),(function(){e.reset()}),i,o,a)}function Oc(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function Mc(e,t,n,r,i){var o;return function(e){return e.b.set(Cc,"pending",e.a)}(e.g).then((function(){return e.a.Ob(t,n,r,i).o((function(t){if(Oc(t))throw new C("operation-not-supported-in-this-environment");return o=t,Sc(e.g).then((function(){throw o}))})).then((function(){return e.a.ac()?new bt((function(){})):Sc(e.g).then((function(){return e.ra()})).then((function(){})).o((function(){}))}))}))}function Lc(e,t,n,r,i){return e.a.Pb(r,(function(e){t.na(n,null,e,i)}),xc.get())}Ec.prototype.ra=function(){return this.b.ra()};var Fc={};function jc(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function Uc(e,t,n,r){var i=jc(t,n,r);return Fc[i]||(Fc[i]=new Ec(e,t,n,r)),Fc[i]}function Vc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function qc(e){e.g||(e.g=!0,Kc(e,!1,null,null))}function Bc(e){e.g&&!e.i&&Kc(e,!1,null,null)}function Gc(e,t){if(e.b=function(){return It(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Kc(e,t,n,r){t?r?function(e,t){if(e.b=function(){return kt(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):Gc(e,n):Gc(e,{user:null}),e.f=[],e.c=[]}function Wc(){}function zc(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(e){this.jb=e},enumerable:!1})}function Hc(e,t){this.a=t,Wr(this,"verificationId",e)}function Qc(e,t,n,r){return new Ao(e).gb(t,n).then((function(e){return new Hc(e,r)}))}function $c(e){var t=Vi(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");zr(this,{token:e,expirationTime:Ur(1e3*t.exp),authTime:Ur(1e3*t.auth_time),issuedAtTime:Ur(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function Yc(e,t,n){var r=t&&t[Jc];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=fe(t),this.g=n,this.c=new to(null,r),this.b=[];var i=this;q(t[Xc]||[],(function(e){(e=Yr(e))&&i.b.push(e)})),Wr(this,"auth",this.a),Wr(this,"session",this.c),Wr(this,"hints",this.b)}Vc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Vc.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Kc(this,!0,null,e.a),It()):t.Fa(n,r)?function(e,t,n){n=n.Fa(t.c,t.b);var r=t.g,i=t.f,o=t.i,a=t.T(),s=!!t.c.match(/Redirect$/);n(r,i,a,o).then((function(t){Kc(e,s,t,null)})).o((function(t){Kc(e,s,null,t)}))}(this,e,t):kt(new C("invalid-auth-event")):(Kc(this,!1,null,null),It())}else kt(new C("invalid-auth-event"))},Vc.prototype.ra=function(){var e=this;return new bt((function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new C("timeout");e.a&&e.a.cancel(),e.a=Cn(Ac.get()).then((function(){e.b||(e.g=!0,Kc(e,!0,null,t))}))}(e))}))},Wc.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.na(e.c,null,e.a,e.b),It()):t.Fa(n,r)?function(e,t){var n=e.b,r=e.c;t.Fa(r,n)(e.g,e.f,e.T(),e.i).then((function(e){t.na(r,e,null,n)})).o((function(e){t.na(r,null,e,n)}))}(e,t):kt(new C("invalid-auth-event"))}else kt(new C("invalid-auth-event"))},Hc.prototype.confirm=function(e){return e=Do(this.verificationId,e),this.a(e)};var Xc="mfaInfo",Jc="mfaPendingCredential";function Zc(e,t,n,r){C.call(this,"multi-factor-auth-required",r,t),this.b=new Yc(e,t,n),Wr(this,"resolver",this.b)}function el(e,t,n){if(e&&d(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new Zc(t,e.serverResponse,n,e.message)}catch(e){}return null}function tl(){}function nl(e){Wr(this,"factorId",e.fa),this.a=e}function rl(e){if(nl.call(this,e),this.a.fa!=Ao.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function il(e,t){for(var n in Ht.call(this,e),t)this[n]=t[n]}function ol(e,t){this.a=e,this.b=[],this.c=b(this.yc,this),an(this.a,"userReloaded",this.c);var n=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&q(t.multiFactor.enrolledFactors,(function(e){var t=null,r={};if(e){e.uid&&(r[Zr]=e.uid),e.displayName&&(r[Xr]=e.displayName),e.enrollmentTime&&(r[Jr]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(r[ei]=e.phoneNumber);try{t=new ti(r)}catch(e){}e=t}else e=null;e&&n.push(e)})),al(this,n)}function al(e,t){e.b=t,Wr(e,"enrolledFactors",t)}function sl(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ul(e){this.f=e,this.b=this.a=null,this.c=Date.now()}function cl(e,t){void 0===t&&(e.b?t=(t=e.b).a-t.g:t=0),e.c=Date.now()+1e3*t}function ll(e,t){e.b=Ui(t[Ha]||""),e.a=t.refreshToken,cl(e,void 0!==(t=t.expiresIn)?Number(t):void 0)}function hl(e,t){return function(e,t){return new bt((function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?ns(e,e.l+"?key="+encodeURIComponent(e.c),(function(e){e?e.error?r(eu(e)):e.access_token&&e.refresh_token?n(e):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",Qn(t).toString(),e.g,e.m.get()):r(new C("internal-error"))}))}(e.f,t).then((function(t){return e.b=Ui(t.access_token),e.a=t.refresh_token,cl(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}})).o((function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t}))}function fl(e,t){this.a=e||null,this.b=t||null,zr(this,{lastSignInTime:Ur(t||null),creationTime:Ur(e||null)})}function pl(e,t,n,r,i,o){zr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function dl(e,t,n){this.N=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var r=Ft.SDK_VERSION?Cr(Ft.SDK_VERSION):null;this.a=new Wa(this.l,R(E),r),(this.u=e.emulatorConfig||null)&&Za(this.a,this.u),this.h=new ul(this.a),Cl(this,t[Ha]),ll(this.h,t),Wr(this,"refreshToken",this.h.a),Il(this,n||{}),gn.call(this),this.P=!1,this.s&&kr()&&(this.b=Uc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(e){return new sl((function(){return e.I(!0)}),(function(e){return!(!e||"auth/network-request-failed"!=e.code)}),(function(){var t=e.h.c-Date.now()-3e5;return 0<t?t:0}))}(this),this.ba=b(this.ib,this);var i=this;this.za=null,this.Pa=function(e){i.xa(e.h)},this.qa=null,this.Ba=function(e){vl(i,e.c)},this.$=null,this.aa=[],this.Oa=function(e){gl(i,e.f)},this.ja=null,this.S=new ol(this,n),Wr(this,"multiFactor",this.S)}function vl(e,t){e.u=t,Za(e.a,t),e.b&&(t=e.b,e.b=Uc(e.s,e.l,e.m,e.u),e.P&&(Nc(t,e),Rc(e.b,e)))}function yl(e,t){e.qa&&cn(e.qa,"languageCodeChanged",e.Pa),(e.qa=t)&&an(t,"languageCodeChanged",e.Pa)}function ml(e,t){e.$&&cn(e.$,"emulatorConfigChanged",e.Ba),(e.$=t)&&an(t,"emulatorConfigChanged",e.Ba)}function gl(e,t){e.aa=t,ts(e.a,Ft.SDK_VERSION?Cr(Ft.SDK_VERSION,e.aa):null)}function bl(e,t){e.ja&&cn(e.ja,"frameworkChanged",e.Oa),(e.ja=t)&&an(t,"frameworkChanged",e.Oa)}function _l(e){try{return Ft.app(e.m).auth()}catch(t){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function wl(e){e.J||e.D.b||(e.D.start(),cn(e,"tokenChanged",e.ba),an(e,"tokenChanged",e.ba))}function Tl(e){cn(e,"tokenChanged",e.ba),e.D.stop()}function Cl(e,t){e.Aa=t,Wr(e,"_lat",t)}function Sl(e){for(var t=[],n=0;n<e.W.length;n++)t.push(e.W[n](e));return Rt(t).then((function(){return e}))}function El(e){e.b&&!e.P&&(e.P=!0,Rc(e.b,e))}function Il(e,t){zr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new fl(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function kl(){}function Pl(e){return It().then((function(){if(e.J)throw new C("app-deleted")}))}function Rl(e){return G(e.providerData,(function(e){return e.providerId}))}function Nl(e,t){t&&(xl(e,t.providerId),e.providerData.push(t))}function xl(e,t){H(e.providerData,(function(e){return e.providerId==t}))}function Al(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Wr(e,t,n)}function Dl(e,t){e!=t&&(zr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),t.metadata?Wr(e,"metadata",function(e){return new fl(e.a,e.b)}(t.metadata)):Wr(e,"metadata",new fl),q(t.providerData,(function(t){Nl(e,t)})),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.h,t.h),Wr(e,"refreshToken",e.h.a),al(e.S,t.S.b))}function Ol(e){return e.I().then((function(t){var n=e.isAnonymous;return function(e,t){return Js(e.a,Rs,{idToken:t}).then(b(e.Kc,e))}(e,t).then((function(){return n||Al(e,"isAnonymous",!1),t}))}))}function Ml(e,t){t[Ha]&&e.Aa!=t[Ha]&&(ll(e.h,t),e.dispatchEvent(new il("tokenChanged")),Cl(e,t[Ha]),Al(e,"refreshToken",e.h.a))}function Ll(e,t){return Ol(e).then((function(){if(W(Rl(e),t))return Sl(e).then((function(){throw new C("provider-already-linked")}))}))}function Fl(e,t,n){return Hr({user:e,credential:Oo(t),additionalUserInfo:t=Wi(t),operationType:n})}function jl(e,t){return Ml(e,t),e.reload().then((function(){return e}))}function Ul(e,t,n,r,i){if(!kr())return kt(new C("operation-not-supported-in-this-environment"));if(e.i&&!i)return kt(e.i);var o=Ki(n.providerId),a=Or(e.uid+":::"),s=null;(!Nr()||vr())&&e.s&&n.isOAuthProvider&&(s=pu(e.s,e.l,e.m,t,n,null,a,Ft.SDK_VERSION||null,null,null,e.tenantId,e.u));var u=lr(s,o&&o.va,o&&o.ua);return r=r().then((function(){if(ql(e),!i)return e.I().then((function(){}))})).then((function(){return Dc(e.b,u,t,n,a,!!s,e.tenantId)})).then((function(){return new bt((function(n,r){e.na(t,null,new C("cancelled-popup-request"),e.g||null),e.f=n,e.C=r,e.g=a,e.c=Lc(e.b,e,t,u,a)}))})).then((function(e){return u&&cr(u),e?Hr(e):null})).o((function(e){throw u&&cr(u),e})),Bl(e,r,i)}function Vl(e,t,n,r,i){if(!kr())return kt(new C("operation-not-supported-in-this-environment"));if(e.i&&!i)return kt(e.i);var o=null,a=Or(e.uid+":::");return r=r().then((function(){if(ql(e),!i)return e.I().then((function(){}))})).then((function(){return e.ga=a,Sl(e)})).then((function(t){return e.ha&&(t=(t=e.ha).b.set(Wl,e.w(),t.a)),t})).then((function(){return Mc(e.b,t,n,a,e.tenantId)})).o((function(t){if(o=t,e.ha)return zl(e.ha);throw o})).then((function(){if(o)throw o})),Bl(e,r,i)}function ql(e){if(!e.b||!e.P){if(e.b&&!e.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function Bl(e,t,n){var r=function(e,t,n){return e.i&&!n?(t.cancel(),kt(e.i)):t.o((function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.i||e.dispatchEvent(new il("userInvalidated")),e.i=t),t}))}(e,t,n);return e.N.push(r),r.oa((function(){z(e.N,r)})),r.o((function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=el(t.w(),_l(e),b(e.jc,e))),n||t}))}function Gl(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[Ha]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=e.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new dl(t,n,e);return e.providerData&&q(e.providerData,(function(e){e&&Nl(i,Hr(e))})),e.redirectEventId&&(i.ga=e.redirectEventId),i}function Kl(e){this.a=e,this.b=Yu()}Yc.prototype.Rc=function(e){var t=this;return e.tb(this.a.a,this.c).then((function(e){var n=fe(t.f);return delete n[Xc],delete n[Jc],de(n,e),t.g(n)}))},w(Zc,C),tl.prototype.tb=function(e,t,n){return t.type==no?function(e,t,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),de(n,{phoneVerificationInfo:xo(e.a)}),Js(t,ks,n)}))}(this,e,t,n):function(e,t,n){return n.Ha().then((function(n){return de(n={mfaPendingCredential:n},{phoneVerificationInfo:xo(e.a)}),Js(t,Ps,n)}))}(this,e,t)},w(nl,tl),w(rl,nl),w(il,Ht),(e=ol.prototype).yc=function(e){al(this,function(e){var t=[];return q(e.mfaInfo||[],(function(e){(e=Yr(e))&&t.push(e)})),t}(e.hd))},e.Sb=function(){return this.a.I().then((function(e){return new to(e,null)}))},e.fc=function(e,t){var n=this,r=this.a.a;return this.Sb().then((function(n){return e.tb(r,n,t)})).then((function(e){return Ml(n.a,e),n.a.reload()}))},e.bd=function(e){var t=this,n="string"==typeof e?e:e.uid,r=this.a.a;return this.a.I().then((function(e){return Js(r,Xs,{idToken:e,mfaEnrollmentId:n})})).then((function(e){var r=B(t.b,(function(e){return e.uid!=n}));return al(t,r),Ml(t.a,e),t.a.reload().o((function(e){if("auth/user-token-expired"!=e.code)throw e}))}))},e.w=function(){return{multiFactor:{enrolledFactors:G(this.b,(function(e){return e.w()}))}}},sl.prototype.start=function(){this.a=this.c,function e(t,n){t.stop(),t.b=Cn(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(t,n)).then((function(){return function(){var e=a.document,t=null;return jr()||!e?It():new bt((function(n){t=function(){jr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)})).o((function(n){throw e.removeEventListener("visibilitychange",t,!1),n}))}()})).then((function(){return t.h()})).then((function(){e(t,!0)})).o((function(n){t.i(n)&&e(t,!1)}))}(this,!0)},sl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ul.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},ul.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?kt(new C("user-token-expired")):e||!this.b||Date.now()>this.c-3e4?this.a?hl(this,{grant_type:"refresh_token",refresh_token:this.a}):It(null):It({accessToken:this.b.toString(),refreshToken:this.a})},fl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},w(dl,gn),dl.prototype.xa=function(e){this.za=e,Ja(this.a,e)},dl.prototype.la=function(){return this.za},dl.prototype.Ga=function(){return $(this.aa)},dl.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Wr(dl.prototype,"providerId","firebase"),(e=dl.prototype).reload=function(){var e=this;return Bl(this,Pl(this).then((function(){return Ol(e).then((function(){return Sl(e)})).then(kl)})))},e.oc=function(e){return this.I(e).then((function(e){return new $c(e)}))},e.I=function(e){var t=this;return Bl(this,Pl(this).then((function(){return t.h.getToken(e)})).then((function(e){if(!e)throw new C("internal-error");return e.accessToken!=t.Aa&&(Cl(t,e.accessToken),t.dispatchEvent(new il("tokenChanged"))),Al(t,"refreshToken",e.refreshToken),e.accessToken})))},e.Kc=function(e){if(!(e=e.users)||!e.length)throw new C("internal-error");Il(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?G(e,(function(e){return new pl(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)})):[]}(e),n=0;n<t.length;n++)Nl(this,t[n]);Al(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new il("userReloaded",{hd:e}))},e.Lc=function(e){return Gr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(e)},e.ub=function(e){var t=this,n=null;return Bl(this,e.c(this.a,this.uid).then((function(e){return Ml(t,e),n=Fl(t,e,"reauthenticate"),t.i=null,t.reload()})).then((function(){return n})),!0)},e.Cc=function(e){return Gr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(e)},e.rb=function(e){var t=this,n=null;return Bl(this,Ll(this,e.providerId).then((function(){return t.I()})).then((function(n){return e.b(t.a,n)})).then((function(e){return n=Fl(t,e,"link"),jl(t,e)})).then((function(){return n})))},e.Dc=function(e,t){var n=this;return Bl(this,Ll(this,"phone").then((function(){return Qc(_l(n),e,t,b(n.rb,n))})))},e.Mc=function(e,t){var n=this;return Bl(this,It().then((function(){return Qc(_l(n),e,t,b(n.ub,n))})),!0)},e.Cb=function(e){var t=this;return Bl(this,this.I().then((function(n){return t.a.Cb(n,e)})).then((function(e){return Ml(t,e),t.reload()})))},e.ed=function(e){var t=this;return Bl(this,this.I().then((function(n){return e.b(t.a,n)})).then((function(e){return Ml(t,e),t.reload()})))},e.Db=function(e){var t=this;return Bl(this,this.I().then((function(n){return t.a.Db(n,e)})).then((function(e){return Ml(t,e),t.reload()})))},e.Eb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Pl(this);var t=this;return Bl(this,this.I().then((function(n){return t.a.Eb(n,{displayName:e.displayName,photoUrl:e.photoURL})})).then((function(e){return Ml(t,e),Al(t,"displayName",e.displayName||null),Al(t,"photoURL",e.photoUrl||null),q(t.providerData,(function(e){"password"===e.providerId&&(Wr(e,"displayName",t.displayName),Wr(e,"photoURL",t.photoURL))})),Sl(t)})).then(kl))},e.cd=function(e){var t=this;return Bl(this,Ol(this).then((function(n){return W(Rl(t),e)?function(e,t,n){return Js(e,Ss,{idToken:t,deleteProvider:n})}(t.a,n,[e]).then((function(e){var n={};return q(e.providerUserInfo||[],(function(e){n[e.providerId]=!0})),q(Rl(t),(function(e){n[e]||xl(t,e)})),n[Ao.PROVIDER_ID]||Wr(t,"phoneNumber",null),Sl(t)})):Sl(t).then((function(){throw new C("no-such-provider")}))})))},e.delete=function(){var e=this;return Bl(this,this.I().then((function(t){return Js(e.a,Cs,{idToken:t})})).then((function(){e.dispatchEvent(new il("userDeleted"))}))).then((function(){for(var t=0;t<e.N.length;t++)e.N[t].cancel("app-deleted");yl(e,null),ml(e,null),bl(e,null),e.N=[],e.J=!0,Tl(e),Wr(e,"refreshToken",null),e.b&&Nc(e.b,e)}))},e.Gb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},e.na=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?b(this.Lb,this):"reauthViaPopup"==e&&t==(this.g||null)?b(this.Mb,this):"linkViaRedirect"==e&&(this.ga||null)==t?b(this.Lb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?b(this.Mb,this):null},e.Ec=function(e){var t=this;return Ul(this,"linkViaPopup",e,(function(){return Ll(t,e.providerId).then((function(){return Sl(t)}))}),!1)},e.Nc=function(e){return Ul(this,"reauthViaPopup",e,(function(){return It()}),!0)},e.Fc=function(e){var t=this;return Vl(this,"linkViaRedirect",e,(function(){return Ll(t,e.providerId)}),!1)},e.Oc=function(e){return Vl(this,"reauthViaRedirect",e,(function(){return It()}),!0)},e.Lb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Bl(this,this.I().then((function(n){return ys(i.a,{requestUri:e,postBody:r,sessionId:t,idToken:n})})).then((function(e){return o=Fl(i,e,"link"),jl(i,e)})).then((function(){return o})))},e.Mb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Bl(this,It().then((function(){return oo(ms(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)})).then((function(e){return o=Fl(i,e,"reauthenticate"),Ml(i,e),i.i=null,i.reload()})).then((function(){return o})),!0)},e.vb=function(e){var t=this,n=null;return Bl(this,this.I().then((function(t){return n=t,void 0===e||he(e)?{}:Mi(new Ei(e))})).then((function(e){return t.a.vb(n,e)})).then((function(e){if(t.email!=e)return t.reload()})).then((function(){})))},e.Fb=function(e,t){var n=this,r=null;return Bl(this,this.I().then((function(e){return r=e,void 0===t||he(t)?{}:Mi(new Ei(t))})).then((function(t){return n.a.Fb(r,e,t)})).then((function(e){if(n.email!=e)return n.reload()})).then((function(){})))},e.jc=function(e){var t=null,n=this;return Bl(this,e=oo(It(e),n.uid).then((function(e){return t=Fl(n,e,"reauthenticate"),Ml(n,e),n.i=null,n.reload()})).then((function(){return t})),!0)},e.toJSON=function(){return this.w()},e.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&de(e,this.metadata.w()),q(this.providerData,(function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))})),de(e,this.S.w()),e};var Wl={name:"redirectUser",F:"session"};function zl(e){return Zu(e.b,Wl,e.a)}function Hl(e){this.a=e,this.b=Yu(),this.c=null,this.f=function(e){var t=Yl("local"),n=Yl("session"),r=Yl("none");return function(e,t,n){var r=Ju(t,n),i=Xu(e,t.F);return e.get(t,n).then((function(o){var s=null;try{s=Dr(a.localStorage.getItem(r))}catch(e){}if(s&&!o)return a.localStorage.removeItem(r),e.set(t,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)}))}(e.b,t,e.a).then((function(){return e.b.get(n,e.a)})).then((function(i){return i?n:e.b.get(r,e.a).then((function(n){return n?r:e.b.get(t,e.a).then((function(n){return n?t:e.b.get($l,e.a).then((function(e){return e?Yl(e):t}))}))}))})).then((function(t){return e.c=t,Ql(e,t.F)})).o((function(){e.c||(e.c=t)}))}(this),this.b.addListener(Yl("local"),this.a,b(this.g,this))}function Ql(e,t){var n,r=[];for(n in Qu)Qu[n]!==t&&r.push(Zu(e.b,Yl(Qu[n]),e.a));return r.push(Zu(e.b,$l,e.a)),function(e){return new bt((function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},a=function(e){n(e)},s=0;s<e.length;s++)Pt(e[s],_(o,s),a);else t(i)}))}(r)}Hl.prototype.g=function(){var e=this,t=Yl("local");eh(this,(function(){return It().then((function(){return e.c&&"local"!=e.c.F?e.b.get(t,e.a):null})).then((function(n){if(n)return Ql(e,"local").then((function(){e.c=t}))}))}))};var $l={name:"persistence",F:"session"};function Yl(e){return{name:"authUser",F:e}}function Xl(e,t){return eh(e,(function(){return e.b.set(e.c,t.w(),e.a)}))}function Jl(e){return eh(e,(function(){return Zu(e.b,e.c,e.a)}))}function Zl(e,t,n){return eh(e,(function(){return e.b.get(e.c,e.a).then((function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),Gl(e||{})}))}))}function eh(e,t){return e.f=e.f.then(t,t),e.f}function th(e){if(this.l=!1,Wr(this,"settings",new zc),Wr(this,"app",e),!lh(this).options||!lh(this).options.apiKey)throw new C("invalid-api-key");e=Ft.SDK_VERSION?Cr(Ft.SDK_VERSION):null,this.a=new Wa(lh(this).options&&lh(this).options.apiKey,R(E),e),this.P=[],this.s=[],this.N=[],this.Pa=Ft.INTERNAL.createSubscribe(b(this.zc,this)),this.W=void 0,this.ib=Ft.INTERNAL.createSubscribe(b(this.Ac,this)),uh(this,null),this.i=new Hl(lh(this).options.apiKey+":"+lh(this).name),this.D=new Kl(lh(this).options.apiKey+":"+lh(this).name),this.$=dh(this,function(e){var t=lh(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get(Wl,e.a).then((function(e){return e&&t&&(e.authDomain=t),Gl(e||{})}))}(e.D,lh(e).options.authDomain).then((function(t){return(e.m=t)&&(t.ha=e.D),zl(e.D)}));return dh(e,t)}(e).then((function(){return Zl(e.i,t,e.R)})).then((function(t){return t?(t.ha=e.D,e.m&&(e.m.ga||null)==(t.ga||null)?t:t.reload().then((function(){return Xl(e.i,t).then((function(){return t}))})).o((function(n){return"auth/network-request-failed"==n.code?t:Jl(e.i)}))):null})).then((function(t){uh(e,t||null)}));return dh(e,n)}(this)),this.h=dh(this,function(e){return e.$.then((function(){return ah(e)})).o((function(){})).then((function(){if(!e.l)return e.ja()})).o((function(){})).then((function(){if(!e.l){e.ba=!0;var t=e.i;t.b.addListener(Yl("local"),t.a,e.ja)}}))}(this)),this.ba=!1,this.ja=b(this.Zc,this),this.Ba=b(this.da,this),this.qa=b(this.mc,this),this.za=b(this.wc,this),this.Aa=b(this.xc,this),this.b=null,function(e){var t=lh(e).options.authDomain,n=lh(e).options.apiKey;t&&kr()&&(e.Oa=e.$.then((function(){if(!e.l){if(e.b=Uc(t,n,lh(e).name,e.R),Rc(e.b,e),hh(e)&&El(hh(e)),e.m){El(e.m);var r=e.m;r.xa(e.la()),yl(r,e),gl(r=e.m,e.J),bl(r,e),vl(r=e.m,e.R),ml(r,e),e.m=null}return e.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=b(this.delete,this),this.INTERNAL.logFramework=b(this.Gc,this),this.u=0,gn.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.la()},set:function(e){this.xa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.T()},set:function(e){this.zb(e)},enumerable:!1}),e.S=null,Object.defineProperty(e,"emulatorConfig",{get:function(){if(this.R){var e=Ln(this.R.url);e=Hr({protocol:e.c,host:e.a,port:e.g,options:Hr({disableWarnings:this.R.ec})})}else e=null;return e},enumerable:!1})}(this),this.J=[],this.R=null}function nh(e){Ht.call(this,"languageCodeChanged"),this.h=e}function rh(e){Ht.call(this,"emulatorConfigChanged"),this.c=e}function ih(e){Ht.call(this,"frameworkChanged"),this.f=e}function oh(e){return e.Oa||kt(new C("auth-domain-config-required"))}function ah(e){if(!kr())return kt(new C("operation-not-supported-in-this-environment"));var t=oh(e).then((function(){return e.b.ra()})).then((function(e){return e?Hr(e):null}));return dh(e,t)}function sh(e,t){var n={};return n.apiKey=lh(e).options.apiKey,n.authDomain=lh(e).options.authDomain,n.appName=lh(e).name,e.R&&(n.emulatorConfig=e.R),e.$.then((function(){return function(e,t,n,r){var i=new dl(e,t);return n&&(i.ha=n),r&&gl(i,r),i.reload().then((function(){return i}))}(n,t,e.D,e.Ga())})).then((function(t){return hh(e)&&t.uid==hh(e).uid?(Dl(hh(e),t),e.da(t)):(uh(e,t),El(t),e.da(t))})).then((function(){ph(e)}))}function uh(e,t){hh(e)&&(function(e,t){H(e.W,(function(e){return e==t}))}(hh(e),e.Ba),cn(hh(e),"tokenChanged",e.qa),cn(hh(e),"userDeleted",e.za),cn(hh(e),"userInvalidated",e.Aa),Tl(hh(e))),t&&(t.W.push(e.Ba),an(t,"tokenChanged",e.qa),an(t,"userDeleted",e.za),an(t,"userInvalidated",e.Aa),0<e.u&&wl(t)),Wr(e,"currentUser",t),t&&(t.xa(e.la()),yl(t,e),gl(t,e.J),bl(t,e),vl(t,e.R),ml(t,e))}function ch(e,t){var n=null,r=null;return dh(e,t.then((function(t){return n=Oo(t),r=Wi(t),sh(e,t)}),(function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=el(t.w(),e,b(e.kc,e))),n||t})).then((function(){return Hr({user:hh(e),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function lh(e){return e.app}function hh(e){return e.currentUser}function fh(e){return hh(e)&&hh(e)._lat||null}function ph(e){if(e.ba){for(var t=0;t<e.s.length;t++)e.s[t]&&e.s[t](fh(e));if(e.W!==e.getUid()&&e.N.length)for(e.W=e.getUid(),t=0;t<e.N.length;t++)e.N[t]&&e.N[t](fh(e))}}function dh(e,t){return e.P.push(t),t.oa((function(){z(e.P,t)})),t}function vh(){}function yh(){this.a={},this.b=1e12}Hl.prototype.yb=function(e){var t=null,n=this;return function(e){var t=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");e:{for(r in Qu)if(Qu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(mr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!ku()&&"none"!==e)throw n;break;default:if(!Ir()&&"none"!==e)throw n}}(e),eh(this,(function(){return e!=n.c.F?n.b.get(n.c,n.a).then((function(r){return t=r,Ql(n,e)})).then((function(){if(n.c=Yl(e),t)return n.b.set(n.c,t,n.a)})):It()}))},w(th,gn),w(nh,Ht),w(rh,Ht),w(ih,Ht),(e=th.prototype).yb=function(e){return dh(this,e=this.i.yb(e))},e.xa=function(e){this.aa===e||this.l||(this.aa=e,Ja(this.a,this.aa),this.dispatchEvent(new nh(this.la())))},e.la=function(){return this.aa},e.fd=function(){var e=a.navigator;this.xa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.gd=function(e,t){if(!this.R){if(!/^https?:\/\//.test(e))throw new C("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(e){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&!e&&pr().then((function(){var e=a.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#b50000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),a.document.body.appendChild(e)}))})(t=!!t&&!!t.disableWarnings),this.R={url:e,ec:t},this.settings.jb=!0,Za(this.a,this.R),this.dispatchEvent(new rh(this.R))}},e.Gc=function(e){this.J.push(e),ts(this.a,Ft.SDK_VERSION?Cr(Ft.SDK_VERSION,this.J):null),this.dispatchEvent(new ih(this.J))},e.Ga=function(){return $(this.J)},e.zb=function(e){this.S===e||this.l||(this.S=e,this.a.b=this.S)},e.T=function(){return this.S},e.toJSON=function(){return{apiKey:lh(this).options.apiKey,authDomain:lh(this).options.authDomain,appName:lh(this).name,currentUser:hh(this)&&hh(this).w()}},e.Gb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},e.na=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?b(this.ic,this):null},e.ic=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return ch(i,vs(i.a,o))}))},e.Xc=function(e){if(!kr())return kt(new C("operation-not-supported-in-this-environment"));var t=this,n=Ki(e.providerId),r=Or(),i=null;(!Nr()||vr())&&lh(this).options.authDomain&&e.isOAuthProvider&&(i=pu(lh(this).options.authDomain,lh(this).options.apiKey,lh(this).name,"signInViaPopup",e,null,r,Ft.SDK_VERSION||null,null,null,this.T(),this.R));var o=lr(i,n&&n.va,n&&n.ua);return dh(this,n=oh(this).then((function(n){return Dc(n,o,"signInViaPopup",e,r,!!i,t.T())})).then((function(){return new bt((function(e,n){t.na("signInViaPopup",null,new C("cancelled-popup-request"),t.g),t.f=e,t.C=n,t.g=r,t.c=Lc(t.b,t,"signInViaPopup",o,r)}))})).then((function(e){return o&&cr(o),e?Hr(e):null})).o((function(e){throw o&&cr(o),e})))},e.Yc=function(e){if(!kr())return kt(new C("operation-not-supported-in-this-environment"));var t=this;return dh(this,oh(this).then((function(){return function(e){return eh(e,(function(){return e.b.set($l,e.c.F,e.a)}))}(t.i)})).then((function(){return Mc(t.b,"signInViaRedirect",e,void 0,t.T())})))},e.ra=function(){var e=this;return ah(this).then((function(t){return e.b&&Bc(e.b.b),t})).o((function(t){throw e.b&&Bc(e.b.b),t}))},e.dd=function(e){if(!e)return kt(new C("null-user"));if(this.S!=e.tenantId)return kt(new C("tenant-id-mismatch"));var t=this,n={};n.apiKey=lh(this).options.apiKey,n.authDomain=lh(this).options.authDomain,n.appName=lh(this).name;var r=function(e,t,n,r){var i=e.h,o={};return o[Ha]=i.b&&i.b.toString(),o.refreshToken=i.a,t=new dl(t||{apiKey:e.l,authDomain:e.s,appName:e.m},o),n&&(t.ha=n),r&&gl(t,r),Dl(t,e),t}(e,n,t.D,t.Ga());return dh(this,this.h.then((function(){if(lh(t).options.apiKey!=e.l)return r.reload()})).then((function(){return hh(t)&&e.uid==hh(t).uid?(Dl(hh(t),e),t.da(e)):(uh(t,r),El(r),t.da(r))})).then((function(){ph(t)})))},e.Bb=function(){var e=this;return dh(this,this.h.then((function(){return e.b&&Bc(e.b.b),hh(e)?(uh(e,null),Jl(e.i).then((function(){ph(e)}))):It()})))},e.Zc=function(){var e=this;return Zl(this.i,lh(this).options.authDomain).then((function(t){if(!e.l){var n;if(n=hh(e)&&t){n=hh(e).uid;var r=t.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Dl(hh(e),t),hh(e).I();(hh(e)||t)&&(uh(e,t),t&&(El(t),t.ha=e.D),e.b&&Rc(e.b,e),ph(e))}}))},e.da=function(e){return Xl(this.i,e)},e.mc=function(){ph(this),this.da(hh(this))},e.wc=function(){this.Bb()},e.xc=function(){this.Bb()},e.kc=function(e){var t=this;return this.h.then((function(){return ch(t,It(e))}))},e.zc=function(e){var t=this;this.addAuthTokenListener((function(){e.next(hh(t))}))},e.Ac=function(e){var t=this;!function(e,t){e.N.push(t),dh(e,e.h.then((function(){!e.l&&W(e.N,t)&&e.W!==e.getUid()&&(e.W=e.getUid(),t(fh(e)))})))}(this,(function(){e.next(hh(t))}))},e.Ic=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof e?e(hh(r)):"function"==typeof e.next&&e.next(hh(r))})),this.Pa(e,t,n)},e.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"==typeof e?e(hh(r)):"function"==typeof e.next&&e.next(hh(r))})),this.ib(e,t,n)},e.nc=function(e){var t=this;return dh(this,this.h.then((function(){return hh(t)?hh(t).I(e).then((function(e){return{accessToken:e}})):null})))},e.Tc=function(e){var t=this;return this.h.then((function(){return ch(t,Js(t.a,zs,{token:e}))})).then((function(e){var n=e.user;return Al(n,"isAnonymous",!1),t.da(n),e}))},e.Uc=function(e,t){var n=this;return this.h.then((function(){return ch(n,Js(n.a,Hs,{email:e,password:t}))}))},e.dc=function(e,t){var n=this;return this.h.then((function(){return ch(n,Js(n.a,ws,{email:e,password:t}))}))},e.ab=function(e){var t=this;return this.h.then((function(){return ch(t,e.ka(t.a))}))},e.Sc=function(e){return Gr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(e)},e.Ab=function(){var e=this;return this.h.then((function(){var t=hh(e);if(t&&t.isAnonymous){var n=Hr({providerId:null,isNewUser:!1});return Hr({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ch(e,e.a.Ab()).then((function(t){var n=t.user;return Al(n,"isAnonymous",!0),e.da(n),t}))}))},e.getUid=function(){return hh(this)&&hh(this).uid||null},e.cc=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&hh(this)&&wl(hh(this))},e.Pc=function(e){var t=this;q(this.s,(function(n){n==e&&t.u--})),0>this.u&&(this.u=0),0==this.u&&hh(this)&&Tl(hh(this)),this.removeAuthTokenListener(e)},e.addAuthTokenListener=function(e){var t=this;this.s.push(e),dh(this,this.h.then((function(){t.l||W(t.s,e)&&e(fh(t))})))},e.removeAuthTokenListener=function(e){H(this.s,(function(t){return t==e}))},e.delete=function(){this.l=!0;for(var e=0;e<this.P.length;e++)this.P[e].cancel("app-deleted");return this.P=[],this.i&&(e=this.i).b.removeListener(Yl("local"),e.a,this.ja),this.b&&(Nc(this.b,this),Bc(this.b.b)),Promise.resolve()},e.hc=function(e){return dh(this,function(e,t){return Js(e,Ts,{identifier:t,continueUri:Pr()?ar():"http://localhost"}).then((function(e){return e.signinMethods||[]}))}(this.a,e))},e.Bc=function(e){return!!Po(e)},e.xb=function(e,t){var n=this;return dh(this,It().then((function(){var e=new Ei(t);if(!e.c)throw new C("argument-error",Pi+" must be true when sending sign in link to email");return Mi(e)})).then((function(t){return n.a.xb(e,t)})).then((function(){})))},e.jd=function(e){return this.Sa(e).then((function(e){return e.data.email}))},e.ob=function(e,t){return dh(this,this.a.ob(e,t).then((function(){})))},e.Sa=function(e){return dh(this,this.a.Sa(e).then((function(e){return new ni(e)})))},e.kb=function(e){return dh(this,this.a.kb(e).then((function(){})))},e.wb=function(e,t){var n=this;return dh(this,It().then((function(){return void 0===t||he(t)?{}:Mi(new Ei(t))})).then((function(t){return n.a.wb(e,t)})).then((function(){})))},e.Wc=function(e,t){return dh(this,Qc(this,e,t,b(this.ab,this)))},e.Vc=function(e,t){var n=this;return dh(this,It().then((function(){var r=t||ar(),i=ko(e,r);if(!(r=Po(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new C("tenant-id-mismatch");return n.ab(i)})))},vh.prototype.render=function(){},vh.prototype.reset=function(){},vh.prototype.getResponse=function(){},vh.prototype.execute=function(){};var mh=null;function gh(e,t){return(t=bh(t))&&e.a[t]||null}function bh(e){return(e=void 0===e?1e12:e)?e.toString():null}function _h(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=st(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function wh(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function Th(){}function Ch(){}yh.prototype.render=function(e,t){return this.a[this.b.toString()]=new _h(e,t),this.b++},yh.prototype.reset=function(e){var t=gh(this,e);e=bh(e),t&&e&&(t.delete(),delete this.a[e])},yh.prototype.getResponse=function(e){return(e=gh(this,e))?e.getResponse():null},yh.prototype.execute=function(e){(e=gh(this,e))&&e.execute()},_h.prototype.getResponse=function(){return wh(this),this.b},_h.prototype.execute=function(){wh(this);var e=this;this.a||(this.a=setTimeout((function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(e){}e.a=setTimeout((function(){if(e.a=null,e.b=null,n)try{n()}catch(e){}e.h&&e.execute()}),6e4)}),500))},_h.prototype.delete=function(){wh(this),this.g=!0,clearTimeout(this.a),this.a=null,cn(this.f,"click",this.i)},Wr(Th,"FACTOR_ID","phone"),Ch.prototype.g=function(){return mh||(mh=new yh),It(mh)},Ch.prototype.c=function(){};var Sh=null;function Eh(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ih=new ye(_e,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),kh=new Fr(3e4,6e4);Eh.prototype.g=function(e){var t=this;return new bt((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),kh.get());!a.grecaptcha||e!==t.f&&!t.b?(a[t.a]=function(){if(a.grecaptcha){t.f=e;var o=a.grecaptcha.render;a.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete a[t.a]},It(ja(Se(Ih,{onload:t.a,hl:e||""}))).o((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(a.grecaptcha))}))},Eh.prototype.c=function(){this.b--};var Ph=null;function Rh(e,t,n,r,i,o,s){if(Wr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=t,this.g=null,s?(Sh||(Sh=new Ch),s=Sh):(Ph||(Ph=new Eh),s=Ph),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Ah])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Dh],!a.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!st(t)||!this.i&&st(t).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Wa(e,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[Nh];this.a[Nh]=function(e){if(Oh(u,e),"function"==typeof c)c(e);else if("string"==typeof c){var t=Er(c,a);"function"==typeof t&&t(e)}};var l=this.a[xh];this.a[xh]=function(){if(Oh(u,null),"function"==typeof l)l();else if("string"==typeof l){var e=Er(l,a);"function"==typeof e&&e()}}}var Nh="callback",xh="expired-callback",Ah="sitekey",Dh="size";function Oh(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(e){}}function Mh(e,t){return e.h.push(t),t.oa((function(){z(e.h,t)})),t}function Lh(e){if(e.J)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function Fh(e,t,n){var r=!1;try{this.b=n||Ft.app()}catch(e){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(e){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}o=Ft.SDK_VERSION?Cr(Ft.SDK_VERSION,o):null,Rh.call(this,n,e,t,(function(){try{var e=i.b.auth().la()}catch(t){e=null}return e}),o,R(E),r)}function jh(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=Uh.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=Uh[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new C("argument-error",e+" failed: "+r)}(e=Rh.prototype).Ia=function(){var e=this;return this.f?this.f:this.f=Mh(this,It().then((function(){if(Pr()&&!yr())return pr();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return e.m.g(e.u())})).then((function(t){return e.g=t,Js(e.s,Ms,{})})).then((function(t){e.a[Ah]=t.recaptchaSiteKey})).o((function(t){throw e.f=null,t})))},e.render=function(){Lh(this);var e=this;return Mh(this,this.Ia().then((function(){if(null===e.c){var t=e.v;if(!e.i){var n=st(t);t=function(e,t,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!at&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',qe(a.name),'"'),a.type){o.push(' type="',qe(a.type),'"');var s={};de(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=pt(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):ut(o,a)),2<r.length&&ft(i,o,r),o}("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c})))},e.verify=function(){Lh(this);var e=this;return Mh(this,this.render().then((function(t){return new bt((function(n){var r=e.g.getResponse(t);if(r)n(r);else{var i=function(t){t&&(function(e,t){H(e.l,(function(e){return e==t}))}(e,i),n(t))};e.l.push(i),e.i&&e.g.execute(e.c)}}))})))},e.reset=function(){Lh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Lh(this),this.J=!0,this.m.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=st(this.v);for(var t;t=e.firstChild;)e.removeChild(t)}},w(Fh,Rh);var Uh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Vh(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:function(e){return"string"==typeof e}}}function qh(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:function(e){return"boolean"==typeof e}}}function Bh(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:d}}function Gh(e,t){return{name:e||"",K:"a function",optional:!!t,M:function(e){return"function"==typeof e}}}function Kh(e,t){return{name:e||"",K:"null",optional:!!t,M:function(e){return null===e}}}function Wh(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var n=!e||t.providerId===e;return!(!t.ka||!n)}}}function zh(e,t){return d(e)&&"string"==typeof e.type&&e.type===t&&"function"==typeof e.Ha}function Hh(e){return d(e)&&"string"==typeof e.uid}function Qh(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function $h(e,t){for(var n in t){var r=t[n].name;e[r]=Jh(r,e[n],t[n].j)}}function Yh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:_((function(e){return this[e]}),n),set:_((function(e,t,n,r){jh(e,[n],[r],!0),this[t]=r}),r,n,t[n].lb),enumerable:!0})}}function Xh(e,t,n,r){e[t]=Jh(t,n,r)}function Jh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return jh(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}$h(th.prototype,{kb:{name:"applyActionCode",j:[Vh("code")]},Sa:{name:"checkActionCode",j:[Vh("code")]},ob:{name:"confirmPasswordReset",j:[Vh("code"),Vh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Vh("email"),Vh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Vh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Vh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Qh(Bh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Qh(Bh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Vh("email"),Qh(Bh("opt_actionCodeSettings",!0),Kh(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Vh("email"),Bh("actionCodeSettings")]},yb:{name:"setPersistence",j:[Vh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Wh()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Wh()]},Tc:{name:"signInWithCustomToken",j:[Vh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Vh("email"),Vh("password")]},Vc:{name:"signInWithEmailLink",j:[Vh("email"),Vh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Vh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Qh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof dl)}},Kh(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Vh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Vh("url"),Bh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Vh("code")]}}),Yh(th.prototype,{lc:{name:"languageCode",lb:Qh(Vh(),Kh(),"languageCode")},ti:{name:"tenantId",lb:Qh(Vh(),Kh(),"tenantId")}}),th.Persistence=Qu,th.Persistence.LOCAL="local",th.Persistence.SESSION="session",th.Persistence.NONE="none",$h(dl.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[qh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[qh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Wh()]},rb:{name:"linkWithCredential",j:[Wh()]},Dc:{name:"linkWithPhoneNumber",j:[Vh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Wh()]},ub:{name:"reauthenticateWithCredential",j:[Wh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Vh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[Qh(Bh("opt_actionCodeSettings",!0),Kh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Vh(null,!0)]},cd:{name:"unlink",j:[Vh("provider")]},Cb:{name:"updateEmail",j:[Vh("email")]},Db:{name:"updatePassword",j:[Vh("password")]},ed:{name:"updatePhoneNumber",j:[Wh("phone")]},Eb:{name:"updateProfile",j:[Bh("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Vh("email"),Qh(Bh("opt_actionCodeSettings",!0),Kh(null,!0),"opt_actionCodeSettings",!0)]}}),$h(yh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$h(vh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$h(bt.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Yh(zc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:qh("appVerificationDisabledForTesting")}}),$h(Hc.prototype,{confirm:{name:"confirm",j:[Vh("verificationCode")]}}),Xh(io,"fromJSON",(function(e){e="string"==typeof e?JSON.parse(e):e;for(var t,n=[ho,Eo,No,uo],r=0;r<n.length;r++)if(t=n[r](e))return t;return null}),[Qh(Vh(),Bh(),"json")]),Xh(Io,"credential",(function(e,t){return new So(e,t)}),[Vh("email"),Vh("password")]),$h(So.prototype,{w:{name:"toJSON",j:[Vh(null,!0)]}}),$h(yo.prototype,{Ca:{name:"addScope",j:[Vh("scope")]},Ka:{name:"setCustomParameters",j:[Bh("customOAuthParameters")]}}),Xh(yo,"credential",mo,[Qh(Vh(),Bh(),"token")]),Xh(Io,"credentialWithLink",ko,[Vh("email"),Vh("emailLink")]),$h(go.prototype,{Ca:{name:"addScope",j:[Vh("scope")]},Ka:{name:"setCustomParameters",j:[Bh("customOAuthParameters")]}}),Xh(go,"credential",bo,[Qh(Vh(),Bh(),"token")]),$h(_o.prototype,{Ca:{name:"addScope",j:[Vh("scope")]},Ka:{name:"setCustomParameters",j:[Bh("customOAuthParameters")]}}),Xh(_o,"credential",wo,[Qh(Vh(),Qh(Bh(),Kh()),"idToken"),Qh(Vh(),Kh(),"accessToken",!0)]),$h(To.prototype,{Ka:{name:"setCustomParameters",j:[Bh("customOAuthParameters")]}}),Xh(To,"credential",Co,[Qh(Vh(),Bh(),"token"),Vh("secret",!0)]),$h(vo.prototype,{Ca:{name:"addScope",j:[Vh("scope")]},credential:{name:"credential",j:[Qh(Vh(),Qh(Bh(),Kh()),"optionsOrIdToken"),Qh(Vh(),Kh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Bh("customOAuthParameters")]}}),$h(co.prototype,{w:{name:"toJSON",j:[Vh(null,!0)]}}),$h(ao.prototype,{w:{name:"toJSON",j:[Vh(null,!0)]}}),Xh(Ao,"credential",Do,[Vh("verificationId"),Vh("verificationCode")]),$h(Ao.prototype,{gb:{name:"verifyPhoneNumber",j:[Qh(Vh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(e){return!!e&&(e.session&&e.phoneNumber?zh(e.session,no)&&"string"==typeof e.phoneNumber:e.session&&e.multiFactorHint?zh(e.session,ro)&&Hh(e.multiFactorHint):e.session&&e.multiFactorUid?zh(e.session,ro)&&"string"==typeof e.multiFactorUid:!!e.phoneNumber&&"string"==typeof e.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]}}),$h(Ro.prototype,{w:{name:"toJSON",j:[Vh(null,!0)]}}),$h(C.prototype,{toJSON:{name:"toJSON",j:[Vh(null,!0)]}}),$h(Bo.prototype,{toJSON:{name:"toJSON",j:[Vh(null,!0)]}}),$h(qo.prototype,{toJSON:{name:"toJSON",j:[Vh(null,!0)]}}),$h(Zc.prototype,{toJSON:{name:"toJSON",j:[Vh(null,!0)]}}),$h(Yc.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}}]}}),$h(ol.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}},Vh("displayName",!0)]},bd:{name:"unenroll",j:[Qh({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Hh},Vh(),"multiFactorInfoIdentifier")]}}),$h(Fh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Xh(yi,"parseLink",Si,[Vh("link")]),Xh(Th,"assertion",(function(e){return new rl(e)}),[Wh("phone")]),function(){if(void 0===Ft||!Ft.INTERNAL||!Ft.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ii,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ri,VERIFY_AND_CHANGE_EMAIL:oi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:th,AuthCredential:io,Error:C};Xh(e,"EmailAuthProvider",Io,[]),Xh(e,"FacebookAuthProvider",yo,[]),Xh(e,"GithubAuthProvider",go,[]),Xh(e,"GoogleAuthProvider",_o,[]),Xh(e,"TwitterAuthProvider",To,[]),Xh(e,"OAuthProvider",vo,[Vh("providerId")]),Xh(e,"SAMLAuthProvider",po,[Vh("providerId")]),Xh(e,"PhoneAuthProvider",Ao,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof th)}}]),Xh(e,"RecaptchaVerifier",Fh,[Qh(Vh(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Bh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof Ft.app.App)}}]),Xh(e,"ActionCodeURL",yi,[]),Xh(e,"PhoneMultiFactorGenerator",Th,[]),Ft.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new th(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),Ft.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:b((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:b(e.nc,e),addAuthTokenListener:b(e.cc,e),removeAuthTokenListener:b(e.Pc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),Ft.registerVersion("@firebase/auth","0.16.7"),Ft.INTERNAL.extendNamespace({User:dl})}()}.apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var jt=function(e,t){return(jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Ut(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var Vt,qt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Bt=Bt||{},Gt=qt||self;function Kt(){}function Wt(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function zt(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Ht="closure_uid_"+(1e9*Math.random()>>>0),Qt=0;function $t(e,t,n){return e.call.apply(e.bind,arguments)}function Yt(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Xt(e,t,n){return(Xt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?$t:Yt).apply(null,arguments)}function Jt(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Zt(){return Date.now()}function en(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Pb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function tn(){this.j=this.j,this.i=this.i}tn.prototype.j=!1,tn.prototype.ka=function(){if(!this.j&&(this.j=!0,this.H(),0))(function(e){Object.prototype.hasOwnProperty.call(e,Ht)&&e[Ht]||(e[Ht]=++Qt)})(this)},tn.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var nn=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},rn=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function on(e){return Array.prototype.concat.apply([],arguments)}function an(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function sn(e){return/^[\s\xa0]*$/.test(e)}var un,cn=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function ln(e,t){return-1!=e.indexOf(t)}function hn(e,t){return e<t?-1:e>t?1:0}e:{var fn=Gt.navigator;if(fn){var pn=fn.userAgent;if(pn){un=pn;break e}}un=""}function dn(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function vn(e){var t={};for(var n in e)t[n]=e[n];return t}var yn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mn(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<yn.length;o++)n=yn[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function gn(e){return gn[" "](e),e}gn[" "]=Kt;var bn,_n,wn=ln(un,"Opera"),Tn=ln(un,"Trident")||ln(un,"MSIE"),Cn=ln(un,"Edge"),Sn=Cn||Tn,En=ln(un,"Gecko")&&!(ln(un.toLowerCase(),"webkit")&&!ln(un,"Edge"))&&!(ln(un,"Trident")||ln(un,"MSIE"))&&!ln(un,"Edge"),In=ln(un.toLowerCase(),"webkit")&&!ln(un,"Edge");function kn(){var e=Gt.document;return e?e.documentMode:void 0}e:{var Pn="",Rn=(_n=un,En?/rv:([^\);]+)(\)|;)/.exec(_n):Cn?/Edge\/([\d\.]+)/.exec(_n):Tn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(_n):In?/WebKit\/(\S+)/.exec(_n):wn?/(?:Version)[ \/]?(\S+)/.exec(_n):void 0);if(Rn&&(Pn=Rn?Rn[1]:""),Tn){var Nn=kn();if(null!=Nn&&Nn>parseFloat(Pn)){bn=String(Nn);break e}}bn=Pn}var xn,An={};function Dn(e){return function(e,t){var n=An;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=cn(String(bn)).split("."),r=cn(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=hn(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||hn(0==a[2].length,0==s[2].length)||hn(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}if(Gt.document&&Tn){var On=kn();xn=On||(parseInt(bn,10)||void 0)}else xn=void 0;var Mn=xn,Ln=!Tn||9<=Number(Mn),Fn=Tn&&!Dn("9"),jn=function(){if(!Gt.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Gt.addEventListener("test",Kt,t),Gt.removeEventListener("test",Kt,t)}catch(e){}return e}();function Un(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function Vn(e,t){if(Un.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(En){e:{try{gn(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:qn[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}Un.prototype.b=function(){this.defaultPrevented=!0},en(Vn,Un);var qn={2:"touch",3:"pen",4:"mouse"};Vn.prototype.b=function(){Vn.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Fn)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};var Bn="closure_listenable_"+(1e6*Math.random()|0),Gn=0;function Kn(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.da=i,this.key=++Gn,this.Y=this.Z=!1}function Wn(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.da=null}function zn(e){this.src=e,this.a={},this.b=0}function Hn(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=nn(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Wn(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function Qn(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.da==r)return i}return-1}zn.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Qn(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new Kn(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var $n="closure_lm_"+(1e6*Math.random()|0),Yn={};function Xn(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}return r=or(r),t&&t[Bn]?t.xa(n,r,zt(i)?!!i.capture:!!i,o):Jn(t,n,r,!0,i,o)}(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)Xn(e,t[o],n,r,i);return null}return n=or(n),e&&e[Bn]?e.wa(t,n,zt(r)?!!r.capture:!!r,i):Jn(e,t,n,!1,r,i)}function Jn(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=zt(i)?!!i.capture:!!i;if(a&&!Ln)return null;var s=rr(e);if(s||(e[$n]=s=new zn(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=nr,t=Ln?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)jn||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(er(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Zn(e){if("number"!=typeof e&&e&&!e.Y){var t=e.src;if(t&&t[Bn])Hn(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(er(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=rr(t))?(Hn(n,e),0==n.b&&(n.src=null,t[$n]=null)):Wn(e)}}}function er(e){return e in Yn?Yn[e]:Yn[e]="on"+e}function tr(e,t){var n=e.listener,r=e.da||e.src;return e.Z&&Zn(e),n.call(r,t)}function nr(e,t){if(e.Y)return!0;if(!Ln){if(!t)e:{t=["window","event"];for(var n=Gt,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return tr(e,t=new Vn(t,this))}return tr(e,new Vn(t,this))}function rr(e){return(e=e[$n])instanceof zn?e:null}var ir="__closure_events_fn_"+(1e9*Math.random()>>>0);function or(e){return"function"==typeof e?e:(e[ir]||(e[ir]=function(t){return e.handleEvent(t)}),e[ir])}function ar(){tn.call(this),this.c=new zn(this),this.J=this,this.D=null}function sr(e,t){var n,r=e.D;if(r)for(n=[];r;r=r.D)n.push(r);if(e=e.J,r=t.type||t,"string"==typeof t)t=new Un(t,e);else if(t instanceof Un)t.target=t.target||e;else{var i=t;mn(t=new Un(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=t.a=n[o];i=ur(a,r,!0,t)&&i}if(i=ur(a=t.a=e,r,!0,t)&&i,i=ur(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=ur(a=t.a=n[o],r,!1,t)&&i}function ur(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&Hn(e.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}en(ar,tn),ar.prototype[Bn]=!0,(Vt=ar.prototype).addEventListener=function(e,t,n,r){Xn(this,e,t,n,r)},Vt.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=zt(i)?!!i.capture:!!i,r=or(r),t&&t[Bn]?(t=t.c,(n=String(n).toString())in t.a&&(-1<(r=Qn(a=t.a[n],r,i,o))&&(Wn(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--)))):t&&(t=rr(t))&&(n=t.a[n.toString()],t=-1,n&&(t=Qn(n,r,i,o)),(r=-1<t?n[t]:null)&&Zn(r))}(this,e,t,n,r)},Vt.H=function(){if(ar.X.H.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Wn(n[r]);delete t.a[e],t.b--}}this.D=null},Vt.wa=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},Vt.xa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var cr=Gt.JSON.stringify;function lr(){this.b=this.a=null}var hr,fr=new(function(){function e(e,t){this.c=e,this.f=t,this.b=0,this.a=null}return e.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},e}())((function(){return new dr}),(function(e){e.reset()}));function pr(){var e=gr,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function dr(){this.next=this.b=this.a=null}function vr(e){Gt.setTimeout((function(){throw e}),0)}function yr(e,t){hr||function(){var e=Gt.Promise.resolve(void 0);hr=function(){e.then(br)}}(),mr||(hr(),mr=!0),gr.add(e,t)}lr.prototype.add=function(e,t){var n=fr.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},dr.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},dr.prototype.reset=function(){this.next=this.b=this.a=null};var mr=!1,gr=new lr;function br(){for(var e;e=pr();){try{e.a.call(e.b)}catch(e){vr(e)}var t=fr;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}mr=!1}function _r(e,t){ar.call(this),this.b=e||1,this.a=t||Gt,this.f=Xt(this.eb,this),this.g=Zt()}function wr(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function Tr(e,t,n){if("function"==typeof e)n&&(e=Xt(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Xt(e.handleEvent,e)}return 2147483647<Number(t)?-1:Gt.setTimeout(e,t||0)}function Cr(e){e.a=Tr((function(){e.a=null,e.c&&(e.c=!1,Cr(e))}),e.h);var t=e.b;e.b=null,e.g.apply(null,t)}en(_r,ar),(Vt=_r.prototype).aa=!1,Vt.M=null,Vt.eb=function(){if(this.aa){var e=Zt()-this.g;0<e&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),sr(this,"tick"),this.aa&&(wr(this),this.start()))}},Vt.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Zt())},Vt.H=function(){_r.X.H.call(this),wr(this),delete this.a};var Sr=function(e){function t(t,n){var r=e.call(this)||this;return r.g=t,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(e,t){function n(){this.constructor=e}jt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:Cr(this)},t.prototype.H=function(){e.prototype.H.call(this),this.a&&(Gt.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},t}(tn);function Er(e){tn.call(this),this.b=e,this.a={}}en(Er,tn);var Ir=[];function kr(e,t,n,r){Array.isArray(n)||(n&&(Ir[0]=n.toString()),n=Ir);for(var i=0;i<n.length;i++){var o=Xn(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Pr(e){dn(e.a,(function(e,t){this.a.hasOwnProperty(t)&&Zn(e)}),e),e.a={}}function Rr(){this.a=!0}function Nr(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return cr(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Er.prototype.H=function(){Er.X.H.call(this),Pr(this)},Er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Rr.prototype.info=function(){};var xr={},Ar=null;function Dr(){return Ar=Ar||new ar}function Or(e){Un.call(this,xr.Ga,e)}function Mr(e){var t=Dr();sr(t,new Or(t,e))}function Lr(e,t){Un.call(this,xr.STAT_EVENT,e),this.stat=t}function Fr(e){var t=Dr();sr(t,new Lr(t,e))}function jr(e){Un.call(this,xr.Ha,e)}function Ur(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Gt.setTimeout((function(){e()}),t)}xr.Ga="serverreachability",en(Or,Un),xr.STAT_EVENT="statevent",en(Lr,Un),xr.Ha="timingevent",en(jr,Un);var Vr={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},qr={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function Br(){}function Gr(e){return e.b||(e.b=e.c())}function Kr(){}Br.prototype.b=null;var Wr,zr={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function Hr(){Un.call(this,"d")}function Qr(){Un.call(this,"c")}function $r(){}function Yr(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new Er(this),this.P=Xr,e=Sn?125:void 0,this.R=new _r(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}en(Hr,Un),en(Qr,Un),en($r,Br),$r.prototype.a=function(){return new XMLHttpRequest},$r.prototype.c=function(){return{}},Wr=new $r;var Xr=45e3,Jr={},Zr={};function ei(e,t,n){e.G=1,e.i=Ti(yi(t)),e.j=n,e.I=!0,ti(e,null)}function ti(e,t){e.u=Zt(),ii(e),e.l=yi(e.i);var n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),Mi(n.b,"t",r),e.D=0,e.a=No(e.g,e.g.C?t:null),0<e.O&&(e.F=new Sr(Xt(e.Da,e,e.a),e.O)),kr(e.J,e.a,"readystatechange",e.bb),t=e.B?vn(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),Mr(1),function(e,t,n,r,i,o){e.info((function(){if(e.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a}))}(e.c,e.m,e.l,e.f,e.S,e.j)}function ni(e,t,n){for(var r=!0;!e.A&&e.D<n.length;){var i=ri(e,n);if(i==Zr){4==t&&(e.h=4,Fr(14),r=!1),Nr(e.c,e.f,null,"[Incomplete Response]");break}if(i==Jr){e.h=4,Fr(15),Nr(e.c,e.f,n,"[Invalid Chunk]"),r=!1;break}Nr(e.c,e.f,i,null),ci(e,i)}4==t&&0==n.length&&(e.h=1,Fr(16),r=!1),e.b=e.b&&r,r?0<n.length&&!e.V&&(e.V=!0,(t=e.g).a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),To(t),t.F=!0,Fr(11))):(Nr(e.c,e.f,n,"[Invalid Chunked Response]"),ui(e),si(e))}function ri(e,t){var n=e.D,r=t.indexOf("\n",n);return-1==r?Zr:(n=Number(t.substring(n,r)),isNaN(n)?Jr:(r+=1)+n>t.length?Zr:(t=t.substr(r,n),e.D=r+n,t))}function ii(e){e.T=Zt()+e.P,oi(e,e.P)}function oi(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=Ur(Xt(e.$a,e),t)}function ai(e){e.o&&(Gt.clearTimeout(e.o),e.o=null)}function si(e){0==e.g.v||e.A||Eo(e.g,e)}function ui(e){ai(e);var t=e.F;t&&"function"==typeof t.ka&&t.ka(),e.F=null,wr(e.R),Pr(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ka())}function ci(e,t){try{var n=e.g;if(0!=n.v&&(n.a==e||Bi(n.b,e)))if(n.I=e.N,!e.C&&Bi(n.b,e)&&3==n.v){try{var r=n.la.a.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.j){if(n.a){if(!(n.a.u+3e3<e.u))break e;So(n),fo(n)}wo(n),Fr(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=Ur(Xt(n.Xa,n),6e3));if(1>=qi(n.b)&&n.fa){try{n.fa()}catch(e){}n.fa=void 0}}else ko(n,11)}else if((e.C||n.a==e)&&So(n),!sn(t))for(t=r=n.la.a.parse(t),r=0;r<t.length;r++)if(i=t[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var a=i[4];null!=a&&(n.qa=a,n.c.info("SVER="+n.qa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=e.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(ln(l,"spdy")||ln(l,"quic")||ln(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(Gi(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,wi(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=Zt()-e.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=e;if((u=n).ma=Ro(u,u.C?u.ha:null,u.ga),p.C){Ki(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(ai(d),ii(d)),u.a=p}else _o(u);0<n.g.length&&yo(n)}else"stop"!=i[0]&&"close"!=i[0]||ko(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ko(n,7):ho(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);Mr(4)}catch(e){}}function li(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Wt(e)||"string"==typeof e)rn(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(Wt(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"==typeof e)return e.split("");if(Wt(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function hi(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof hi)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function fi(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];pi(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)pi(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function pi(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(Vt=Yr.prototype).setTimeout=function(e){this.P=e},Vt.bb=function(e){e=e.target;var t=this.F;t&&3==so(e)?t.f():this.Da(e)},Vt.Da=function(e){try{if(e==this.a)e:{var t=so(this.a),n=this.a.va(),r=this.a.W();if(!(3>t||3==t&&!Sn&&!this.a.$())){this.A||4!=t||7==n||Mr(8==n||0>=r?3:2),ai(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(e,t,n,r,i,o,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,t,i),this.b){if(this.U&&!this.C){t:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sn(a)){var u=a;break t}}u=null}if(!u){this.b=!1,this.h=3,Fr(12),ui(this),si(this);break e}Nr(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ci(this,u)}this.I?(ni(this,t,o),Sn&&this.b&&3==t&&(kr(this.J,this.R,"tick",this.ab),this.R.start())):(Nr(this.c,this.f,o,null),ci(this,o)),4==t&&ui(this),this.b&&!this.A&&(4==t?Eo(this.g,this):(this.b=!1,ii(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Fr(12)):(this.h=0,Fr(13)),ui(this),si(this)}}}catch(e){}},Vt.ab=function(){if(this.a){var e=so(this.a),t=this.a.$();this.D<t.length&&(ai(this),ni(this,e,t),this.b&&4!=e&&ii(this))}},Vt.cancel=function(){this.A=!0,ui(this)},Vt.$a=function(){this.o=null;var e=Zt();0<=e-this.T?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.c,this.l),2!=this.G&&(Mr(3),Fr(17)),ui(this),this.h=2,si(this)):oi(this,this.T-e)},(Vt=hi.prototype).K=function(){fi(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},Vt.L=function(){return fi(this),this.a.concat()},Vt.get=function(e,t){return pi(this.b,e)?this.b[e]:t},Vt.set=function(e,t){pi(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},Vt.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var di=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function vi(e,t){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof vi){this.a=void 0!==t?t:e.a,mi(this,e.f),this.j=e.j,gi(this,e.c),bi(this,e.h),this.g=e.g,t=e.b;var n=new xi;n.c=t.c,t.a&&(n.a=new hi(t.a),n.b=t.b),_i(this,n),this.i=e.i}else e&&(n=String(e).match(di))?(this.a=!!t,mi(this,n[1]||"",!0),this.j=Ci(n[2]||""),gi(this,n[3]||"",!0),bi(this,n[4]),this.g=Ci(n[5]||"",!0),_i(this,n[6]||"",!0),this.i=Ci(n[7]||"")):(this.a=!!t,this.b=new xi(null,this.a))}function yi(e){return new vi(e)}function mi(e,t,n){e.f=n?Ci(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function gi(e,t,n){e.c=n?Ci(t,!0):t}function bi(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.h=t}else e.h=null}function _i(e,t,n){t instanceof xi?(e.b=t,function(e,t){t&&!e.f&&(Ai(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Di(this,t),Mi(this,n,e))}),e)),e.f=t}(e.b,e.a)):(n||(t=Si(t,Ri)),e.b=new xi(t,e.a))}function wi(e,t,n){e.b.set(t,n)}function Ti(e){return wi(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Zt()).toString(36)),e}function Ci(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Si(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Ei),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ei(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}vi.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Si(t,Ii,!0),":");var n=this.c;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(Si(t,Ii,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(Si(n,"/"==n.charAt(0)?Pi:ki,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",Si(n,Ni)),e.join("")};var Ii=/[#\/\?@]/g,ki=/[#\?:]/g,Pi=/[#\?]/g,Ri=/[#\?@]/g,Ni=/#/g;function xi(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Ai(e){e.a||(e.a=new hi,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Di(e,t){Ai(e),t=Li(e,t),pi(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,pi((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&fi(e)))}function Oi(e,t){return Ai(e),t=Li(e,t),pi(e.a.b,t)}function Mi(e,t,n){Di(e,t),0<n.length&&(e.c=null,e.a.set(Li(e,t),an(n)),e.b+=n.length)}function Li(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(Vt=xi.prototype).add=function(e,t){Ai(this),this.c=null,e=Li(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},Vt.forEach=function(e,t){Ai(this),this.a.forEach((function(n,r){rn(n,(function(n){e.call(t,n,r,this)}),this)}),this)},Vt.L=function(){Ai(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},Vt.K=function(e){Ai(this);var t=[];if("string"==typeof e)Oi(this,e)&&(t=on(t,this.a.get(Li(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=on(t,e[n])}return t},Vt.set=function(e,t){return Ai(this),this.c=null,Oi(this,e=Li(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},Vt.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},Vt.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var Fi=function(e,t){this.b=e,this.a=t};function ji(e){this.g=e||Ui,Gt.PerformanceNavigationTiming?e=0<(e=Gt.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Gt.ja&&Gt.ja.za&&Gt.ja.za()&&Gt.ja.za().Qb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Ui=10;function Vi(e){return!!e.b||!!e.a&&e.a.size>=e.f}function qi(e){return e.b?1:e.a?e.a.size:0}function Bi(e,t){return e.b?e.b==t:!!e.a&&e.a.has(t)}function Gi(e,t){e.a?e.a.add(t):e.b=t}function Ki(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function Wi(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null!=e.a&&0!==e.a.size){var r=e.c;try{for(var i=Ut(e.a.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return an(e.c)}function zi(){}function Hi(){this.a=new zi}function Qi(e,t,n){var r=n||"";try{li(e,(function(e,n){var i=e;zt(e)&&(i=cr(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function $i(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}ji.prototype.cancel=function(){var e,t;if(this.c=Wi(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Ut(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},zi.prototype.stringify=function(e){return Gt.JSON.stringify(e,void 0)},zi.prototype.parse=function(e){return Gt.JSON.parse(e,void 0)};var Yi=Gt.JSON.parse;function Xi(e){ar.call(this),this.headers=new hi,this.l=e||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=Ji,this.F=this.G=!1}en(Xi,ar);var Ji="",Zi=/^https?$/i,eo=["POST","PUT"];function to(e){return"content-type"==e.toLowerCase()}function no(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,ro(e),oo(e)}function ro(e){e.A||(e.A=!0,sr(e,"complete"),sr(e,"error"))}function io(e){if(e.b&&void 0!==Bt&&(!e.u[1]||4!=so(e)||2!=e.W()))if(e.m&&4==so(e))Tr(e.Aa,0,e);else if(sr(e,"readystatechange"),4==so(e)){e.b=!1;try{var t,n=e.W();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.C).match(di)[1]||null;if(!o&&Gt.self&&Gt.self.location){var a=Gt.self.location.protocol;o=a.substr(0,a.length-1)}i=!Zi.test(o?o.toLowerCase():"")}t=i}if(t)sr(e,"complete"),sr(e,"success");else{e.h=6;try{var s=2<so(e)?e.a.statusText:""}catch(n){s=""}e.f=s+" ["+e.W()+"]",ro(e)}}finally{oo(e)}}}function oo(e,t){if(e.a){ao(e);var n=e.a,r=e.u[0]?Kt:null;e.a=null,e.u=null,t||sr(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function ao(e){e.a&&e.F&&(e.a.ontimeout=null),e.o&&(Gt.clearTimeout(e.o),e.o=null)}function so(e){return e.a?e.a.readyState:0}function uo(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return dn(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):wi(e,t,n))}function co(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function lo(e){this.qa=0,this.g=[],this.c=new Rr,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=co("failFast",!1,e),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=co("baseRetryDelayMs",5e3,e),this.Sa=co("retryDelaySeedMs",1e4,e),this.Na=co("forwardChannelMaxRetries",2,e),this.na=co("forwardChannelRequestTimeoutMs",2e4,e),this.Oa=e&&e.xmlHttpFactory||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new ji(e&&e.concurrentRequestLimit),this.la=new Hi,this.ea=e&&e.fastHandshake||!1,this.Ja=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&e&&e.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function ho(e){if(po(e),3==e.v){var t=e.R++,n=yi(e.B);wi(n,"SID",e.J),wi(n,"RID",t),wi(n,"TYPE","terminate"),go(e,n),(t=new Yr(e,e.c,t,void 0)).G=2,t.i=Ti(yi(n)),n=!1,Gt.navigator&&Gt.navigator.sendBeacon&&(n=Gt.navigator.sendBeacon(t.i.toString(),"")),!n&&Gt.Image&&((new Image).src=t.i,n=!0),n||(t.a=No(t.g,null),t.a.ba(t.i)),t.u=Zt(),ii(t)}Po(e)}function fo(e){e.a&&(To(e),e.a.cancel(),e.a=null)}function po(e){fo(e),e.j&&(Gt.clearTimeout(e.j),e.j=null),So(e),e.b.cancel(),e.h&&("number"==typeof e.h&&Gt.clearTimeout(e.h),e.h=null)}function vo(e,t){e.g.push(new Fi(e.Pa++,t)),3==e.v&&yo(e)}function yo(e){Vi(e.b)||e.h||(e.h=!0,yr(e.Ca,e),e.u=0)}function mo(e,t){var n;n=t?t.f:e.R++;var r=yi(e.B);wi(r,"SID",e.J),wi(r,"RID",n),wi(r,"AID",e.P),go(e,r),e.i&&e.l&&uo(r,e.i,e.l),n=new Yr(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=bo(e,n,1e3),n.setTimeout(Math.round(.5*e.na)+Math.round(.5*e.na*Math.random())),Gi(e.b,n),ei(n,r,t)}function go(e,t){e.f&&li({},(function(e,n){wi(t,n,e)}))}function bo(e,t,n){n=Math.min(e.g.length,n);var r=e.f?Xt(e.f.Ka,e.f,e):null;e:for(var i=e.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{Qi(l,a,"req"+c+"_")}catch(e){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function _o(e){e.a||e.j||(e.T=1,yr(e.Ba,e),e.o=0)}function wo(e){return!(e.a||e.j||3<=e.o)&&(e.T++,e.j=Ur(Xt(e.Ba,e),Io(e,e.o)),e.o++,!0)}function To(e){null!=e.s&&(Gt.clearTimeout(e.s),e.s=null)}function Co(e){e.a=new Yr(e,e.c,"rpc",e.T),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=yi(e.ma);wi(t,"RID","rpc"),wi(t,"SID",e.J),wi(t,"CI",e.G?"0":"1"),wi(t,"AID",e.P),go(e,t),wi(t,"TYPE","xmlhttp"),e.i&&e.l&&uo(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ha,n.G=1,n.i=Ti(yi(t)),n.j=null,n.I=!0,ti(n,e)}function So(e){null!=e.m&&(Gt.clearTimeout(e.m),e.m=null)}function Eo(e,t){var n=null;if(e.a==t){So(e),To(e),e.a=null;var r=2}else{if(!Bi(e.b,t))return;n=t.s,Ki(e.b,t),r=1}if(e.I=t.N,0!=e.v)if(t.b)if(1==r){n=t.j?t.j.length:0,t=Zt()-t.u;var i=e.u;sr(r=Dr(),new jr(r,n,t,i)),yo(e)}else _o(e);else if(3==(i=t.h)||0==i&&0<e.I||!(1==r&&function(e,t){return!(qi(e.b)>=e.b.f-(e.h?1:0))&&(e.h?(e.g=t.s.concat(e.g),!0):!(1==e.v||2==e.v||e.u>=(e.Ma?0:e.Na))&&(e.h=Ur(Xt(e.Ca,e,t),Io(e,e.u)),e.u++,!0))}(e,t)||2==r&&wo(e)))switch(n&&0<n.length&&(t=e.b,t.c=t.c.concat(n)),i){case 1:ko(e,5);break;case 4:ko(e,10);break;case 3:ko(e,6);break;default:ko(e,2)}}function Io(e,t){var n=e.Ia+Math.floor(Math.random()*e.Sa);return e.f||(n*=2),n*t}function ko(e,t){if(e.c.info("Error code "+t),2==t){var n=null;e.f&&(n=null);var r=Xt(e.cb,e);n||(n=new vi("//www.google.com/images/cleardot.gif"),Gt.location&&"http"==Gt.location.protocol||mi(n,"https"),Ti(n)),function(e,t){var n=new Rr;if(Gt.Image){var r=new Image;r.onload=Jt($i,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Jt($i,n,r,"TestLoadImage: error",!1,t),r.onabort=Jt($i,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Jt($i,n,r,"TestLoadImage: timeout",!1,t),Gt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Fr(2);e.v=0,e.f&&e.f.sa(t),Po(e),po(e)}function Po(e){e.v=0,e.I=-1,e.f&&(0==Wi(e.b).length&&0==e.g.length||(e.b.c.length=0,an(e.g),e.g.length=0),e.f.ra())}function Ro(e,t,n){var r=function(e){return e instanceof vi?yi(e):new vi(e,void 0)}(n);if(""!=r.c)t&&gi(r,t+"."+r.c),bi(r,r.h);else{var i=Gt.location;r=function(e,t,n,r){var i=new vi(null,void 0);return e&&mi(i,e),t&&gi(i,t),n&&bi(i,n),r&&(i.g=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&dn(e.V,(function(e,t){wi(r,t,e)})),t=e.A,n=e.oa,t&&n&&wi(r,t,n),wi(r,"VER",e.ia),go(e,r),r}function No(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Xi(e.Oa)).G=e.C,t}function xo(){}function Ao(){if(Tn&&!(10<=Number(Mn)))throw Error("Environmental error: no available transport.")}function Do(e,t){ar.call(this),this.a=new lo(t),this.g=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!sn(e)&&(this.a.i=e),this.o=t&&t.supportsCrossDomainXhr||!1,this.m=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!sn(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&(t in(e=this.b)&&delete e[t])),this.f=new Lo(this)}function Oo(e){Hr.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function Mo(){Qr.call(this),this.status=1}function Lo(e){this.a=e}function Fo(e){this.f=e}function jo(e){ar.call(this),this.u=e,this.h=void 0,this.readyState=Uo,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(Vt=Xi.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+e);t=t?t.toUpperCase():"GET",this.C=e,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():Wr.a(),this.u=this.l?Gr(this.l):Gr(Wr),this.a.onreadystatechange=Xt(this.Aa,this);try{this.B=!0,this.a.open(t,String(e),!0),this.B=!1}catch(e){return void no(this,e)}e=n||"";var i=new hi(this.headers);r&&li(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=to,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.L()),n=Gt.FormData&&e instanceof Gt.FormData,!(0<=nn(eo,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{ao(this),0<this.s&&((this.F=function(e){return Tn&&Dn(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=Xt(this.ya,this)):this.o=Tr(this.ya,this.s,this)),this.m=!0,this.a.send(e),this.m=!1}catch(e){no(this,e)}},Vt.ya=function(){void 0!==Bt&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,sr(this,"timeout"),this.abort(8))},Vt.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,sr(this,"complete"),sr(this,"abort"),oo(this))},Vt.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),oo(this,!0)),Xi.X.H.call(this)},Vt.Aa=function(){this.j||(this.B||this.m||this.g?io(this):this.Za())},Vt.Za=function(){io(this)},Vt.W=function(){try{return 2<so(this)?this.a.status:-1}catch(e){return-1}},Vt.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},Vt.Qa=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Yi(t)}},Vt.va=function(){return this.h},Vt.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(Vt=lo.prototype).ia=8,Vt.v=1,Vt.Ca=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new Yr(this,this.c,e,void 0),r=this.l;if(this.O&&(r?mn(r=vn(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)e:{for(var i=t=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=bo(this,n,t),wi(i=yi(this.B),"RID",e),wi(i,"CVER",22),this.A&&wi(i,"X-HTTP-Session-Id",this.A),go(this,i),this.i&&r&&uo(i,this.i,r),Gi(this.b,n),this.Ja&&wi(i,"TYPE","init"),this.ea?(wi(i,"$req",t),wi(i,"SID","null"),n.U=!0,ei(n,i,null)):ei(n,i,t),this.v=2}}else 3==this.v&&(e?mo(this,e):0==this.g.length||Vi(this.b)||mo(this))},Vt.Ba=function(){if(this.j=null,Co(this),this.U&&!(this.F||null==this.a||0>=this.N)){var e=2*this.N;this.c.info("BP detection timer enabled: "+e),this.s=Ur(Xt(this.Ya,this),e)}},Vt.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,Fr(10),fo(this),Co(this))},Vt.Xa=function(){null!=this.m&&(this.m=null,fo(this),wo(this),Fr(19))},Vt.cb=function(e){e?(this.c.info("Successfully pinged google.com"),Fr(2)):(this.c.info("Failed to ping google.com"),Fr(1))},(Vt=xo.prototype).ua=function(){},Vt.ta=function(){},Vt.sa=function(){},Vt.ra=function(){},Vt.Ka=function(){},Ao.prototype.a=function(e,t){return new Do(e,t)},en(Do,ar),Do.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var e=this.a,t=this.g,n=this.b||void 0;Fr(0),e.ga=t,e.V=n||{},e.G=e.S,e.B=Ro(e,null,e.ga),yo(e)},Do.prototype.close=function(){ho(this.a)},Do.prototype.l=function(e){if("string"==typeof e){var t={};t.__data__=e,vo(this.a,t)}else this.m?((t={}).__data__=cr(e),vo(this.a,t)):vo(this.a,e)},Do.prototype.H=function(){this.a.f=null,delete this.f,ho(this.a),delete this.a,Do.X.H.call(this)},en(Oo,Hr),en(Mo,Qr),en(Lo,xo),Lo.prototype.ua=function(){sr(this.a,"a")},Lo.prototype.ta=function(e){sr(this.a,new Oo(e))},Lo.prototype.sa=function(e){sr(this.a,new Mo(e))},Lo.prototype.ra=function(){sr(this.a,"b")},en(Fo,Br),Fo.prototype.a=function(){return new jo(this.f)},Fo.prototype.c=function(e){return function(){return e}}({}),en(jo,ar);var Uo=0;function Vo(e){e.f.read().then(e.Ta.bind(e)).catch(e.ca.bind(e))}function qo(e){e.readyState=4,e.g=null,e.f=null,e.m=null,Bo(e)}function Bo(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Vt=jo.prototype).open=function(e,t){if(this.readyState!=Uo)throw this.abort(),Error("Error reopening a connection");this.s=e,this.o=t,this.readyState=1,Bo(this)},Vt.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.o,t)).then(this.Wa.bind(this),this.ca.bind(this))},Vt.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,qo(this)),this.readyState=Uo},Vt.Wa=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,Bo(this)),this.a&&(this.readyState=3,Bo(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==Gt.ReadableStream&&"body"in e?(this.responseText="",this.f=e.body.getReader(),this.m=new TextDecoder,Vo(this)):e.text().then(this.Va.bind(this),this.ca.bind(this)))))},Vt.Ta=function(e){if(this.a){var t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.responseText+=t),e.done?qo(this):Bo(this),3==this.readyState&&Vo(this)}},Vt.Va=function(e){this.a&&(this.responseText=e,qo(this))},Vt.Ua=function(){this.a&&qo(this)},Vt.ca=function(){this.a&&qo(this)},Vt.setRequestHeader=function(e,t){this.l.append(e,t)},Vt.getResponseHeader=function(e){return this.b&&this.b.get(e.toLowerCase())||""},Vt.getAllResponseHeaders=function(){if(!this.b)return"";for(var e=[],t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(jo.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),Ao.prototype.createWebChannel=Ao.prototype.a,Do.prototype.send=Do.prototype.l,Do.prototype.open=Do.prototype.h,Do.prototype.close=Do.prototype.close,Vr.NO_ERROR=0,Vr.TIMEOUT=8,Vr.HTTP_ERROR=6,qr.COMPLETE="complete",Kr.EventType=zr,zr.OPEN="a",zr.CLOSE="b",zr.ERROR="c",zr.MESSAGE="d",ar.prototype.listen=ar.prototype.wa,Xi.prototype.listenOnce=Xi.prototype.xa,Xi.prototype.getLastError=Xi.prototype.Ra,Xi.prototype.getLastErrorCode=Xi.prototype.va,Xi.prototype.getStatus=Xi.prototype.W,Xi.prototype.getResponseJson=Xi.prototype.Qa,Xi.prototype.getResponseText=Xi.prototype.$,Xi.prototype.send=Xi.prototype.ba;var Go=Vr,Ko=qr,Wo=xr,zo=10,Ho=11,Qo=Fo,$o=Kr,Yo=Xi,Xo=function(e,t){return(Xo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Jo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Xo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Zo(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function ea(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function ta(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var na=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.t(e)},this.i=function(e){return t.writeSequenceNumber(e)})}return e.prototype.t=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.i&&this.i(e),e},e}();na.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ra={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ia=function(e){function t(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Jo(t,e),t}(Error),oa=new Ct("@firebase/firestore");function aa(){return oa.logLevel}function sa(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(oa.logLevel<=yt.DEBUG){var r=t.map(la);oa.debug.apply(oa,ta(["Firestore (8.6.8): "+e],r))}}function ua(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(oa.logLevel<=yt.ERROR){var r=t.map(la);oa.error.apply(oa,ta(["Firestore (8.6.8): "+e],r))}}function ca(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(oa.logLevel<=yt.WARN){var r=t.map(la);oa.warn.apply(oa,ta(["Firestore (8.6.8): "+e],r))}}function la(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ha(e){void 0===e&&(e="Unexpected state");var t="FIRESTORE (8.6.8) INTERNAL ASSERTION FAILED: "+e;throw ua(t),new Error(t)}function fa(e,t){e||ha()}function pa(e,t){return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function da(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var va=function(){function e(){}return e.u=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=da(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n},e}();function ya(e,t){return e<t?-1:e>t?1:0}function ma(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function ga(e){return e+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ba=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ia(ra.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ia(ra.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ia(ra.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ia(ra.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?ya(this.nanoseconds,e.nanoseconds):ya(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),_a=function(){function e(e){this.timestamp=e}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new ba(0,0))},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wa(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ta(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ca(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sa=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&ha(),void 0===n?n=e.length-t:n>e.length-t&&ha(),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),Ea=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new ia(ra.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(e){return e.length>0})))}return new t(r)},t.emptyPath=function(){return new t([])},t}(Sa),Ia=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ka=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return Ia.test(e)},t.prototype.canonicalString=function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ia(ra.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new ia(ra.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ia(ra.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new ia(ra.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.emptyPath=function(){return new t([])},t}(Sa),Pa=function(){function e(e){this.fields=e,e.sort(ka.comparator)}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return ma(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))},e}(),Ra=function(){function e(e){this.binaryString=e}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))},e.prototype.toBase64=function(){return e=this.binaryString,btoa(e);var e},e.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(e){return ya(this.binaryString,e.binaryString)},e.prototype.isEqual=function(e){return this.binaryString===e.binaryString},e}();Ra.EMPTY_BYTE_STRING=new Ra("");var Na=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xa(e){if(fa(!!e),"string"==typeof e){var t=0,n=Na.exec(e);if(fa(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Aa(e.seconds),nanos:Aa(e.nanos)}}function Aa(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Da(e){return"string"==typeof e?Ra.fromBase64String(e):Ra.fromUint8Array(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oa(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ma(e){var t=xa(e.mapValue.fields.__local_write_time__.timestampValue);return new ba(t.seconds,t.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function La(e){return null==e}function Fa(e){return 0===e&&1/e==-1/0}function ja(e){return"number"==typeof e&&Number.isInteger(e)&&!Fa(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ua=function(){function e(e){this.path=e}return e.fromPath=function(t){return new e(Ea.fromString(t))},e.fromName=function(t){return new e(Ea.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===Ea.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return Ea.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new Ea(t.slice()))},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Va(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Oa(e)?4:10:ha()}function qa(e,t){var n=Va(e);if(n!==Va(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ma(e).isEqual(Ma(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=xa(e.timestampValue),r=xa(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Da(e.bytesValue).isEqual(Da(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Aa(e.geoPointValue.latitude)===Aa(t.geoPointValue.latitude)&&Aa(e.geoPointValue.longitude)===Aa(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Aa(e.integerValue)===Aa(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Aa(e.doubleValue),r=Aa(t.doubleValue);return n===r?Fa(n)===Fa(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ma(e.arrayValue.values||[],t.arrayValue.values||[],qa);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(wa(n)!==wa(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!qa(n[i],r[i])))return!1;return!0}(e,t);default:return ha()}}function Ba(e,t){return void 0!==(e.values||[]).find((function(e){return qa(e,t)}))}function Ga(e,t){var n=Va(e),r=Va(t);if(n!==r)return ya(n,r);switch(n){case 0:return 0;case 1:return ya(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Aa(e.integerValue||e.doubleValue),r=Aa(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ka(e.timestampValue,t.timestampValue);case 4:return Ka(Ma(e),Ma(t));case 5:return ya(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Da(e),r=Da(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ya(n[i],r[i]);if(0!==o)return o}return ya(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=ya(Aa(e.latitude),Aa(t.latitude));return 0!==n?n:ya(Aa(e.longitude),Aa(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ga(n[i],r[i]);if(o)return o}return ya(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=ya(r[a],o[a]);if(0!==s)return s;var u=Ga(n[r[a]],i[o[a]]);if(0!==u)return u}return ya(r.length,o.length)}(e.mapValue,t.mapValue);default:throw ha()}}function Ka(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ya(e,t);var n=xa(e),r=xa(t),i=ya(n.seconds,r.seconds);return 0!==i?i:ya(n.nanos,r.nanos)}function Wa(e){return function e(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(e){var t=xa(e);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Da(t.bytesValue).toBase64():"referenceValue"in t?(r=t.referenceValue,Ua.fromName(r).toString()):"geoPointValue"in t?"geo("+(n=t.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in t?function(t){for(var n="[",r=!0,i=0,o=t.values||[];i<o.length;i++)r?r=!1:n+=",",n+=e(o[i]);return n+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var n="{",r=!0,i=0,o=Object.keys(t.fields||{}).sort();i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+e(t.fields[a])}return n+"}"}(t.mapValue):ha();var n,r}(e)}function za(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function Ha(e){return!!e&&"integerValue"in e}function Qa(e){return!!e&&"arrayValue"in e}function $a(e){return!!e&&"nullValue"in e}function Ya(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xa(e){return!!e&&"mapValue"in e}function Ja(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue)return{timestampValue:Object.assign({},xa(e.timestampValue))};if(e.mapValue){var t={mapValue:{fields:{}}};return Ta(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Ja(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ja(e.arrayValue.values[r]);return n}return Object.assign({},e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Za=function(){function e(e){this.value=e}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Xa(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null},e.prototype.set=function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ja(t)},e.prototype.setAll=function(e){var t=this,n=ka.emptyPath(),r={},i=[];e.forEach((function(e,o){if(!n.isImmediateParentOf(o)){var a=t.getFieldsMap(n);t.applyChanges(a,r,i),r={},i=[],n=o.popLast()}e?r[o.lastSegment()]=Ja(e):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},e.prototype.delete=function(e){var t=this.field(e.popLast());Xa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]},e.prototype.isEqual=function(e){return qa(this.value,e.value)},e.prototype.getFieldsMap=function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Xa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields},e.prototype.applyChanges=function(e,t,n){Ta(t,(function(t,n){return e[t]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete e[o]}},e.prototype.clone=function(){return new e(Ja(this.value))},e}();function es(e){var t=[];return Ta(e.fields,(function(e,n){var r=new ka([e]);if(Xa(n)){var i=es(n.mapValue).fields;if(0===i.length)t.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];t.push(r.child(s))}}else t.push(r)})),new Pa(t)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var ts=function(){function e(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}return e.newInvalidDocument=function(t){return new e(t,0,_a.min(),Za.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,Za.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,Za.empty(),2)},e.prototype.convertToFoundDocument=function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this},e.prototype.convertToNoDocument=function(e){return this.version=e,this.documentType=2,this.data=Za.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(e){return this.version=e,this.documentType=3,this.data=Za.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return 0!==this.documentType},e.prototype.isFoundDocument=function(){return 1===this.documentType},e.prototype.isNoDocument=function(){return 2===this.documentType},e.prototype.isUnknownDocument=function(){return 3===this.documentType},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),ns=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rs(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new ns(e,t,n,r,i,o,a)}function is(e){var t=pa(e);if(null===t.h){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return function(e){return e.field.canonicalString()+e.op.toString()+Wa(e.value)}(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),La(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=ms(t.startAt)),t.endAt&&(n+="|ub:",n+=ms(t.endAt)),t.h=n}return t.h}function os(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!bs(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],o=t.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!qa(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ws(e.startAt,t.startAt)&&ws(e.endAt,t.endAt)}function as(e){return Ua.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var ss=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return Jo(t,e),t.create=function(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.l(e,n,r):new us(e,n,r):"array-contains"===n?new fs(e,r):"in"===n?new ps(e,r):"not-in"===n?new ds(e,r):"array-contains-any"===n?new vs(e,r):new t(e,n,r)},t.l=function(e,t,n){return"in"===t?new cs(e,n):new ls(e,n)},t.prototype.matches=function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(Ga(t,this.value)):null!==t&&Va(this.value)===Va(t)&&this.m(Ga(t,this.value))},t.prototype.m=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ha()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}((function(){})),us=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=Ua.fromName(r.referenceValue),i}return Jo(t,e),t.prototype.matches=function(e){var t=Ua.comparator(e.key,this.key);return this.m(t)},t}(ss),cs=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"in",n)||this).keys=hs("in",n),r}return Jo(t,e),t.prototype.matches=function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))},t}(ss),ls=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"not-in",n)||this).keys=hs("not-in",n),r}return Jo(t,e),t.prototype.matches=function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))},t}(ss);function hs(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return Ua.fromName(e.referenceValue)}))}var fs=function(e){function t(t,n){return e.call(this,t,"array-contains",n)||this}return Jo(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return Qa(t)&&Ba(t.arrayValue,this.value)},t}(ss),ps=function(e){function t(t,n){return e.call(this,t,"in",n)||this}return Jo(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return null!==t&&Ba(this.value.arrayValue,t)},t}(ss),ds=function(e){function t(t,n){return e.call(this,t,"not-in",n)||this}return Jo(t,e),t.prototype.matches=function(e){if(Ba(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Ba(this.value.arrayValue,t)},t}(ss),vs=function(e){function t(t,n){return e.call(this,t,"array-contains-any",n)||this}return Jo(t,e),t.prototype.matches=function(e){var t=this,n=e.data.field(this.field);return!(!Qa(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Ba(t.value.arrayValue,e)}))},t}(ss),ys=function(e,t){this.position=e,this.before=t};function ms(e){return(e.before?"b":"a")+":"+e.position.map((function(e){return Wa(e)})).join(",")}var gs=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};function bs(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function _s(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],a=e.position[i];if(r=o.field.isKeyField()?Ua.comparator(Ua.fromName(a.referenceValue),n.key):Ga(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function ws(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!qa(e.position[n],t.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ts=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function Cs(e,t,n,r,i,o,a,s){return new Ts(e,t,n,r,i,o,a,s)}function Ss(e){return new Ts(e)}function Es(e){return!La(e.limit)&&"F"===e.limitType}function Is(e){return!La(e.limit)&&"L"===e.limitType}function ks(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Ps(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function Rs(e){return null!==e.collectionGroup}function Ns(e){var t=pa(e);if(null===t.p){t.p=[];var n=Ps(t),r=ks(t);if(null!==n&&null===r)n.isKeyField()||t.p.push(new gs(n)),t.p.push(new gs(ka.keyField(),"asc"));else{for(var i=!1,o=0,a=t.explicitOrderBy;o<a.length;o++){var s=a[o];t.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new gs(ka.keyField(),u))}}}return t.p}function xs(e){var t=pa(e);if(!t.T)if("F"===t.limitType)t.T=rs(t.path,t.collectionGroup,Ns(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Ns(t);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new gs(o.field,a))}var s=t.endAt?new ys(t.endAt.position,!t.endAt.before):null,u=t.startAt?new ys(t.startAt.position,!t.startAt.before):null;t.T=rs(t.path,t.collectionGroup,n,t.filters,t.limit,s,u)}return t.T}function As(e,t,n){return new Ts(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ds(e,t){return os(xs(e),xs(t))&&e.limitType===t.limitType}function Os(e){return is(xs(e))+"|lt:"+e.limitType}function Ms(e){return"Query(target="+function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: ["+e.filters.map((function(e){return(t=e).field.canonicalString()+" "+t.op+" "+Wa(t.value);var t})).join(", ")+"]"),La(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: ["+e.orderBy.map((function(e){return function(e){return e.field.canonicalString()+" ("+e.dir+")"}(e)})).join(", ")+"]"),e.startAt&&(t+=", startAt: "+ms(e.startAt)),e.endAt&&(t+=", endAt: "+ms(e.endAt)),"Target("+t+")"}(xs(e))+"; limitType="+e.limitType+")"}function Ls(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ua.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(var n=0,r=e.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}return!0}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++)if(!r[n].matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!_s(e.startAt,Ns(e),t)||e.endAt&&_s(e.endAt,Ns(e),t))}(e,t)}function Fs(e){return function(t,n){for(var r=!1,i=0,o=Ns(e);i<o.length;i++){var a=o[i],s=js(a,t,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function js(e,t,n){var r=e.field.isKeyField()?Ua.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Ga(r,i):ha()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ha()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Us(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fa(t)?"-0":t}}function Vs(e){return{integerValue:""+e}}function qs(e,t){return ja(t)?Vs(t):Us(e,t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bs=function(){this._=void 0};function Gs(e,t,n){return e instanceof zs?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Hs?Qs(e,t):e instanceof $s?Ys(e,t):function(e,t){var n=Ws(e,t),r=Js(n)+Js(e.A);return Ha(n)&&Ha(e.A)?Vs(r):Us(e.R,r)}(e,t)}function Ks(e,t,n){return e instanceof Hs?Qs(e,t):e instanceof $s?Ys(e,t):n}function Ws(e,t){return e instanceof Xs?Ha(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var zs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t}(Bs),Hs=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Jo(t,e),t}(Bs);function Qs(e,t){for(var n=Zs(t),r=function(e){n.some((function(t){return qa(t,e)}))||n.push(e)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var $s=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Jo(t,e),t}(Bs);function Ys(e,t){for(var n=Zs(t),r=function(e){n=n.filter((function(t){return!qa(t,e)}))},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Xs=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).R=t,r.A=n,r}return Jo(t,e),t}(Bs);function Js(e){return Aa(e.integerValue||e.doubleValue)}function Zs(e){return Qa(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var eu=function(e,t){this.field=e,this.transform=t},tu=function(e,t){this.version=e,this.transformResults=t},nu=function(){function e(e,t){this.updateTime=e,this.exists=t}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},e}();function ru(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var iu=function(){};function ou(e,t,n){e instanceof lu?function(e,t,n){var r=e.value.clone(),i=pu(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof hu?function(e,t,n){if(ru(e.precondition,t)){var r=pu(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(fu(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function au(e,t,n){e instanceof lu?function(e,t,n){if(ru(e.precondition,t)){var r=e.value.clone(),i=du(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(cu(t),r).setHasLocalMutations()}}(e,t,n):e instanceof hu?function(e,t,n){if(ru(e.precondition,t)){var r=du(e.fieldTransforms,n,t),i=t.data;i.setAll(fu(e)),i.setAll(r),t.convertToFoundDocument(cu(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){ru(e.precondition,t)&&t.convertToNoDocument(_a.min())}(e,t)}function su(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],a=t.data.field(o.field),s=Ws(o.transform,a||null);null!=s&&(null==n&&(n=Za.empty()),n.set(o.field,s))}return n||null}function uu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ma(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Hs&&t instanceof Hs||e instanceof $s&&t instanceof $s?ma(e.elements,t.elements,qa):e instanceof Xs&&t instanceof Xs?qa(e.A,t.A):e instanceof zs&&t instanceof zs}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function cu(e){return e.isFoundDocument()?e.version:_a.min()}var lu=function(e){function t(t,n,r,i){void 0===i&&(i=[]);var o=this;return(o=e.call(this)||this).key=t,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Jo(t,e),t}(iu),hu=function(e){function t(t,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=e.call(this)||this).key=t,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return Jo(t,e),t}(iu);function fu(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function pu(e,t,n){var r=new Map;fa(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=t.data.field(o.field);r.set(o.field,Ks(a,s,n[i]))}return r}function du(e,t,n){for(var r=new Map,i=0,o=e;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,Gs(s,u,t))}return r}var vu,yu,mu=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Jo(t,e),t}(iu),gu=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Jo(t,e),t}(iu),bu=function(e){this.count=e};function _u(e){switch(e){case ra.OK:return ha();case ra.CANCELLED:case ra.UNKNOWN:case ra.DEADLINE_EXCEEDED:case ra.RESOURCE_EXHAUSTED:case ra.INTERNAL:case ra.UNAVAILABLE:case ra.UNAUTHENTICATED:return!1;case ra.INVALID_ARGUMENT:case ra.NOT_FOUND:case ra.ALREADY_EXISTS:case ra.PERMISSION_DENIED:case ra.FAILED_PRECONDITION:case ra.ABORTED:case ra.OUT_OF_RANGE:case ra.UNIMPLEMENTED:case ra.DATA_LOSS:return!0;default:return ha()}}function wu(e){if(void 0===e)return ua("GRPC error has no .code"),ra.UNKNOWN;switch(e){case vu.OK:return ra.OK;case vu.CANCELLED:return ra.CANCELLED;case vu.UNKNOWN:return ra.UNKNOWN;case vu.DEADLINE_EXCEEDED:return ra.DEADLINE_EXCEEDED;case vu.RESOURCE_EXHAUSTED:return ra.RESOURCE_EXHAUSTED;case vu.INTERNAL:return ra.INTERNAL;case vu.UNAVAILABLE:return ra.UNAVAILABLE;case vu.UNAUTHENTICATED:return ra.UNAUTHENTICATED;case vu.INVALID_ARGUMENT:return ra.INVALID_ARGUMENT;case vu.NOT_FOUND:return ra.NOT_FOUND;case vu.ALREADY_EXISTS:return ra.ALREADY_EXISTS;case vu.PERMISSION_DENIED:return ra.PERMISSION_DENIED;case vu.FAILED_PRECONDITION:return ra.FAILED_PRECONDITION;case vu.ABORTED:return ra.ABORTED;case vu.OUT_OF_RANGE:return ra.OUT_OF_RANGE;case vu.UNIMPLEMENTED:return ra.UNIMPLEMENTED;case vu.DATA_LOSS:return ra.DATA_LOSS;default:return ha()}}(yu=vu||(vu={}))[yu.OK=0]="OK",yu[yu.CANCELLED=1]="CANCELLED",yu[yu.UNKNOWN=2]="UNKNOWN",yu[yu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yu[yu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yu[yu.NOT_FOUND=5]="NOT_FOUND",yu[yu.ALREADY_EXISTS=6]="ALREADY_EXISTS",yu[yu.PERMISSION_DENIED=7]="PERMISSION_DENIED",yu[yu.UNAUTHENTICATED=16]="UNAUTHENTICATED",yu[yu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yu[yu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yu[yu.ABORTED=10]="ABORTED",yu[yu.OUT_OF_RANGE=11]="OUT_OF_RANGE",yu[yu.UNIMPLEMENTED=12]="UNIMPLEMENTED",yu[yu.INTERNAL=13]="INTERNAL",yu[yu.UNAVAILABLE=14]="UNAVAILABLE",yu[yu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Tu=function(){function e(e,t){this.comparator=e,this.root=t||Su.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Su.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Su.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))},e.prototype.toString=function(){var e=[];return this.inorderTraversal((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new Cu(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new Cu(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new Cu(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new Cu(this.root,e,this.comparator,!0)},e}(),Cu=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Su=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ha();if(this.right.isRed())throw ha();var e=this.left.check();if(e!==this.right.check())throw ha();return e+(this.isRed()?0:1)},e}();Su.EMPTY=null,Su.RED=!0,Su.BLACK=!1,Su.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw ha()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw ha()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw ha()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw ha()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw ha()},enumerable:!1,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Su(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Eu=function(){function e(e){this.comparator=e,this.data=new Tu(this.comparator)}return e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new Iu(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new Iu(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Iu=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),ku=new Tu(Ua.comparator);function Pu(){return ku}var Ru=new Tu(Ua.comparator);function Nu(){return Ru}var xu=new Tu(Ua.comparator);var Au=new Eu(Ua.comparator);function Du(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Au,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ou=new Eu(ya);function Mu(){return Ou}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Lu=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,Fu.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(_a.min(),r,Mu(),Pu(),Du())},e}(),Fu=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(Ra.EMPTY_BYTE_STRING,n,Du(),Du(),Du())},e}(),ju=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},Uu=function(e,t){this.targetId=e,this.V=t},Vu=function(e,t,n,r){void 0===n&&(n=Ra.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},qu=function(){function e(){this.S=0,this.D=Ku(),this.C=Ra.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),e.prototype.O=function(e){e.approximateByteSize()>0&&(this.F=!0,this.C=e)},e.prototype.M=function(){var e=Du(),t=Du(),n=Du();return this.D.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ha()}})),new Fu(this.C,this.N,e,t,n)},e.prototype.L=function(){this.F=!1,this.D=Ku()},e.prototype.B=function(e,t){this.F=!0,this.D=this.D.insert(e,t)},e.prototype.q=function(e){this.F=!0,this.D=this.D.remove(e)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.F=!0,this.N=!0},e}(),Bu=function(){function e(e){this.W=e,this.G=new Map,this.H=Pu(),this.J=Gu(),this.Y=new Eu(ya)}return e.prototype.X=function(e){for(var t=0,n=e.v;t<n.length;t++){var r=n[t];e.P&&e.P.isFoundDocument()?this.Z(r,e.P):this.tt(r,e.key,e.P)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,e.key,e.P)},e.prototype.et=function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.nt(n);switch(e.state){case 0:t.st(n)&&r.O(e.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(e.resumeToken);break;case 2:r.K(),r.k||t.removeTarget(n);break;case 3:t.st(n)&&(r.j(),r.O(e.resumeToken));break;case 4:t.st(n)&&(t.it(n),r.O(e.resumeToken));break;default:ha()}}))},e.prototype.forEachTarget=function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach((function(e,r){n.st(r)&&t(r)}))},e.prototype.rt=function(e){var t=e.targetId,n=e.V.count,r=this.ot(t);if(r){var i=r.target;if(as(i))if(0===n){var o=new Ua(i.path);this.tt(t,o,ts.newNoDocument(o,_a.min()))}else fa(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}},e.prototype.ut=function(e){var t=this,n=new Map;this.G.forEach((function(r,i){var o=t.ot(i);if(o){if(r.current&&as(o.target)){var a=new Ua(o.target.path);null!==t.H.get(a)||t.at(i,a)||t.tt(i,a,ts.newNoDocument(a,e))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Du();this.J.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.ot(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))}));var i=new Lu(e,n,this.Y,this.H,r);return this.H=Pu(),this.J=Gu(),this.Y=new Eu(ya),i},e.prototype.Z=function(e,t){if(this.st(e)){var n=this.at(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}},e.prototype.tt=function(e,t,n){if(this.st(e)){var r=this.nt(e);this.at(e,t)?r.B(t,1):r.q(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}},e.prototype.removeTarget=function(e){this.G.delete(e)},e.prototype.ct=function(e){var t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.U=function(e){this.nt(e).U()},e.prototype.nt=function(e){var t=this.G.get(e);return t||(t=new qu,this.G.set(e,t)),t},e.prototype.ht=function(e){var t=this.J.get(e);return t||(t=new Eu(ya),this.J=this.J.insert(e,t)),t},e.prototype.st=function(e){var t=null!==this.ot(e);return t||sa("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.ot=function(e){var t=this.G.get(e);return t&&t.k?null:this.W.lt(e)},e.prototype.it=function(e){var t=this;this.G.set(e,new qu),this.W.getRemoteKeysForTarget(e).forEach((function(n){t.tt(e,n,null)}))},e.prototype.at=function(e,t){return this.W.getRemoteKeysForTarget(e).has(t)},e}();function Gu(){return new Tu(Ua.comparator)}function Ku(){return new Tu(Ua.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Wu={asc:"ASCENDING",desc:"DESCENDING"},zu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hu=function(e,t){this.databaseId=e,this.I=t};function Qu(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function $u(e,t){return e.I?t.toBase64():t.toUint8Array()}function Yu(e,t){return Qu(e,t.toTimestamp())}function Xu(e){return fa(!!e),_a.fromTimestamp(function(e){var t=xa(e);return new ba(t.seconds,t.nanos)}(e))}function Ju(e,t){return function(e){return new Ea(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Zu(e){var t=Ea.fromString(e);return fa(wc(t)),t}function ec(e,t){return Ju(e.databaseId,t.path)}function tc(e,t){var n=Zu(t);if(n.get(1)!==e.databaseId.projectId)throw new ia(ra.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ia(ra.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ua(oc(n))}function nc(e,t){return Ju(e.databaseId,t)}function rc(e){var t=Zu(e);return 4===t.length?Ea.emptyPath():oc(t)}function ic(e){return new Ea(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function oc(e){return fa(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ac(e,t,n){return{name:ec(e,t),fields:n.value.mapValue.fields}}function sc(e,t){var n;if(t instanceof lu)n={update:ac(e,t.key,t.value)};else if(t instanceof mu)n={delete:ec(e,t.key)};else if(t instanceof hu)n={update:ac(e,t.key,t.data),updateMask:_c(t.fieldMask)};else{if(!(t instanceof gu))return ha();n={verify:ec(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof zs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Hs)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof $s)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Xs)return{fieldPath:t.field.canonicalString(),increment:n.A};throw ha()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Yu(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ha()}(e,t.precondition)),n}function uc(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?nu.updateTime(Xu(e.updateTime)):void 0!==e.exists?nu.exists(e.exists):nu.none()}(t.currentDocument):nu.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)fa("REQUEST_TIME"===t.setToServerValue),n=new zs;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Hs(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new $s(i)}else"increment"in t?n=new Xs(e,t.increment):ha();var o=ka.fromServerFormat(t.fieldPath);return new eu(o,n)}(e,t)})):[];if(t.update){t.update.name;var i=tc(e,t.update.name),o=new Za({mapValue:{fields:t.update.fields}});if(t.updateMask){var a=function(e){var t=e.fieldPaths||[];return new Pa(t.map((function(e){return ka.fromServerFormat(e)})))}(t.updateMask);return new hu(i,o,a,n,r)}return new lu(i,o,n,r)}if(t.delete){var s=tc(e,t.delete);return new mu(s,n)}if(t.verify){var u=tc(e,t.verify);return new gu(u,n)}return ha()}function cc(e,t){return{documents:[nc(e,t.path)]}}function lc(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=nc(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=nc(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(Ya(e.value))return{unaryFilter:{field:yc(e.field),op:"IS_NAN"}};if($a(e.value))return{unaryFilter:{field:yc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ya(e.value))return{unaryFilter:{field:yc(e.field),op:"IS_NOT_NAN"}};if($a(e.value))return{unaryFilter:{field:yc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yc(e.field),op:vc(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:yc(e.field),direction:dc(e.dir)}}(e)}))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(e,t){return e.I||La(t)?t:{value:t}}(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=fc(t.startAt)),t.endAt&&(n.structuredQuery.endAt=fc(t.endAt)),n}function hc(e){var t=rc(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){fa(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=function e(t){return t?void 0!==t.unaryFilter?[bc(t)]:void 0!==t.fieldFilter?[gc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e(t)})).reduce((function(e,t){return e.concat(t)})):ha():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new gs(mc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var u=null;n.limit&&(u=function(e){var t;return La(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=pc(n.startAt));var l=null;return n.endAt&&(l=pc(n.endAt)),Cs(t,i,s,a,u,"F",c,l)}function fc(e){return{before:e.before,values:e.position}}function pc(e){var t=!!e.before,n=e.values||[];return new ys(n,t)}function dc(e){return Wu[e]}function vc(e){return zu[e]}function yc(e){return{fieldPath:e.canonicalString()}}function mc(e){return ka.fromServerFormat(e.fieldPath)}function gc(e){return ss.create(mc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ha()}}(e.fieldFilter.op),e.fieldFilter.value)}function bc(e){switch(e.unaryFilter.op){case"IS_NAN":var t=mc(e.unaryFilter.field);return ss.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=mc(e.unaryFilter.field);return ss.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=mc(e.unaryFilter.field);return ss.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=mc(e.unaryFilter.field);return ss.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ha()}}function _c(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function wc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Tc(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Sc(t)),t=Cc(e.get(n),t);return Sc(t)}function Cc(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Sc(e){return e+""}function Ec(e){var t=e.length;if(fa(t>=2),2===t)return fa(""===e.charAt(0)&&""===e.charAt(1)),Ea.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf("",o);switch((a<0||a>n)&&ha(),e.charAt(a+1)){case"":var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=e.substring(o,a),i+="\0";break;case"":i+=e.substring(o,a+1);break;default:ha()}o=a+2}return new Ea(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ic=function(e,t){this.seconds=e,this.nanoseconds=t},kc=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};kc.store="owner",kc.key="owner";var Pc=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};Pc.store="mutationQueues",Pc.keyPath="userId";var Rc=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Rc.store="mutations",Rc.keyPath="batchId",Rc.userMutationsIndex="userMutationsIndex",Rc.userMutationsKeyPath=["userId","batchId"];var Nc=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,Tc(t)]},e.key=function(e,t,n){return[e,Tc(t),n]},e}();Nc.store="documentMutations",Nc.PLACEHOLDER=new Nc;var xc=function(e,t){this.path=e,this.readTime=t},Ac=function(e,t){this.path=e,this.version=t},Dc=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Dc.store="remoteDocuments",Dc.readTimeIndex="readTimeIndex",Dc.readTimeIndexPath="readTime",Dc.collectionReadTimeIndex="collectionReadTimeIndex",Dc.collectionReadTimeIndexPath=["parentPath","readTime"];var Oc=function(e){this.byteSize=e};Oc.store="remoteDocumentGlobal",Oc.key="remoteDocumentGlobalKey";var Mc=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Mc.store="targets",Mc.keyPath="targetId",Mc.queryTargetsIndexName="queryTargetsIndex",Mc.queryTargetsKeyPath=["canonicalId","targetId"];var Lc=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};Lc.store="targetDocuments",Lc.keyPath=["targetId","path"],Lc.documentTargetsIndex="documentTargetsIndex",Lc.documentTargetsKeyPath=["path","targetId"];var Fc=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Fc.key="targetGlobalKey",Fc.store="targetGlobal";var jc=function(e,t){this.collectionId=e,this.parent=t};jc.store="collectionParents",jc.keyPath=["collectionId","parent"];var Uc=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Uc.store="clientMetadata",Uc.keyPath="clientId";var Vc=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};Vc.store="bundles",Vc.keyPath="bundleId";var qc=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};qc.store="namedQueries",qc.keyPath="name";var Bc=ta(ta([],ta(ta([],ta(ta([],ta(ta([],[Pc.store,Rc.store,Nc.store,Dc.store,Mc.store,kc.store,Fc.store,Lc.store]),[Uc.store])),[Oc.store])),[jc.store])),[Vc.store,qc.store]),Gc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kc=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(e){return e()}))},e}(),Wc=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},zc=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)}),(function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)}))}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&ha(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))},e.prototype.toPromise=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)},e.resolve=function(t){return new e((function(e,n){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.waitFor=function(t){return new e((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(e){return n(e)}))})),o=!0,i===r&&e()}))},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next((function(n){return n?e.resolve(n):t()}))},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)},e}(),Hc=function(){function e(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ft=new Wc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){t.error?n.ft.reject(new Yc(e,t.error)):n.ft.resolve()},this.transaction.onerror=function(t){var r=tl(t.target.error);n.ft.reject(new Yc(e,r))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Yc(n,t)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(e){e&&this.ft.reject(e),this.aborted||(sa("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return new Jc(t)},e}(),Qc=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,12.2===e._t(Oe())&&ua("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(e){return sa("SimpleDb","Removing database:",e),Zc(window.indexedDB.deleteDatabase(e)).toPromise()},e.yt=function(){if("undefined"==typeof indexedDB)return!1;if(e.gt())return!0;var t=Oe(),n=e._t(t),r=0<n&&n<10,i=e.Et(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.gt=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)},e.It=function(e,t){return e.store(t)},e._t=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Et=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.At=function(e){return Zo(this,void 0,void 0,(function(){var t,n=this;return ea(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(sa("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){var n=e.target.result;t(n)},i.onblocked=function(){r(new Yc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;"VersionError"===n.name?r(new ia(ra.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Yc(e,n))},i.onupgradeneeded=function(e){sa("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.wt.Rt(t,i.transaction,e.oldVersion,n.version).next((function(){sa("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:t.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(e){return n.bt(e)}),this.db)]}}))}))},e.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},e.prototype.runTransaction=function(e,t,n,r){return Zo(this,void 0,void 0,(function(){var i,o,a,s,u;return ea(this,(function(c){switch(c.label){case 0:i="readonly"===t,o=0,a=function(){var t,a,u,c,l;return ea(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(e)];case 2:return s.db=h.sent(),t=Hc.open(s.db,e,i?"readonly":"readwrite",n),a=r(t).catch((function(e){return t.abort(e),zc.reject(e)})).toPromise(),u={},a.catch((function(){})),[4,t.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,sa("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),$c=function(){function e(e){this.Pt=e,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.Pt=e},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(e){this.St=e},e.prototype.delete=function(){return Zc(this.Pt.delete())},e}(),Yc=function(e){function t(t,n){var r=this;return(r=e.call(this,ra.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Jo(t,e),t}(ia);function Xc(e){return"IndexedDbTransactionError"===e.name}var Jc=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(sa("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(sa("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Zc(n)},e.prototype.add=function(e){return sa("SimpleDb","ADD",this.store.name,e,e),Zc(this.store.add(e))},e.prototype.get=function(e){var t=this;return Zc(this.store.get(e)).next((function(n){return void 0===n&&(n=null),sa("SimpleDb","GET",t.store.name,e,n),n}))},e.prototype.delete=function(e){return sa("SimpleDb","DELETE",this.store.name,e),Zc(this.store.delete(e))},e.prototype.count=function(){return sa("SimpleDb","COUNT",this.store.name),Zc(this.store.count())},e.prototype.Nt=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.xt(n,(function(e,t){r.push(t)})).next((function(){return r}))},e.prototype.Ft=function(e,t){sa("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(e,t,n){return n.delete()}))},e.prototype.$t=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.xt(r,t)},e.prototype.Ot=function(e){var t=this.cursor({});return new zc((function(n,r){t.onerror=function(e){var t=tl(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},e.prototype.xt=function(e,t){var n=[];return new zc((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new $c(i),a=t(i.primaryKey,i.value,o);if(a instanceof zc){var s=a.catch((function(e){return o.done(),zc.reject(e)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return zc.waitFor(n)}))},e.prototype.options=function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.kt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function Zc(e){return new zc((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=tl(e.target.error);n(t)}}))}var el=!1;function tl(e){var t=Qc._t(Oe());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new ia("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return el||(el=!0,setTimeout((function(){throw r}),0)),r}}return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var nl=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Mt=t,r.currentSequenceNumber=n,r}return Jo(t,e),t}(Kc);function rl(e,t){var n=pa(e);return Qc.It(n.Mt,t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var il=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}return e.prototype.applyToRemoteDocument=function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&ou(i,e,n[r])}},e.prototype.applyToLocalView=function(e){for(var t=0,n=this.baseMutations;t<n.length;t++)(o=n[t]).key.isEqual(e.key)&&au(o,e,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(e.key)&&au(o,e,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(e){var t=this;this.mutations.forEach((function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(_a.min())}))},e.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Du())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&ma(this.mutations,e.mutations,(function(e,t){return uu(e,t)}))&&ma(this.baseMutations,e.baseMutations,(function(e,t){return uu(e,t)}))},e}(),ol=function(){function e(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}return e.from=function(t,n,r){fa(t.mutations.length===r.length);for(var i=xu,o=t.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new e(t,n,r,i)},e}(),al=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=_a.min()),void 0===o&&(o=_a.min()),void 0===a&&(a=Ra.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),sl=function(e){this.Lt=e};function ul(e,t){if(t.document)return function(e,t,n){var r=tc(e,t.name),i=Xu(t.updateTime),o=new Za({mapValue:{fields:t.fields}}),a=ts.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=Ua.fromSegments(t.noDocument.path),r=pl(t.noDocument.readTime),i=ts.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var o=Ua.fromSegments(t.unknownDocument.path);return r=pl(t.unknownDocument.version),ts.newUnknownDocument(o,r)}return ha()}function cl(e,t,n){var r=ll(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var o=function(e,t){return{name:ec(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Qu(e,t.version.toTimestamp())}}(e.Lt,t),a=t.hasCommittedMutations;return new Dc(null,null,o,a,r,i)}if(t.isNoDocument()){var s=t.key.path.toArray(),u=fl(t.version);return a=t.hasCommittedMutations,new Dc(null,new xc(s,u),null,a,r,i)}if(t.isUnknownDocument()){var c=t.key.path.toArray(),l=fl(t.version);return new Dc(new Ac(c,l),null,null,!0,r,i)}return ha()}function ll(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function hl(e){var t=new ba(e[0],e[1]);return _a.fromTimestamp(t)}function fl(e){var t=e.toTimestamp();return new Ic(t.seconds,t.nanoseconds)}function pl(e){var t=new ba(e.seconds,e.nanoseconds);return _a.fromTimestamp(t)}function dl(e,t){for(var n=(t.baseMutations||[]).map((function(t){return uc(e.Lt,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var o=t.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var a=t.mutations.map((function(t){return uc(e.Lt,t)})),s=ba.fromMillis(t.localWriteTimeMs);return new il(t.batchId,s,n,a)}function vl(e){var t,n,r=pl(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?pl(e.lastLimboFreeSnapshotVersion):_a.min();return void 0!==e.query.documents?(fa(1===(n=e.query).documents.length),t=xs(Ss(rc(n.documents[0])))):t=function(e){return xs(hc(e))}(e.query),new al(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Ra.fromBase64String(e.resumeToken))}function yl(e,t){var n,r=fl(t.snapshotVersion),i=fl(t.lastLimboFreeSnapshotVersion);n=as(t.target)?cc(e.Lt,t.target):lc(e.Lt,t.target);var o=t.resumeToken.toBase64();return new Mc(t.targetId,is(t.target),r,o,t.sequenceNumber,i,n)}function ml(e){var t=hc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?As(t,t.limit,"L"):t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gl=function(){function e(){}return e.prototype.getBundleMetadata=function(e,t){return bl(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:pl(t.createTime),version:t.version};var t}))},e.prototype.saveBundleMetadata=function(e,t){return bl(e).put({bundleId:(n=t).id,createTime:fl(Xu(n.createTime)),version:n.version});var n},e.prototype.getNamedQuery=function(e,t){return _l(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:ml(t.bundledQuery),readTime:pl(t.readTime)};var t}))},e.prototype.saveNamedQuery=function(e,t){return _l(e).put(function(e){return{name:e.name,readTime:fl(Xu(e.readTime)),bundledQuery:e.bundledQuery}}(t))},e}();function bl(e){return rl(e,Vc.store)}function _l(e){return rl(e,qc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wl=function(){function e(){this.Bt=new Tl}return e.prototype.addToCollectionParentIndex=function(e,t){return this.Bt.add(t),zc.resolve()},e.prototype.getCollectionParents=function(e,t){return zc.resolve(this.Bt.getEntries(t))},e}(),Tl=function(){function e(){this.index={}}return e.prototype.add=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Eu(Ea.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new Eu(Ea.comparator)).toArray()},e}(),Cl=function(){function e(){this.qt=new Tl}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(!this.qt.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.qt.add(t)}));var o={collectionId:r,parent:Tc(i)};return Sl(e).put(o)}return zc.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[ga(t),""],!1,!0);return Sl(e).Nt(r).next((function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(Ec(o.parent))}return n}))},e}();function Sl(e){return rl(e,jc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var El={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Il=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kl(e,t,n){var r=e.store(Rc.store),i=e.store(Nc.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(e,t,n){return s++,n.delete()}));o.push(u.next((function(){fa(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=Nc.key(t,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return zc.waitFor(o).next((function(){return c}))}function Pl(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ha();t=e.noDocument}return JSON.stringify(t).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Il.DEFAULT_COLLECTION_PERCENTILE=10,Il.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Il.DEFAULT=new Il(41943040,Il.DEFAULT_COLLECTION_PERCENTILE,Il.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Il.DISABLED=new Il(-1,0,0);var Rl=function(){function e(e,t,n,r){this.userId=e,this.R=t,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return e.Kt=function(t,n,r,i){return fa(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xl(e).$t({index:Rc.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=Al(e),a=xl(e);return a.add({}).next((function(s){fa("number"==typeof s);for(var u=new il(s,t,n,r),c=function(e,t,n){var r=n.baseMutations.map((function(t){return sc(e.Lt,t)})),i=n.mutations.map((function(t){return sc(e.Lt,t)}));return new Rc(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Eu((function(e,t){return ya(e.canonicalString(),t.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],v=Nc.key(i.userId,d.key.path,s);h=h.add(d.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,Nc.PLACEHOLDER))}return h.forEach((function(t){l.push(i.Ut.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.Qt[s]=u.keys()})),zc.waitFor(l).next((function(){return u}))}))},e.prototype.lookupMutationBatch=function(e,t){var n=this;return xl(e).get(t).next((function(e){return e?(fa(e.userId===n.userId),dl(n.R,e)):null}))},e.prototype.jt=function(e,t){var n=this;return this.Qt[t]?zc.resolve(this.Qt[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.Qt[t]=r,r}return null}))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return xl(e).$t({index:Rc.userMutationsIndex,range:i},(function(e,t,i){t.userId===n.userId&&(fa(t.batchId>=r),o=dl(n.R,t)),i.done()})).next((function(){return o}))},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return xl(e).$t({index:Rc.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xl(e).Nt(Rc.userMutationsIndex,n).next((function(e){return e.map((function(e){return dl(t.R,e)}))}))},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=Nc.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Al(e).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=Ec(u);if(s===n.userId&&t.path.isEqual(l))return xl(e).get(c).next((function(e){if(!e)throw ha();fa(e.userId===n.userId),o.push(dl(n.R,e))}));a.done()})).next((function(){return o}))},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Eu(ya),i=[];return t.forEach((function(t){var o=Nc.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=Al(e).$t({range:a},(function(e,i,o){var a=e[0],s=e[1],u=e[2],c=Ec(s);a===n.userId&&t.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),zc.waitFor(i).next((function(){return n.Wt(e,r)}))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this,r=t.path,i=r.length+1,o=Nc.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Eu(ya);return Al(e).$t({range:a},(function(e,t,o){var a=e[0],u=e[1],c=e[2],l=Ec(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(e,s)}))},e.prototype.Wt=function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(xl(e).get(t).next((function(e){if(null===e)throw ha();fa(e.userId===n.userId),r.push(dl(n.R,e))})))})),zc.waitFor(i).next((function(){return r}))},e.prototype.removeMutationBatch=function(e,t){var n=this;return kl(e.Mt,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.Gt(t.batchId)})),zc.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))},e.prototype.Gt=function(e){delete this.Qt[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return zc.resolve();var r=IDBKeyRange.lowerBound(Nc.prefixForUser(t.userId)),i=[];return Al(e).$t({range:r},(function(e,n,r){if(e[0]===t.userId){var o=Ec(e[1]);i.push(o)}else r.done()})).next((function(){fa(0===i.length)}))}))},e.prototype.containsKey=function(e,t){return Nl(e,this.userId,t)},e.prototype.zt=function(e){var t=this;return Dl(e).get(this.userId).next((function(e){return e||new Pc(t.userId,-1,"")}))},e}();function Nl(e,t,n){var r=Nc.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Al(e).$t({range:o,kt:!0},(function(e,n,r){var o=e[0],s=e[1];e[2],o===t&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function xl(e){return rl(e,Rc.store)}function Al(e){return rl(e,Nc.store)}function Dl(e){return rl(e,Pc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ol=function(){function e(e){this.Ht=e}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),Ml=function(){function e(e,t){this.referenceDelegate=e,this.R=t}return e.prototype.allocateTargetId=function(e){var t=this;return this.Xt(e).next((function(n){var r=new Ol(n.highestTargetId);return n.highestTargetId=r.next(),t.Zt(e,n).next((function(){return n.highestTargetId}))}))},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.Xt(e).next((function(e){return _a.fromTimestamp(new ba(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},e.prototype.getHighestSequenceNumber=function(e){return this.Xt(e).next((function(e){return e.highestListenSequenceNumber}))},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.Xt(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Zt(e,i)}))},e.prototype.addTargetData=function(e,t){var n=this;return this.te(e,t).next((function(){return n.Xt(e).next((function(r){return r.targetCount+=1,n.ee(t,r),n.Zt(e,r)}))}))},e.prototype.updateTargetData=function(e,t){return this.te(e,t)},e.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return Ll(e).delete(t.targetId)})).next((function(){return n.Xt(e)})).next((function(t){return fa(t.targetCount>0),t.targetCount-=1,n.Zt(e,t)}))},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return Ll(e).$t((function(a,s){var u=vl(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(e,u)))})).next((function(){return zc.waitFor(o)})).next((function(){return i}))},e.prototype.forEachTarget=function(e,t){return Ll(e).$t((function(e,n){var r=vl(n);t(r)}))},e.prototype.Xt=function(e){return Fl(e).get(Fc.key).next((function(e){return fa(null!==e),e}))},e.prototype.Zt=function(e,t){return Fl(e).put(Fc.key,t)},e.prototype.te=function(e,t){return Ll(e).put(yl(this.R,t))},e.prototype.ee=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getTargetCount=function(e){return this.Xt(e).next((function(e){return e.targetCount}))},e.prototype.getTargetData=function(e,t){var n=is(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ll(e).$t({range:r,index:Mc.queryTargetsIndexName},(function(e,n,r){var o=vl(n);os(t,o.target)&&(i=o,r.done())})).next((function(){return i}))},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=jl(e);return t.forEach((function(t){var a=Tc(t.path);i.push(o.put(new Lc(n,a))),i.push(r.referenceDelegate.addReference(e,n,t))})),zc.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=jl(e);return zc.forEach(t,(function(t){var o=Tc(t.path);return zc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,n,t)])}))},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=jl(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=jl(e),i=Du();return r.$t({range:n,kt:!0},(function(e,t,n){var r=Ec(e[1]),o=new Ua(r);i=i.add(o)})).next((function(){return i}))},e.prototype.containsKey=function(e,t){var n=Tc(t.path),r=IDBKeyRange.bound([n],[ga(n)],!1,!0),i=0;return jl(e).$t({index:Lc.documentTargetsIndex,kt:!0,range:r},(function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},e.prototype.lt=function(e,t){return Ll(e).get(t).next((function(e){return e?vl(e):null}))},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ll(e){return rl(e,Mc.store)}function Fl(e){return rl(e,Fc.store)}function jl(e){return rl(e,Lc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ul(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){if(e.code!==ra.FAILED_PRECONDITION||e.message!==Gc)throw e;return sa("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vl(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=ya(n,i);return 0===a?ya(r,o):a}var ql=function(){function e(e){this.ne=e,this.buffer=new Eu(Vl),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(e){var t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Vl(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),Bl=function(){function e(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}return e.prototype.start=function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(e)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),e.prototype.ue=function(e){var t=this,n=this.oe?3e5:6e4;sa("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Zo(t,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,e.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Xc(t=n.sent())?(sa("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,Ul(t)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(e)];case 8:return n.sent(),[2]}}))}))}))},e}(),Gl=function(){function e(e,t){this.ae=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.ae.he(e).next((function(e){return Math.floor(t/100*e)}))},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return zc.resolve(na.o);var r=new ql(t);return this.ae.forEachTarget(e,(function(e){return r.re(e.sequenceNumber)})).next((function(){return n.ae.le(e,(function(e){return r.re(e)}))})).next((function(){return r.maxValue}))},e.prototype.removeTargets=function(e,t,n){return this.ae.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.ae.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(sa("LruGarbageCollector","Garbage collection skipped; disabled"),zc.resolve(El)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(sa("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),El):n.fe(e,t)}))},e.prototype.getCacheSize=function(e){return this.ae.getCacheSize(e)},e.prototype.fe=function(e,t){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(sa("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),r=c.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),aa()<=yt.DEBUG&&sa("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),zc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))},e}(),Kl=function(){function e(e,t){this.db=e,this.garbageCollector=function(e,t){return new Gl(e,t)}(this,t)}return e.prototype.he=function(e){var t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.de=function(e){var t=0;return this.le(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.le=function(e,t){return this.we(e,(function(e,n){return t(n)}))},e.prototype.addReference=function(e,t,n){return Wl(e,n)},e.prototype.removeReference=function(e,t,n){return Wl(e,n)},e.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},e.prototype.markPotentiallyOrphaned=function(e,t){return Wl(e,t)},e.prototype._e=function(e,t){return function(e,t){var n=!1;return Dl(e).Ot((function(r){return Nl(e,r,t).next((function(e){return e&&(n=!0),zc.resolve(!e)}))})).next((function(){return n}))}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(e,(function(a,s){if(s<=t){var u=n._e(e,a).next((function(t){if(!t)return o++,r.getEntry(e,a).next((function(){return r.removeEntry(a),jl(e).delete([0,Tc(a.path)])}))}));i.push(u)}})).next((function(){return zc.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return o}))},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},e.prototype.updateLimboDocument=function(e,t){return Wl(e,t)},e.prototype.we=function(e,t){var n,r=jl(e),i=na.o;return r.$t({index:Lc.documentTargetsIndex},(function(e,r){var o=e[0],a=(e[1],r.path),s=r.sequenceNumber;0===o?(i!==na.o&&t(new Ua(Ec(n)),i),i=s,n=a):i=na.o})).next((function(){i!==na.o&&t(new Ua(Ec(n)),i)}))},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function Wl(e,t){return jl(e).put(function(e,t){return new Lc(0,Tc(e.path),t)}(t,e.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zl=function(){function e(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){Ta(this.inner,(function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];e(a,s)}}))},e.prototype.isEmpty=function(){return Ca(this.inner)},e}(),Hl=function(){function e(){this.changes=new zl((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?t.readTime:_a.min()},e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})},e.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{document:ts.newInvalidDocument(e),readTime:t})},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?zc.resolve(n.document):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){},e}(),Ql=function(){function e(e,t){this.R=e,this.Ut=t}return e.prototype.addEntry=function(e,t,n){return Xl(e).put(Jl(t),n)},e.prototype.removeEntry=function(e,t){var n=Xl(e),r=Jl(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.me(e,r)}))},e.prototype.getEntry=function(e,t){var n=this;return Xl(e).get(Jl(t)).next((function(e){return n.ye(t,e)}))},e.prototype.ge=function(e,t){var n=this;return Xl(e).get(Jl(t)).next((function(e){return{document:n.ye(t,e),size:Pl(e)}}))},e.prototype.getEntries=function(e,t){var n=this,r=Pu();return this.pe(e,t,(function(e,t){var i=n.ye(e,t);r=r.insert(e,i)})).next((function(){return r}))},e.prototype.Ee=function(e,t){var n=this,r=Pu(),i=new Tu(Ua.comparator);return this.pe(e,t,(function(e,t){var o=n.ye(e,t);r=r.insert(e,o),i=i.insert(e,Pl(t))})).next((function(){return{documents:r,Te:i}}))},e.prototype.pe=function(e,t,n){if(t.isEmpty())return zc.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return Xl(e).$t({range:r},(function(e,t,r){for(var a=Ua.fromSegments(e);o&&Ua.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this,i=Pu(),o=t.path.length+1,a={};if(n.isEqual(_a.min())){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),c=ll(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Dc.collectionReadTimeIndex}return Xl(e).$t(a,(function(e,n,a){if(e.length===o){var s=ul(r.R,n);t.path.isPrefixOf(s.key.path)?Ls(t,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},e.prototype.newChangeBuffer=function(e){return new $l(this,!!e&&e.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},e.prototype.getMetadata=function(e){return Yl(e).get(Oc.key).next((function(e){return fa(!!e),e}))},e.prototype.me=function(e,t){return Yl(e).put(Oc.key,t)},e.prototype.ye=function(e,t){if(t){var n=ul(this.R,t);if(!n.isNoDocument()||!n.version.isEqual(_a.min()))return n}return ts.newInvalidDocument(e)},e}(),$l=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Ie=t,r.trackRemovals=n,r.Ae=new zl((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),r}return Jo(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new Eu((function(e,t){return ya(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(o,a){var s=t.Ae.get(o);if(a.document.isValidDocument()){var u=cl(t.Ie.R,a.document,t.getReadTime(o));i=i.add(o.path.popLast());var c=Pl(u);r+=c-s,n.push(t.Ie.addEntry(e,o,u))}else if(r-=s,t.trackRemovals){var l=cl(t.Ie.R,ts.newNoDocument(o,_a.min()),t.getReadTime(o));n.push(t.Ie.addEntry(e,o,l))}else n.push(t.Ie.removeEntry(e,o))})),i.forEach((function(r){n.push(t.Ie.Ut.addToCollectionParentIndex(e,r))})),n.push(this.Ie.updateMetadata(e,r)),zc.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.Ie.ge(e,t).next((function(e){return n.Ae.set(t,e.size),e.document}))},t.prototype.getAllFromCache=function(e,t){var n=this;return this.Ie.Ee(e,t).next((function(e){var t=e.documents;return e.Te.forEach((function(e,t){n.Ae.set(e,t)})),t}))},t}(Hl);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yl(e){return rl(e,Oc.store)}function Xl(e){return rl(e,Dc.store)}function Jl(e){return e.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Zl=function(){function e(e){this.R=e}return e.prototype.Rt=function(e,t,n,r){var i=this;fa(n<r&&n>=0&&r<=11);var o=new Hc("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(kc.store)}(e),function(e){e.createObjectStore(Pc.store,{keyPath:Pc.keyPath}),e.createObjectStore(Rc.store,{keyPath:Rc.keyPath,autoIncrement:!0}).createIndex(Rc.userMutationsIndex,Rc.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Nc.store)}(e),eh(e),function(e){e.createObjectStore(Dc.store)}(e));var a=zc.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Lc.store),e.deleteObjectStore(Mc.store),e.deleteObjectStore(Fc.store)}(e),eh(e)),a=a.next((function(){return function(e){var t=e.store(Fc.store),n=new Fc(0,0,_a.min().toTimestamp(),0);return t.put(Fc.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(e,t){return t.store(Rc.store).Nt().next((function(n){e.deleteObjectStore(Rc.store),e.createObjectStore(Rc.store,{keyPath:Rc.keyPath,autoIncrement:!0}).createIndex(Rc.userMutationsIndex,Rc.userMutationsKeyPath,{unique:!0});var r=t.store(Rc.store),i=n.map((function(e){return r.put(e)}));return zc.waitFor(i)}))}(e,o)}))),a=a.next((function(){!function(e){e.createObjectStore(Uc.store,{keyPath:Uc.keyPath})}(e)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(e){e.createObjectStore(Oc.store)}(e),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(e,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(Dc.store);t.createIndex(Dc.readTimeIndex,Dc.readTimeIndexPath,{unique:!1}),t.createIndex(Dc.collectionReadTimeIndex,Dc.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(e){e.createObjectStore(Vc.store,{keyPath:Vc.keyPath})}(e),function(e){e.createObjectStore(qc.store,{keyPath:qc.keyPath})}(e)}))),a},e.prototype.be=function(e){var t=0;return e.store(Dc.store).$t((function(e,n){t+=Pl(n)})).next((function(){var n=new Oc(t);return e.store(Oc.store).put(Oc.key,n)}))},e.prototype.Re=function(e){var t=this,n=e.store(Pc.store),r=e.store(Rc.store);return n.Nt().next((function(n){return zc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Rc.userMutationsIndex,i).next((function(r){return zc.forEach(r,(function(r){fa(r.userId===n.userId);var i=dl(t.R,r);return kl(e,n.userId,i).next((function(){}))}))}))}))}))},e.prototype.ve=function(e){var t=e.store(Lc.store),n=e.store(Dc.store);return e.store(Fc.store).get(Fc.key).next((function(e){var r=[];return n.$t((function(n,i){var o=new Ea(n),a=function(e){return[0,Tc(e)]}(o);r.push(t.get(a).next((function(n){return n?zc.resolve():function(n){return t.put(new Lc(0,Tc(n),e.highestListenSequenceNumber))}(o)})))})).next((function(){return zc.waitFor(r)}))}))},e.prototype.Pe=function(e,t){e.createObjectStore(jc.store,{keyPath:jc.keyPath});var n=t.store(jc.store),r=new Tl,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Tc(i)})}};return t.store(Dc.store).$t({kt:!0},(function(e,t){var n=new Ea(e);return i(n.popLast())})).next((function(){return t.store(Nc.store).$t({kt:!0},(function(e,t){e[0];var n=e[1],r=(e[2],Ec(n));return i(r.popLast())}))}))},e.prototype.Ve=function(e){var t=this,n=e.store(Mc.store);return n.$t((function(e,r){var i=vl(r),o=yl(t.R,i);return n.put(o)}))},e}();function eh(e){e.createObjectStore(Lc.store,{keyPath:Lc.keyPath}).createIndex(Lc.documentTargetsIndex,Lc.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Mc.store,{keyPath:Mc.keyPath}).createIndex(Mc.queryTargetsIndexName,Mc.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Fc.store)}var th="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nh=function(){function e(t,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(e){return Promise.resolve()},!e.yt())throw new ia(ra.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Kl(this,i),this.Le=n+"main",this.R=new sl(u),this.Be=new Qc(this.Le,11,new Zl(this.R)),this.qe=new Ml(this.referenceDelegate,this.R),this.Ut=new Cl,this.Ue=function(e,t){return new Ql(e,t)}(this.R,this.Ut),this.Qe=new gl,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===l&&ua("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var e=this;return this.je().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new ia(ra.FAILED_PRECONDITION,th);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.qe.getHighestSequenceNumber(t)}))})).then((function(t){e.Ne=new na(t,e.De)})).then((function(){e.xe=!0})).catch((function(t){return e.Be&&e.Be.close(),Promise.reject(t)}))},e.prototype.He=function(e){var t=this;return this.Me=function(n){return Zo(t,void 0,void 0,(function(){return ea(this,(function(t){return this.started?[2,e(n)]:[2]}))}))},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.Be.vt((function(n){return Zo(t,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return null===n.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget((function(){return Zo(t,void 0,void 0,(function(){return ea(this,(function(e){switch(e.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},e.prototype.je=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return ih(t).put(new Uc(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next((function(){if(e.isPrimary)return e.Je(t).next((function(t){t||(e.isPrimary=!1,e.Se.enqueueRetryable((function(){return e.Me(!1)})))}))})).next((function(){return e.Ye(t)})).next((function(n){return e.isPrimary&&!n?e.Xe(t).next((function(){return!1})):!!n&&e.Ze(t).next((function(){return!0}))}))})).catch((function(t){if(Xc(t))return sa("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return sa("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.Se.enqueueRetryable((function(){return e.Me(t)})),e.isPrimary=t}))},e.prototype.Je=function(e){var t=this;return rh(e).get(kc.key).next((function(e){return zc.resolve(t.tn(e))}))},e.prototype.en=function(e){return ih(e).delete(this.clientId)},e.prototype.nn=function(){return Zo(this,void 0,void 0,(function(){var e,t,n,r,i=this;return ea(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=rl(e,Uc.store);return t.Nt().next((function(e){var n=i.rn(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return zc.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Ke)for(t=0,n=e;t<n.length;t++)r=n[t],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},e.prototype.ze=function(){var e=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.je().then((function(){return e.nn()})).then((function(){return e.ze()}))}))},e.prototype.tn=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.Ye=function(e){var t=this;return this.Ce?zc.resolve(!0):rh(e).get(kc.key).next((function(n){if(null!==n&&t.sn(n.leaseTimestampMs,5e3)&&!t.cn(n.ownerId)){if(t.tn(n)&&t.networkEnabled)return!0;if(!t.tn(n)){if(!n.allowTabSynchronization)throw new ia(ra.FAILED_PRECONDITION,th);return!1}}return!(!t.networkEnabled||!t.inForeground)||ih(e).Nt().next((function(e){return void 0===t.rn(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&sa("IndexedDbPersistence","Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},e.prototype.shutdown=function(){return Zo(this,void 0,void 0,(function(){var e=this;return ea(this,(function(t){switch(t.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[kc.store,Uc.store],(function(t){var n=new nl(t,na.o);return e.Xe(n).next((function(){return e.en(n)}))}))];case 1:return t.sent(),this.Be.close(),this.ln(),[2]}}))}))},e.prototype.rn=function(e,t){var n=this;return e.filter((function(e){return n.sn(e.updateTimeMs,t)&&!n.cn(e.clientId)}))},e.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return ih(t).Nt().next((function(t){return e.rn(t,18e5).map((function(e){return e.clientId}))}))}))},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(e){return Rl.Kt(e,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Qe},e.prototype.runTransaction=function(e,t,n){var r=this;sa("IndexedDbPersistence","Starting transaction:",e);var i,o="readonly"===t?"readonly":"readwrite";return this.Be.runTransaction(e,o,Bc,(function(o){return i=new nl(o,r.Ne?r.Ne.next():na.o),"readwrite-primary"===t?r.Je(i).next((function(e){return!!e||r.Ye(i)})).next((function(t){if(!t)throw ua("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new ia(ra.FAILED_PRECONDITION,Gc);return n(i)})).next((function(e){return r.Ze(i).next((function(){return e}))})):r.dn(i).next((function(){return n(i)}))})).then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.dn=function(e){var t=this;return rh(e).get(kc.key).next((function(e){if(null!==e&&t.sn(e.leaseTimestampMs,5e3)&&!t.cn(e.ownerId)&&!t.tn(e)&&!(t.Ce||t.allowTabSynchronization&&e.allowTabSynchronization))throw new ia(ra.FAILED_PRECONDITION,th)}))},e.prototype.Ze=function(e){var t=new kc(this.clientId,this.allowTabSynchronization,Date.now());return rh(e).put(kc.key,t)},e.yt=function(){return Qc.yt()},e.prototype.Xe=function(e){var t=this,n=rh(e);return n.get(kc.key).next((function(e){return t.tn(e)?(sa("IndexedDbPersistence","Releasing primary lease."),n.delete(kc.key)):zc.resolve()}))},e.prototype.sn=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(ua("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.We=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){e.Se.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},e.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},e.prototype.Ge=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Fe=function(){t.un(),t.Se.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},e.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},e.prototype.cn=function(e){var t;try{var n=null!==(null===(t=this.Ke)||void 0===t?void 0:t.getItem(this.on(e)));return sa("IndexedDbPersistence","Client '"+e+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(e){return ua("IndexedDbPersistence","Failed to get zombied client id.",e),!1}},e.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(e){ua("Failed to set zombie client id.",e)}},e.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(e){}},e.prototype.on=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e}();function rh(e){return rl(e,kc.store)}function ih(e){return rl(e,Uc.store)}function oh(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var ah=function(){function e(e,t,n){this.Ue=e,this._n=t,this.Ut=n}return e.prototype.mn=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.yn(e,t,r)}))},e.prototype.yn=function(e,t,n){return this.Ue.getEntry(e,t).next((function(e){for(var t=0,r=n;t<r.length;t++)r[t].applyToLocalView(e);return e}))},e.prototype.gn=function(e,t){e.forEach((function(e,n){for(var r=0,i=t;r<i.length;r++)i[r].applyToLocalView(n)}))},e.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next((function(t){return n.En(e,t).next((function(){return t}))}))},e.prototype.En=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){return n.gn(t,e)}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return function(e){return Ua.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):Rs(t)?this.In(e,t,n):this.An(e,t,n)},e.prototype.Tn=function(e,t){return this.mn(e,new Ua(t)).next((function(e){var t=Nu();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))},e.prototype.In=function(e,t,n){var r=this,i=t.collectionGroup,o=Nu();return this.Ut.getCollectionParents(e,i).next((function(a){return zc.forEach(a,(function(a){var s=function(e,t){return new Ts(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return r.An(e,s,n).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))},e.prototype.An=function(e,t,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(e,t,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(e,t)})).next((function(t){return i=t,o.Rn(e,i,r).next((function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=ts.newInvalidDocument(c),r=r.insert(c,l)),au(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(e,n){Ls(t,n)||(r=r.remove(e))})),r}))},e.prototype.Rn=function(e,t,n){for(var r=Du(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof hu&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(e,r).next((function(e){return e.forEach((function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))})),c}))},e}(),sh=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.bn=n,this.vn=r}return e.Pn=function(t,n){for(var r=Du(),i=Du(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),uh=function(){function e(){}return e.prototype.Vn=function(e){this.Sn=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(_a.min())?this.Dn(e,t):this.Sn.pn(e,r).next((function(o){var a=i.Cn(t,o);return(Es(t)||Is(t))&&i.Nn(t.limitType,a,r,n)?i.Dn(e,t):(aa()<=yt.DEBUG&&sa("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ms(t)),i.Sn.getDocumentsMatchingQuery(e,t,n).next((function(e){return a.forEach((function(t){e=e.insert(t.key,t)})),e})))}))},e.prototype.Cn=function(e,t){var n=new Eu(Fs(e));return t.forEach((function(t,r){Ls(e,r)&&(n=n.add(r))})),n},e.prototype.Nn=function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},e.prototype.Dn=function(e,t){return aa()<=yt.DEBUG&&sa("QueryEngine","Using full collection scan to execute query:",Ms(t)),this.Sn.getDocumentsMatchingQuery(e,t,_a.min())},e}(),ch=function(){function e(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.Fn=new Tu(ya),this.kn=new zl((function(e){return is(e)}),os),this.$n=_a.min(),this._n=e.getMutationQueue(n),this.On=e.getRemoteDocumentCache(),this.qe=e.getTargetCache(),this.Mn=new ah(this.On,this._n,this.persistence.getIndexManager()),this.Qe=e.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Fn)}))},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lh(e,t,n,r){return new ch(e,t,n,r)}function hh(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o;return ea(this,(function(a){switch(a.label){case 0:return n=pa(e),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(e){var o;return n._n.getAllMutationBatches(e).next((function(a){return o=a,r=n.persistence.getMutationQueue(t),i=new ah(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)})).next((function(t){for(var n=[],r=[],a=Du(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];a=a.add(g.key)}}return i.pn(e,a).next((function(e){return{Ln:e,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function fh(e,t){var n=pa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,o=i.keys(),a=zc.resolve();return o.forEach((function(e){a=a.next((function(){return r.getEntry(t,e)})).next((function(t){var o=n.docVersions.get(e);fa(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),a.next((function(){return e._n.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n._n.performConsistencyCheck(e)})).next((function(){return n.Mn.pn(e,r)}))}))}function ph(e){var t=pa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.qe.getLastRemoteSnapshotVersion(e)}))}function dh(e,t){var n=pa(e),r=t.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];t.targetChanges.forEach((function(t,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(e,t.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(e,t.addedDocuments,o)})));var u=t.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(o,c),function(e,t,n){return fa(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,t)&&a.push(n.qe.updateTargetData(e,c))}}}));var s=Pu();if(t.documentUpdates.forEach((function(r,i){t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),a.push(function(e,t,n,r,i){var o=Du();return n.forEach((function(e){return o=o.add(e)})),t.getEntries(e,o).next((function(e){var o=Pu();return n.forEach((function(n,a){var s=e.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(_a.min())?(t.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a,u),o=o.insert(n,a)):sa("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}(e,o,t.documentUpdates,r,void 0).next((function(e){s=e}))),!r.isEqual(_a.min())){var u=n.qe.getLastRemoteSnapshotVersion(e).next((function(t){return n.qe.setTargetsMetadata(e,e.currentSequenceNumber,r)}));a.push(u)}return zc.waitFor(a).next((function(){return o.apply(e)})).next((function(){return n.Mn.En(e,s)})).next((function(){return s}))})).then((function(e){return n.Fn=i,e}))}function vh(e,t){var n=pa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t)}))}function yh(e,t){var n=pa(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.qe.getTargetData(e,t).next((function(i){return i?(r=i,zc.resolve(r)):n.qe.allocateTargetId(e).next((function(i){return r=new al(t,i,0,e.currentSequenceNumber),n.qe.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Fn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(e.targetId,e),n.kn.set(t,e.targetId)),e}))}function mh(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a;return ea(this,(function(s){switch(s.label){case 0:r=pa(e),i=r.Fn.get(t),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(e){return r.persistence.referenceDelegate.removeTarget(e,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Xc(a=s.sent()))throw a;return sa("LocalStore","Failed to update sequence numbers for target "+t+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(t),r.kn.delete(i.target),[2]}}))}))}function gh(e,t,n){var r=pa(e),i=_a.min(),o=Du();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=pa(e),i=r.kn.get(n);return void 0!==i?zc.resolve(r.Fn.get(i)):r.qe.getTargetData(t,n)}(r,e,xs(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(e,t.targetId).next((function(e){o=e}))})).next((function(){return r.xn.getDocumentsMatchingQuery(e,t,n?i:_a.min(),n?o:Du())})).next((function(e){return{documents:e,Bn:o}}))}))}function bh(e,t){var n=pa(e),r=pa(n.qe),i=n.Fn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.lt(e,t).next((function(e){return e?e.target:null}))}))}function _h(e){var t=pa(e);return t.persistence.runTransaction("Get new document changes","readonly",(function(e){return function(e,t,n){var r=pa(e),i=Pu(),o=ll(n),a=Xl(t),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:Dc.readTimeIndex,range:s},(function(e,t){var n=ul(r.R,t);i=i.insert(n.key,n),o=t.readTime})).next((function(){return{wn:i,readTime:hl(o)}}))}(t.On,e,t.$n)})).then((function(e){var n=e.wn,r=e.readTime;return t.$n=r,n}))}function wh(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){return[2,(t=pa(e)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(e){return function(e){var t=Xl(e),n=_a.min();return t.$t({index:Dc.readTimeIndex,reverse:!0},(function(e,t,r){t.readTime&&(n=hl(t.readTime)),r.done()})).next((function(){return n}))}(e)})).then((function(e){t.$n=e}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Th=function(){function e(e){this.R=e,this.Kn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(e,t){return zc.resolve(this.Kn.get(t))},e.prototype.saveBundleMetadata=function(e,t){var n;return this.Kn.set(t.id,{id:(n=t).id,version:n.version,createTime:Xu(n.createTime)}),zc.resolve()},e.prototype.getNamedQuery=function(e,t){return zc.resolve(this.jn.get(t))},e.prototype.saveNamedQuery=function(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:ml(e.bundledQuery),readTime:Xu(e.readTime)}}(t)),zc.resolve()},e}(),Ch=function(){function e(){this.Wn=new Eu(Sh.Gn),this.zn=new Eu(Sh.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(e,t){var n=new Sh(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},e.prototype.Jn=function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))},e.prototype.removeReference=function(e,t){this.Yn(new Sh(e,t))},e.prototype.Xn=function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))},e.prototype.Zn=function(e){var t=this,n=new Ua(new Ea([])),r=new Sh(n,e),i=new Sh(n,e+1),o=[];return this.zn.forEachInRange([r,i],(function(e){t.Yn(e),o.push(e.key)})),o},e.prototype.ts=function(){var e=this;this.Wn.forEach((function(t){return e.Yn(t)}))},e.prototype.Yn=function(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)},e.prototype.es=function(e){var t=new Ua(new Ea([])),n=new Sh(t,e),r=new Sh(t,e+1),i=Du();return this.zn.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i},e.prototype.containsKey=function(e){var t=new Sh(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),Sh=function(){function e(e,t){this.key=e,this.ns=t}return e.Gn=function(e,t){return Ua.comparator(e.key,t.key)||ya(e.ns,t.ns)},e.Hn=function(e,t){return ya(e.ns,t.ns)||Ua.comparator(e.key,t.key)},e}(),Eh=function(){function e(e,t){this.Ut=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new Eu(Sh.Gn)}return e.prototype.checkEmpty=function(e){return zc.resolve(0===this._n.length)},e.prototype.addMutationBatch=function(e,t,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new il(i,t,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Sh(u.key,i)),this.Ut.addToCollectionParentIndex(e,u.key.path.popLast())}return zc.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return zc.resolve(this.os(t))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=t+1,r=this.cs(n),i=r<0?0:r;return zc.resolve(this._n.length>i?this._n[i]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return zc.resolve(0===this._n.length?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(e){return zc.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new Sh(t,0),i=new Sh(t,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(e){var t=n.os(e.ns);o.push(t)})),zc.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Eu(ya);return t.forEach((function(e){var t=new Sh(e,0),i=new Sh(e,Number.POSITIVE_INFINITY);n.rs.forEachInRange([t,i],(function(e){r=r.add(e.ns)}))})),zc.resolve(this.us(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=t.path,r=n.length+1,i=n;Ua.isDocumentKey(i)||(i=i.child(""));var o=new Sh(new Ua(i),0),a=new Eu(ya);return this.rs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.ns)),!0)}),o),zc.resolve(this.us(a))},e.prototype.us=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.os(e);null!==r&&n.push(r)})),n},e.prototype.removeMutationBatch=function(e,t){var n=this;fa(0===this.hs(t.batchId,"removed")),this._n.shift();var r=this.rs;return zc.forEach(t.mutations,(function(i){var o=new Sh(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.rs=r}))},e.prototype.Gt=function(e){},e.prototype.containsKey=function(e,t){var n=new Sh(t,0),r=this.rs.firstAfterOrEqual(n);return zc.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return this._n.length,zc.resolve()},e.prototype.hs=function(e,t){return this.cs(e)},e.prototype.cs=function(e){return 0===this._n.length?0:e-this._n[0].batchId},e.prototype.os=function(e){var t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]},e}(),Ih=function(){function e(e,t){this.Ut=e,this.ls=t,this.docs=new Tu(Ua.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return zc.resolve(n?n.document.clone():ts.newInvalidDocument(t))},e.prototype.getEntries=function(e,t){var n=this,r=Pu();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.clone():ts.newInvalidDocument(e))})),zc.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){for(var r=Pu(),i=new Ua(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||Ls(t,c)&&(r=r.insert(c.key,c.clone()))}return zc.resolve(r)},e.prototype.fs=function(e,t){return zc.forEach(this.docs,(function(e){return t(e)}))},e.prototype.newChangeBuffer=function(e){return new kh(this)},e.prototype.getSize=function(e){return zc.resolve(this.size)},e}(),kh=function(e){function t(t){var n=this;return(n=e.call(this)||this).Ie=t,n}return Jo(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(t.Ie.addEntry(e,i.document,t.getReadTime(r))):t.Ie.removeEntry(r)})),zc.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.Ie.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.Ie.getEntries(e,t)},t}(Hl),Ph=function(){function e(e){this.persistence=e,this.ds=new zl((function(e){return is(e)}),os),this.lastRemoteSnapshotVersion=_a.min(),this.highestTargetId=0,this.ws=0,this._s=new Ch,this.targetCount=0,this.ys=Ol.Jt()}return e.prototype.forEachTarget=function(e,t){return this.ds.forEach((function(e,n){return t(n)})),zc.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return zc.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return zc.resolve(this.ws)},e.prototype.allocateTargetId=function(e){return this.highestTargetId=this.ys.next(),zc.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),zc.resolve()},e.prototype.te=function(e){this.ds.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.ys=new Ol(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return this.te(t),this.targetCount+=1,zc.resolve()},e.prototype.updateTargetData=function(e,t){return this.te(t),zc.resolve()},e.prototype.removeTargetData=function(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,zc.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),zc.waitFor(o).next((function(){return i}))},e.prototype.getTargetCount=function(e){return zc.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var n=this.ds.get(t)||null;return zc.resolve(n)},e.prototype.addMatchingKeys=function(e,t,n){return this._s.Jn(t,n),zc.resolve()},e.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),zc.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this._s.Zn(t),zc.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this._s.es(t);return zc.resolve(n)},e.prototype.containsKey=function(e,t){return zc.resolve(this._s.containsKey(t))},e}(),Rh=function(){function e(e,t){var n=this;this.gs={},this.Ne=new na(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.qe=new Ph(this),this.Ut=new wl,this.Ue=function(e,t){return new Ih(e,(function(e){return n.referenceDelegate.ps(e)}))}(this.Ut),this.R=new sl(t),this.Qe=new Th(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(e){var t=this.gs[e.toKey()];return t||(t=new Eh(this.Ut,this.referenceDelegate),this.gs[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Qe},e.prototype.runTransaction=function(e,t,n){var r=this;sa("MemoryPersistence","Starting transaction:",e);var i=new Nh(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(e){return r.referenceDelegate.Ts(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.Is=function(e,t){return zc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(e,t)}})))},e}(),Nh=function(e){function t(t){var n=this;return(n=e.call(this)||this).currentSequenceNumber=t,n}return Jo(t,e),t}(Kc),xh=function(){function e(e){this.persistence=e,this.As=new Ch,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ha()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(e,t,n){return this.As.addReference(n,t),this.vs.delete(n.toString()),zc.resolve()},e.prototype.removeReference=function(e,t,n){return this.As.removeReference(n,t),this.vs.add(n.toString()),zc.resolve()},e.prototype.markPotentiallyOrphaned=function(e,t){return this.vs.add(t.toString()),zc.resolve()},e.prototype.removeTarget=function(e,t){var n=this;this.As.Zn(t.targetId).forEach((function(e){return n.vs.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.vs.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return zc.forEach(this.vs,(function(r){var i=Ua.fromPath(r);return t.Ps(e,i).next((function(e){e||n.removeEntry(i)}))})).next((function(){return t.Rs=null,n.apply(e)}))},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.Ps(e,t).next((function(e){e?n.vs.delete(t.toString()):n.vs.add(t.toString())}))},e.prototype.ps=function(e){return 0},e.prototype.Ps=function(e,t){var n=this;return zc.or([function(){return zc.resolve(n.As.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Is(e,t)}])},e}(),Ah=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Dh(e,t){return"firestore_clients_"+e+"_"+t}function Oh(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function Mh(e,t){return"firestore_targets_"+e+"_"+t}Ah.UNAUTHENTICATED=new Ah(null),Ah.GOOGLE_CREDENTIALS=new Ah("google-credentials-uid"),Ah.FIRST_PARTY=new Ah("first-party-uid");var Lh=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}return e.Vs=function(t,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new ia(o.error.code,o.error.message)),a?new e(t,n,o.state,i):(ua("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Fh=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n}return e.Vs=function(t,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ia(i.error.code,i.error.message)),o?new e(t,i.state,r):(ua("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),jh=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.Vs=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Mu(),a=0;i&&a<r.activeTargetIds.length;++a)i=ja(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(ua("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Uh=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.Vs=function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(ua("SharedClientState","Failed to parse online state: "+t),null)},e}(),Vh=function(){function e(){this.activeTargetIds=Mu()}return e.prototype.Ds=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.Cs=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.Ss=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),qh=function(){function e(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Tu(ya),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Dh(this.persistenceKey,this.Ns),this.Ms=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Vh),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.Qs=function(e){return"firestore_bundle_loaded_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(e){return!(!e||!e.localStorage)},e.prototype.start=function(){return Zo(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l,h=this;return ea(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(e=f.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.Ns&&(i=this.getItem(Dh(this.persistenceKey,r)))&&(o=jh.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},e.prototype.writeSequenceNumber=function(e){this.setItem(this.Ms,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},e.prototype.isActiveQueryTarget=function(e){var t=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t},e.prototype.addPendingMutation=function(e){this.zs(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.zs(e,t,n),this.Hs(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Mh(this.persistenceKey,e));if(n){var r=Fh.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Ks(),t},e.prototype.removeLocalQueryTarget=function(e){this.Js.Cs(e),this.Ks()},e.prototype.isLocalQueryTarget=function(e){return this.Js.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(Mh(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,n){this.Ys(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach((function(e){r.Hs(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))},e.prototype.setOnlineState=function(e){this.Xs(e)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return sa("SharedClientState","READ",e,t),t},e.prototype.setItem=function(e,t){sa("SharedClientState","SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){sa("SharedClientState","REMOVE",e),this.storage.removeItem(e)},e.prototype.Fs=function(e){var t=this,n=e;if(n.storageArea===this.storage){if(sa("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void ua("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Zo(t,void 0,void 0,(function(){var e,t,r,i,o,a;return ea(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return e=this.ti(n.key),[2,this.ei(e,null)];if(t=this.ni(n.key,n.newValue))return[2,this.ei(t.clientId,t)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(e){var t=na.o;if(null!=e)try{var n=JSON.parse(e);fa("number"==typeof n),t=n}catch(e){ua("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==na.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},e.prototype.zs=function(e,t,n){var r=new Lh(this.currentUser,e,t,n),i=Oh(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())},e.prototype.Hs=function(e){var t=Oh(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.Xs=function(e){var t={clientId:this.Ns,onlineState:e};this.storage.setItem(this.Us,JSON.stringify(t))},e.prototype.Ys=function(e,t,n){var r=Mh(this.persistenceKey,e),i=new Fh(e,t,n);this.setItem(r,i.Ss())},e.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},e.prototype.ti=function(e){var t=this.Ls.exec(e);return t?t[1]:null},e.prototype.ni=function(e,t){var n=this.ti(e);return jh.Vs(n,t)},e.prototype.si=function(e,t){var n=this.Bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Lh.Vs(new Ah(i),r,t)},e.prototype.ri=function(e,t){var n=this.qs.exec(e),r=Number(n[1]);return Fh.Vs(r,t)},e.prototype.js=function(e){return Uh.Vs(e)},e.prototype.ii=function(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(sa("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])}))}))},e.prototype.oi=function(e){return this.syncEngine.ai(e.targetId,e.state,e.error)},e.prototype.ei=function(e,t){var n=this,r=t?this.ks.insert(e,t):this.ks.remove(e),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(e){i.has(e)||a.push(e)})),i.forEach((function(e){o.has(e)||s.push(e)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},e.prototype.Ws=function(e){this.ks.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},e.prototype.Gs=function(e){var t=Mu();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t},e}(),Bh=function(){function e(){this.li=new Vh,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.li.Ds(e),this.fi[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.fi[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.li.Cs(e)},e.prototype.isLocalQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.fi[e]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.start=function(){return this.li=new Vh,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e.prototype.notifyBundleLoaded=function(){},e}(),Gh=function(){function e(){}return e.prototype.di=function(e){},e.prototype.shutdown=function(){},e}(),Kh=function(){function e(){var e=this;this.wi=function(){return e._i()},this.mi=function(){return e.yi()},this.gi=[],this.pi()}return e.prototype.di=function(e){this.gi.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){sa("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(0)},e.prototype.yi=function(){sa("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(1)},e.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),Wh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zh=function(){function e(e){this.Ei=e.Ei,this.Ti=e.Ti}return e.prototype.Ii=function(e){this.Ai=e},e.prototype.Ri=function(e){this.bi=e},e.prototype.onMessage=function(e){this.vi=e},e.prototype.close=function(){this.Ti()},e.prototype.send=function(e){this.Ei(e)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(e){this.bi(e)},e.prototype.Si=function(e){this.vi(e)},e}(),Hh=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n.autoDetectLongPolling=t.autoDetectLongPolling,n.useFetchStreams=t.useFetchStreams,n}return Jo(t,e),t.prototype.ki=function(e,t,n,r){return new Promise((function(i,o){var a=new Yo;a.listenOnce(Ko.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case Go.NO_ERROR:var t=a.getResponseJson();sa("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Go.TIMEOUT:sa("Connection",'RPC "'+e+'" timed out'),o(new ia(ra.DEADLINE_EXCEEDED,"Request time out"));break;case Go.HTTP_ERROR:var n=a.getStatus();if(sa("Connection",'RPC "'+e+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(ra).indexOf(t)>=0?t:ra.UNKNOWN}(r.status);o(new ia(s,r.message))}else o(new ia(ra.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ia(ra.UNAVAILABLE,"Connection failed."));break;default:ha()}}finally{sa("Connection",'RPC "'+e+'" completed.')}}));var s=JSON.stringify(r);a.send(t,"POST",s,n,15)}))},t.prototype.Oi=function(e,t){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=new Ao,o=Dr(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Qo({})),this.Fi(a.initMessageHeaders,t),Me()||Fe()||Oe().indexOf("Electron/")>=0||function(){var e=Oe();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||Oe().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(a.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");sa("Connection","Creating WebChannel: "+s,a);var u=i.createWebChannel(s,a),c=!1,l=!1,h=new zh({Ei:function(e){l?sa("Connection","Not sending because WebChannel is closed:",e):(c||(sa("Connection","Opening WebChannel transport."),u.open(),c=!0),sa("Connection","WebChannel sending:",e),u.send(e))},Ti:function(){return u.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(u,$o.EventType.OPEN,(function(){l||sa("Connection","WebChannel transport opened.")})),f(u,$o.EventType.CLOSE,(function(){l||(l=!0,sa("Connection","WebChannel transport closed"),h.Vi())})),f(u,$o.EventType.ERROR,(function(e){l||(l=!0,ca("Connection","WebChannel transport errored:",e),h.Vi(new ia(ra.UNAVAILABLE,"The operation could not be completed")))})),f(u,$o.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];fa(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){sa("Connection","WebChannel received error:",i);var o=i.status,a=function(e){var t=vu[e];if(void 0!==t)return wu(t)}(o),s=i.message;void 0===a&&(a=ra.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new ia(a,s)),u.close()}else sa("Connection","WebChannel received:",n),h.Si(n)}})),f(o,Wo.STAT_EVENT,(function(e){e.stat===zo?sa("Connection","Detected buffering proxy"):e.stat===Ho&&sa("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},t}(function(){function e(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.Di=t+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);sa("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(e,i,o,n).then((function(e){return sa("RestConnection","Received: ",e),e}),(function(t){throw ca("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t}))},e.prototype.$i=function(e,t,n,r){return this.Ni(e,t,n,r)},e.prototype.Fi=function(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/8.6.8",e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},e.prototype.xi=function(e,t){var n=Wh[e];return this.Di+"/v1/"+t+":"+n},e}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qh(){return"undefined"!=typeof window?window:null}function $h(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yh(e){return new Hu(e,!0)}var Xh=function(){function e(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Ki=function(){this.qi=this.Bi},e.prototype.ji=function(e){var t=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&sa("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return t.Qi=Date.now(),e()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),Jh=function(){function e(e,t,n,r,i,o){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Xh(e,t)}return e.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.er=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this.nr()},e.prototype.stop=function(){return Zo(this,void 0,void 0,(function(){return ea(this,(function(e){switch(e.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var e=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return e.rr()})))},e.prototype.cr=function(e){this.ur(),this.stream.send(e)},e.prototype.rr=function(){return Zo(this,void 0,void 0,(function(){return ea(this,(function(e){return this.er()?[2,this.close(0)]:[2]}))}))},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(e,t){return Zo(this,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===ra.RESOURCE_EXHAUSTED?(ua(t.toString()),ua("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):t&&t.code===ra.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.ar=function(){},e.prototype.auth=function(){var e=this;this.state=1;var t=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(t){e.Yi===n&&e.lr(t)}),(function(n){t((function(){var t=new ia(ra.UNKNOWN,"Fetching auth token failed: "+n.message);return e.dr(t)}))}))},e.prototype.lr=function(e){var t=this,n=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii((function(){n((function(){return t.state=2,t.listener.Ii()}))})),this.stream.Ri((function(e){n((function(){return t.dr(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},e.prototype.nr=function(){var e=this;this.state=4,this.Zi.ji((function(){return Zo(e,void 0,void 0,(function(){return ea(this,(function(e){return this.state=0,this.start(),[2]}))}))}))},e.prototype.dr=function(e){return sa("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},e.prototype.hr=function(e){var t=this;return function(n){t.Se.enqueueAndForget((function(){return t.Yi===e?n():(sa("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},e}(),Zh=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return Jo(t,e),t.prototype.wr=function(e){return this.Hi.Oi("Listen",e)},t.prototype.onMessage=function(e){this.Zi.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ha()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.I?(fa(void 0===t||"string"==typeof t),Ra.fromBase64String(t||"")):(fa(void 0===t||t instanceof Uint8Array),Ra.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=(s=t.targetChange.cause)&&function(e){var t=void 0===e.code?ra.UNKNOWN:wu(e.code);return new ia(t,e.message||"")}(s);n=new Vu(r,i,o,a||null)}else if("documentChange"in t){t.documentChange,(r=t.documentChange).document,r.document.name,r.document.updateTime,i=tc(e,r.document.name),o=Xu(r.document.updateTime);var s=new Za({mapValue:{fields:r.document.fields}}),u=(a=ts.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new ju(u,c,a.key,a)}else if("documentDelete"in t)t.documentDelete,(r=t.documentDelete).document,i=tc(e,r.document),o=r.readTime?Xu(r.readTime):_a.min(),s=ts.newNoDocument(i,o),a=r.removedTargetIds||[],n=new ju([],a,s.key,s);else if("documentRemove"in t)t.documentRemove,(r=t.documentRemove).document,i=tc(e,r.document),o=r.removedTargetIds||[],n=new ju([],o,i,null);else{if(!("filter"in t))return ha();t.filter;var l=t.filter;l.targetId,r=l.count||0,i=new bu(r),o=l.targetId,n=new Uu(o,i)}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return _a.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?_a.min():t.readTime?Xu(t.readTime):_a.min()}(e);return this.listener._r(t,n)},t.prototype.mr=function(e){var t={};t.database=ic(this.R),t.addTarget=function(e,t){var n,r=t.target;return(n=as(r)?{documents:cc(e,r)}:{query:lc(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=$u(e,t.resumeToken):t.snapshotVersion.compareTo(_a.min())>0&&(n.readTime=Qu(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ha()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,e);n&&(t.labels=n),this.cr(t)},t.prototype.yr=function(e){var t={};t.database=ic(this.R),t.removeTarget=e,this.cr(t)},t}(Jh),ef=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return Jo(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(e){return this.Hi.Oi("Write",e)},t.prototype.onMessage=function(e){if(fa(!!e.streamToken),this.lastStreamToken=e.streamToken,this.gr){this.Zi.reset();var t=function(e,t){return e&&e.length>0?(fa(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Xu(e.updateTime):Xu(t);return n.isEqual(_a.min())&&(n=Xu(t)),new tu(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Xu(e.commitTime);return this.listener.Tr(n,t)}return fa(!e.writeResults||0===e.writeResults.length),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var e={};e.database=ic(this.R),this.cr(e)},t.prototype.Er=function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return sc(t.R,e)}))};this.cr(n)},t}(Jh),tf=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.Hi=n,i.R=r,i.Rr=!1,i}return Jo(t,e),t.prototype.br=function(){if(this.Rr)throw new ia(ra.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(e,t,n,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ra.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new ia(ra.UNKNOWN,e.toString())}))},t.prototype.$i=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(e,t,n,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ra.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new ia(ra.UNKNOWN,e.toString())}))},t.prototype.terminate=function(){this.Rr=!0},t}((function(){})),nf=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var e=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.Pr=null,e.Cr("Backend didn't respond within 10 seconds."),e.Dr("Offline"),Promise.resolve()})))},e.prototype.Nr=function(e){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+e.toString()),this.Dr("Offline")))},e.prototype.set=function(e){this.Fr(),this.vr=0,"Online"===e&&(this.Vr=!1),this.Dr(e)},e.prototype.Dr=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.Cr=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(ua(t),this.Vr=!1):sa("OnlineStateTracker",t)},e.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},e}(),rf=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(e){n.enqueueAndForget((function(){return Zo(o,void 0,void 0,(function(){return ea(this,(function(e){switch(e.label){case 0:return pf(this)?(sa("RemoteStore","Restarting streams for network reachability change."),[4,function(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return(t=pa(e)).Or.add(4),[4,af(t)];case 1:return n.sent(),t.Br.set("Unknown"),t.Or.delete(4),[4,of(t)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.Br=new nf(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function of(e){return Zo(this,void 0,void 0,(function(){var t,n;return ea(this,(function(r){switch(r.label){case 0:if(!pf(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function af(e){return Zo(this,void 0,void 0,(function(){var t,n;return ea(this,(function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function sf(e,t){var n=pa(e);n.$r.has(t.targetId)||(n.$r.set(t.targetId,t),ff(n)?hf(n):Pf(n).er()&&cf(n,t))}function uf(e,t){var n=pa(e),r=Pf(n);n.$r.delete(t),r.er()&&lf(n,t),0===n.$r.size&&(r.er()?r.ir():pf(n)&&n.Br.set("Unknown"))}function cf(e,t){e.qr.U(t.targetId),Pf(e).mr(t)}function lf(e,t){e.qr.U(t),Pf(e).yr(t)}function hf(e){e.qr=new Bu({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),Pf(e).start(),e.Br.Sr()}function ff(e){return pf(e)&&!Pf(e).tr()&&e.$r.size>0}function pf(e){return 0===pa(e).Or.size}function df(e){e.qr=void 0}function vf(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){return e.$r.forEach((function(t,n){cf(e,t)})),[2]}))}))}function yf(e,t){return Zo(this,void 0,void 0,(function(){return ea(this,(function(n){return df(e),ff(e)?(e.Br.Nr(t),hf(e)):e.Br.set("Unknown"),[2]}))}))}function mf(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o;return ea(this,(function(a){switch(a.label){case 0:if(e.Br.set("Online"),!(t instanceof Vu&&2===t.state&&t.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o;return ea(this,(function(a){switch(a.label){case 0:n=t.cause,r=0,i=t.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],e.$r.has(o)?[4,e.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),e.$r.delete(o),e.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(e,t)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),sa("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,gf(e,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof ju?e.qr.X(t):t instanceof Uu?e.qr.rt(t):e.qr.et(t),n.isEqual(_a.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,ph(e.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(e,t){var n=e.qr.ut(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.$r.get(r);i&&e.$r.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.$r.get(t);if(n){e.$r.set(t,n.withResumeToken(Ra.EMPTY_BYTE_STRING,n.snapshotVersion)),lf(e,t);var r=new al(n.target,t,1,n.sequenceNumber);cf(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return sa("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,gf(e,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function gf(e,t,n){return Zo(this,void 0,void 0,(function(){var r=this;return ea(this,(function(i){switch(i.label){case 0:if(!Xc(t))throw t;return e.Or.add(1),[4,af(e)];case 1:return i.sent(),e.Br.set("Offline"),n||(n=function(){return ph(e.localStore)}),e.asyncQueue.enqueueRetryable((function(){return Zo(r,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return sa("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return t.sent(),e.Or.delete(1),[4,of(e)];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))}function bf(e,t){return t().catch((function(n){return gf(e,n,t)}))}function _f(e){return Zo(this,void 0,void 0,(function(){var t,n,r,i,o;return ea(this,(function(a){switch(a.label){case 0:t=pa(e),n=Rf(t),r=t.kr.length>0?t.kr[t.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(e){return pf(e)&&e.kr.length<10}(t))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,vh(t.localStore,r)];case 3:return null===(i=a.sent())?(0===t.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(e,t){e.kr.push(t);var n=Rf(e);n.er()&&n.pr&&n.Er(t.mutations)}(t,i),[3,6]);case 4:return o=a.sent(),[4,gf(t,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return wf(t)&&Tf(t),[2]}}))}))}function wf(e){return pf(e)&&!Rf(e).tr()&&e.kr.length>0}function Tf(e){Rf(e).start()}function Cf(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){return Rf(e).Ar(),[2]}))}))}function Sf(e){return Zo(this,void 0,void 0,(function(){var t,n,r,i;return ea(this,(function(o){for(t=Rf(e),n=0,r=e.kr;n<r.length;n++)i=r[n],t.Er(i.mutations);return[2]}))}))}function Ef(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i;return ea(this,(function(o){switch(o.label){case 0:return r=e.kr.shift(),i=ol.from(r,t,n),[4,bf(e,(function(){return e.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,_f(e)];case 2:return o.sent(),[2]}}))}))}function If(e,t){return Zo(this,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return t&&Rf(e).pr?[4,function(e,t){return Zo(this,void 0,void 0,(function(){var n,r;return ea(this,(function(i){switch(i.label){case 0:return _u(r=t.code)&&r!==ra.ABORTED?(n=e.kr.shift(),Rf(e).sr(),[4,bf(e,(function(){return e.remoteSyncer.rejectFailedWrite(n.batchId,t)}))]):[3,3];case 1:return i.sent(),[4,_f(e)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return wf(e)&&Tf(e),[2]}}))}))}function kf(e,t){return Zo(this,void 0,void 0,(function(){var n;return ea(this,(function(r){switch(r.label){case 0:return n=pa(e),t?(n.Or.delete(2),[4,of(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Or.add(2),[4,af(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Pf(e){var t=this;return e.Ur||(e.Ur=function(e,t,n){var r=pa(e);return r.br(),new Zh(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:vf.bind(null,e),Ri:yf.bind(null,e),_r:mf.bind(null,e)}),e.Mr.push((function(n){return Zo(t,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return n?(e.Ur.sr(),ff(e)?hf(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:t.sent(),df(e),t.label=3;case 3:return[2]}}))}))}))),e.Ur}function Rf(e){var t=this;return e.Qr||(e.Qr=function(e,t,n){var r=pa(e);return r.br(),new ef(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:Cf.bind(null,e),Ri:If.bind(null,e),Ir:Sf.bind(null,e),Tr:Ef.bind(null,e)}),e.Mr.push((function(n){return Zo(t,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return n?(e.Qr.sr(),[4,_f(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.Qr.stop()];case 3:t.sent(),e.kr.length>0&&(sa("RemoteStore","Stopping write stream with "+e.kr.length+" pending writes"),e.kr=[]),t.label=4;case 4:return[2]}}))}))}))),e.Qr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Nf=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Wc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ia(ra.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function xf(e,t){if(ua("AsyncQueue",t+": "+e),Xc(e))return new ia(ra.UNAVAILABLE,t+": "+e);throw e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Af=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||Ua.comparator(t.key,n.key)}:function(e,t){return Ua.comparator(e.key,t.key)},this.keyedMap=Nu(),this.sortedSet=new Tu(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),Df=function(){function e(){this.Kr=new Tu(Ua.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.Kr.get(t);n?0!==e.type&&3===n.type?this.Kr=this.Kr.insert(t,e):3===e.type&&1!==n.type?this.Kr=this.Kr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Kr=this.Kr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Kr=this.Kr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Kr=this.Kr.remove(t):1===e.type&&2===n.type?this.Kr=this.Kr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Kr=this.Kr.insert(t,{type:2,doc:e.doc}):ha():this.Kr=this.Kr.insert(t,e)},e.prototype.jr=function(){var e=[];return this.Kr.inorderTraversal((function(t,n){e.push(n)})),e},e}(),Of=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Af.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ds(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),Mf=function(){this.Wr=void 0,this.listeners=[]},Lf=function(){this.queries=new zl((function(e){return Os(e)}),Ds),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ff(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return ea(this,(function(c){switch(c.label){case 0:if(n=pa(e),r=t.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Mf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=xf(s,"Initialization of query '"+Ms(t.query)+"' failed"),[2,void t.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.zr(n.onlineState),o.Wr&&t.Hr(o.Wr)&&qf(n),[2]}}))}))}function jf(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a;return ea(this,(function(s){return n=pa(e),r=t.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(t))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Uf(e,t){for(var n=pa(e),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(a)&&(r=!0);u.Wr=a}}r&&qf(n)}function Vf(e,t,n){var r=pa(e),i=r.queries.get(t);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(t)}function qf(e){e.Gr.forEach((function(e){e.next()}))}var Bf=function(){function e(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return e.prototype.Hr=function(e){if(!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new Of(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),o=!0):this.eo(e,this.onlineState)&&(this.no(e),o=!0),this.Xr=e,o},e.prototype.onError=function(e){this.Jr.error(e)},e.prototype.zr=function(e){this.onlineState=e;var t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t},e.prototype.eo=function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.so&&n||e.docs.isEmpty()&&"Offline"!==t)},e.prototype.Zr=function(e){if(e.docChanges.length>0)return!0;var t=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},e.prototype.no=function(e){e=Of.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)},e}(),Gf=function(e){this.key=e},Kf=function(e){this.key=e},Wf=function(){function e(e,t){this.query=e,this.uo=t,this.ao=null,this.current=!1,this.ho=Du(),this.mutatedKeys=Du(),this.lo=Fs(e),this.fo=new Af(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(e,t){var n=this,r=t?t.mo:new Df,i=t?t.fo:this.fo,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Es(this.query)&&i.size===this.query.limit?i.last():null,c=Is(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=Ls(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data.isEqual(h.data)?f!==p&&(r.track({type:3,doc:h}),d=!0):n.yo(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(s=!0)),d&&(h?(a=a.add(h),o=p?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))})),Es(this.query)||Is(this.query))for(;a.size>this.query.limit;){var l=Es(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},e.prototype.yo=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this,i=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;var o=e.mo.jr();o.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ha()}};return n(e)-n(t)}(e.type,t.type)||r.lo(e.doc,t.doc)})),this.po(n);var a=t?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new Of(this.query,e.fo,i,o,e.mutatedKeys,0===s,u,!1),To:a}:{To:a}},e.prototype.zr=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Df,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations},e.prototype.po=function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.uo=t.uo.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.uo=t.uo.delete(e)})),this.current=e.current)},e.prototype.Eo=function(){var e=this;if(!this.current)return[];var t=this.ho;this.ho=Du(),this.fo.forEach((function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))}));var n=[];return t.forEach((function(t){e.ho.has(t)||n.push(new Kf(t))})),this.ho.forEach((function(e){t.has(e)||n.push(new Gf(e))})),n},e.prototype.Ao=function(e){this.uo=e.Bn,this.ho=Du();var t=this._o(e.documents);return this.applyChanges(t,!0)},e.prototype.Ro=function(){return Of.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},e}(),zf=function(e,t,n){this.query=e,this.targetId=t,this.view=n},Hf=function(e){this.key=e,this.bo=!1},Qf=function(){function e(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new zl((function(e){return Os(e)}),Ds),this.Vo=new Map,this.So=new Set,this.Do=new Tu(Ua.comparator),this.Co=new Map,this.No=new Ch,this.xo={},this.Fo=new Map,this.ko=Ol.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $f(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s;return ea(this,(function(u){switch(u.label){case 0:return n=Sp(e),(o=n.Po.get(t))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,yh(n.localStore,xs(t))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,Yf(n,t,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&sf(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function Yf(e,t,n,r){return Zo(this,void 0,void 0,(function(){var i,o,a,s,u,c;return ea(this,(function(l){switch(l.label){case 0:return e.Oo=function(t,n,r){return function(e,t,n,r){return Zo(this,void 0,void 0,(function(){var i,o,a;return ea(this,(function(s){switch(s.label){case 0:return(i=t.view._o(n)).Nn?[4,gh(e.localStore,t.query,!1).then((function(e){var n=e.documents;return t.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o),[2,(cp(e,t.targetId,a.To),a.snapshot)]}}))}))}(e,t,n,r)},[4,gh(e.localStore,t,!0)];case 1:return i=l.sent(),o=new Wf(t,i.Bn),a=o._o(i.documents),s=Fu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),u=o.applyChanges(a,e.isPrimaryClient,s),cp(e,n,u.To),c=new zf(t,n,o),[2,(e.Po.set(t,c),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),u.snapshot)]}}))}))}function Xf(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i;return ea(this,(function(o){switch(o.label){case 0:return n=pa(e),r=n.Po.get(t),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(e){return!Ds(e,t)}))),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,mh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),uf(n.remoteStore,r.targetId),sp(n,r.targetId)})).catch(Ul)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return sp(n,r.targetId),[4,mh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Jf(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a;return ea(this,(function(s){switch(s.label){case 0:r=Ep(e),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(e,t){var n,r=pa(e),i=ba.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Du());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(e){return r.Mn.pn(e,o).next((function(o){n=o;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],l=su(c,n.get(c.key));null!=l&&a.push(new hu(c.key,l,es(l.value.mapValue),nu.exists(!0)))}return r._n.addMutationBatch(e,i,a,t)}))})).then((function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}}))}(r.localStore,t)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.xo[e.currentUser.toKey()];r||(r=new Tu(ya)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,i.batchId,n),[4,fp(r,i.changes)];case 3:return s.sent(),[4,_f(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=xf(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function Zf(e,t){return Zo(this,void 0,void 0,(function(){var n,r;return ea(this,(function(i){switch(i.label){case 0:n=pa(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,dh(n.localStore,t)];case 2:return r=i.sent(),t.targetChanges.forEach((function(e,t){var r=n.Co.get(t);r&&(fa(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.bo=!0:e.modifiedDocuments.size>0?fa(r.bo):e.removedDocuments.size>0&&(fa(r.bo),r.bo=!1))})),[4,fp(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,Ul(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function ep(e,t,n){var r=pa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(e,n){var r=n.view.zr(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=pa(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(t)&&(r=!0)})),r&&qf(n)}(r.eventManager,t),i.length&&r.vo._r(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function tp(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a,s,u;return ea(this,(function(c){switch(c.label){case 0:return(r=pa(e)).sharedClientState.updateQueryState(t,"rejected",n),i=r.Co.get(t),(o=i&&i.key)?(a=(a=new Tu(Ua.comparator)).insert(o,ts.newNoDocument(o,_a.min())),s=Du().add(o),u=new Lu(_a.min(),new Map,new Eu(ya),a,s),[4,Zf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(t),hp(r),[3,4];case 2:return[4,mh(r.localStore,t,!1).then((function(){return sp(r,t,n)})).catch(Ul)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function np(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i;return ea(this,(function(o){switch(o.label){case 0:n=pa(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,fh(n.localStore,t)];case 2:return i=o.sent(),ap(n,r,null),op(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,fp(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ul(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function rp(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i;return ea(this,(function(o){switch(o.label){case 0:r=pa(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(e,t){var n=pa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n._n.lookupMutationBatch(e,t).next((function(t){return fa(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)})).next((function(){return n._n.performConsistencyCheck(e)})).next((function(){return n.Mn.pn(e,r)}))}))}(r.localStore,t)];case 2:return i=o.sent(),ap(r,t,n),op(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,fp(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ul(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ip(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a;return ea(this,(function(s){switch(s.label){case 0:pf((n=pa(e)).remoteStore)||sa("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(e){var t=pa(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t._n.getHighestUnacknowledgedBatchId(e)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void t.resolve()]:((i=n.Fo.get(r)||[]).push(t),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=xf(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(a),[3,4];case 4:return[2]}}))}))}function op(e,t){(e.Fo.get(t)||[]).forEach((function(e){e.resolve()})),e.Fo.delete(t)}function ap(e,t,n){var r=pa(e),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function sp(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach((function(t){e.No.containsKey(t)||up(e,t)}))}function up(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);null!==n&&(uf(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),hp(e))}function cp(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Gf?(e.No.addReference(o.key,t),lp(e,o)):o instanceof Kf?(sa("SyncEngine","Document no longer in limbo: "+o.key),e.No.removeReference(o.key,t),e.No.containsKey(o.key)||up(e,o.key)):ha()}}function lp(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(sa("SyncEngine","New document in limbo: "+n),e.So.add(r),hp(e))}function hp(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new Ua(Ea.fromString(t)),r=e.ko.next();e.Co.set(r,new Hf(n)),e.Do=e.Do.insert(n,r),sf(e.remoteStore,new al(xs(Ss(n.path)),r,2,na.o))}}function fp(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a;return ea(this,(function(s){switch(s.label){case 0:return r=pa(e),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(e,s){a.push(r.Oo(s,t,n).then((function(e){if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,e.fromCache?"not-current":"current"),i.push(e);var t=sh.Pn(s.targetId,e);o.push(t)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return ea(this,(function(h){switch(h.label){case 0:n=pa(e),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return zc.forEach(t,(function(t){return zc.forEach(t.bn,(function(r){return n.persistence.referenceDelegate.addReference(e,t.targetId,r)})).next((function(){return zc.forEach(t.vn,(function(r){return n.persistence.referenceDelegate.removeReference(e,t.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!Xc(r=h.sent()))throw r;return sa("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=t;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.Fn.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(s,l));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function pp(e,t){return Zo(this,void 0,void 0,(function(){var n,r;return ea(this,(function(i){switch(i.label){case 0:return(n=pa(e)).currentUser.isEqual(t)?[3,3]:(sa("SyncEngine","User change. New user:",t.toKey()),[4,hh(n.localStore,t)]);case 1:return r=i.sent(),n.currentUser=t,function(e,t){e.Fo.forEach((function(e){e.forEach((function(e){e.reject(new ia(ra.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Fo.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,fp(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function dp(e,t){var n=pa(e),r=n.Co.get(t);if(r&&r.bo)return Du().add(r.key);var i=Du(),o=n.Vo.get(t);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function vp(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i;return ea(this,(function(o){switch(o.label){case 0:return[4,gh((n=pa(e)).localStore,t.query,!0)];case 1:return r=o.sent(),i=t.view.Ao(r),[2,(n.isPrimaryClient&&cp(n,t.targetId,i.To),i)]}}))}))}function yp(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){return[2,_h((t=pa(e)).localStore).then((function(e){return fp(t,e)}))]}))}))}function mp(e,t,n,r){return Zo(this,void 0,void 0,(function(){var i,o;return ea(this,(function(a){switch(a.label){case 0:return[4,function(e,t){var n=pa(e),r=pa(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.jt(e,t).next((function(t){return t?n.Mn.pn(e,t):zc.resolve(null)}))}))}((i=pa(e)).localStore,t)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,_f(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(ap(i,t,r||null),op(i,t),function(e,t){pa(pa(e)._n).Gt(t)}(i.localStore,t)):ha(),a.label=4;case 4:return[4,fp(i,o)];case 5:return a.sent(),[3,7];case 6:sa("SyncEngine","Cannot apply mutation batch with id: "+t),a.label=7;case 7:return[2]}}))}))}function gp(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return ea(this,(function(l){switch(l.label){case 0:return Sp(n=pa(e)),Ep(n),!0!==t||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,bp(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,kf(n.remoteStore,!0)];case 2:for(l.sent(),o=0,a=i;o<a.length;o++)s=a[o],sf(n.remoteStore,s);return[3,7];case 3:return!1!==t||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(e,t){n.sharedClientState.isLocalQueryTarget(t)?u.push(t):c=c.then((function(){return sp(n,t),mh(n.localStore,t,!0)})),uf(n.remoteStore,t)})),[4,c]);case 4:return l.sent(),[4,bp(n,u)];case 5:return l.sent(),function(e){var t=pa(e);t.Co.forEach((function(e,n){uf(t.remoteStore,n)})),t.No.ts(),t.Co=new Map,t.Do=new Tu(Ua.comparator)}(n),n.$o=!1,[4,kf(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function bp(e,t,n){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,p,d,v;return ea(this,(function(y){switch(y.label){case 0:n=pa(e),r=[],i=[],o=0,a=t,y.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Vo.get(s))&&0!==c.length?[4,yh(n.localStore,xs(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),l=0,h=c,y.label=3;case 3:return l<h.length?(f=h[l],p=n.Po.get(f),[4,vp(n,p)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,bh(n.localStore,s)];case 8:return v=y.sent(),[4,yh(n.localStore,v)];case 9:return u=y.sent(),[4,Yf(n,_p(v),s,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function _p(e){return Cs(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function wp(e){var t=pa(e);return pa(pa(t.localStore).persistence).fn()}function Tp(e,t,n,r){return Zo(this,void 0,void 0,(function(){var i,o,a;return ea(this,(function(s){switch(s.label){case 0:return(i=pa(e)).$o?(sa("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,_h(i.localStore)];case 3:return o=s.sent(),a=Lu.createSynthesizedRemoteEventForCurrentChange(t,"current"===n),[4,fp(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,mh(i.localStore,t,!0)];case 6:return s.sent(),sp(i,t,r),[3,8];case 7:ha(),s.label=8;case 8:return[2]}}))}))}function Cp(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f;return ea(this,(function(p){switch(p.label){case 0:if(!(r=Sp(e)).$o)return[3,10];i=0,o=t,p.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(sa("SyncEngine","Adding an already active target "+a),[3,5]):[4,bh(r.localStore,a)]):[3,6];case 2:return s=p.sent(),[4,yh(r.localStore,s)];case 3:return u=p.sent(),[4,Yf(r,_p(s),u.targetId,!1)];case 4:p.sent(),sf(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(e){return ea(this,(function(t){switch(t.label){case 0:return r.Vo.has(e)?[4,mh(r.localStore,e,!1).then((function(){uf(r.remoteStore,e),sp(r,e)})).catch(Ul)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))},l=0,h=n,p.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Sp(e){var t=pa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Zf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=dp.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=tp.bind(null,t),t.vo._r=Uf.bind(null,t.eventManager),t.vo.Mo=Vf.bind(null,t.eventManager),t}function Ep(e){var t=pa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=np.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=rp.bind(null,t),t}var Ip=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return this.R=Yh(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Qo(e),[2]}}))}))},e.prototype.Uo=function(e){return null},e.prototype.Qo=function(e){return lh(this.persistence,new uh,e.initialUser,this.R)},e.prototype.qo=function(e){return new Rh(xh.bs,this.R)},e.prototype.Bo=function(e){return new Bh},e.prototype.terminate=function(){return Zo(this,void 0,void 0,(function(){return ea(this,(function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}}))}))},e}(),kp=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Ko=t,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Jo(t,e),t.prototype.initialize=function(t){return Zo(this,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return n.sent(),[4,wh(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,t)];case 3:return n.sent(),[4,Ep(this.Ko.syncEngine)];case 4:return n.sent(),[4,_f(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},t.prototype.Qo=function(e){return lh(this.persistence,new uh,e.initialUser,this.R)},t.prototype.Uo=function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new Bl(t,e.asyncQueue)},t.prototype.qo=function(e){var t=oh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Il.withCacheSize(this.cacheSizeBytes):Il.DEFAULT;return new nh(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Qh(),$h(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(e){return new Bh},t}(Ip),Pp=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n,!1)||this).Ko=t,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Jo(t,e),t.prototype.initialize=function(t){return Zo(this,void 0,void 0,(function(){var n,r=this;return ea(this,(function(i){switch(i.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof qh?(this.sharedClientState.syncEngine={ui:mp.bind(null,n),ai:Tp.bind(null,n),hi:Cp.bind(null,n),fn:wp.bind(null,n),ci:yp.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(e){return Zo(r,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return[4,gp(this.Ko.syncEngine,e)];case 1:return t.sent(),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},t.prototype.Bo=function(e){var t=Qh();if(!qh.yt(t))throw new ia(ra.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=oh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qh(t,e.asyncQueue,n,e.clientId,e.initialUser)},t}(kp),Rp=function(){function e(){}return e.prototype.initialize=function(e,t){return Zo(this,void 0,void 0,(function(){var n=this;return ea(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return ep(n.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=pp.bind(null,this.syncEngine),[4,kf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.createEventManager=function(e){return new Lf},e.prototype.createDatastore=function(e){var t,n=Yh(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Hh(t));return function(e,t,n){return new tf(e,t,n)}(e.credentials,r,n)},e.prototype.createRemoteStore=function(e){var t,n,r,i,o,a=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return ep(a.syncEngine,e,0)},o=Kh.yt()?new Kh:new Gh,new rf(t,n,r,i,o)},e.prototype.createSyncEngine=function(e,t){return function(e,t,n,r,i,o,a){var s=new Qf(e,t,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)},e.prototype.terminate=function(){return function(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return t=pa(e),sa("RemoteStore","RemoteStore shutting down."),t.Or.add(5),[4,af(t)];case 1:return n.sent(),t.Lr.shutdown(),t.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},e}(),Np=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.observer.next&&this.jo(this.observer.next,e)},e.prototype.error=function(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},e}(),xp=function(){function e(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return Zo(this,void 0,void 0,(function(){var t,n=this;return ea(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new ia(ra.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i,o,a,s;return ea(this,(function(u){switch(u.label){case 0:return n=pa(e),r=ic(n.R)+"/documents",i={documents:t.map((function(e){return ec(n.R,e)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(e){var t=function(e,t){return"found"in t?function(e,t){fa(!!t.found),t.found.name,t.found.updateTime;var n=tc(e,t.found.name),r=Xu(t.found.updateTime),i=new Za({mapValue:{fields:t.found.fields}});return ts.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){fa(!!t.missing),fa(!!t.readTime);var n=tc(e,t.missing),r=Xu(t.readTime);return ts.newNoDocument(n,r)}(e,t):ha()}(n.R,e);a.set(t.key.toString(),t)})),s=[],[2,(t.forEach((function(e){var t=a.get(e.toString());fa(!!t),s.push(t)})),s)]}}))}))}(this.datastore,e)];case 1:return[2,((t=r.sent()).forEach((function(e){return n.recordVersion(e)})),t)]}}))}))},e.prototype.set=function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.update=function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},e.prototype.delete=function(e){this.write(new mu(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.commit=function(){return Zo(this,void 0,void 0,(function(){var e,t=this;return ea(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach((function(t){e.delete(t.key.toString())})),e.forEach((function(e,n){var r=Ua.fromPath(n);t.mutations.push(new gu(r,t.precondition(r)))})),[4,function(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i;return ea(this,(function(o){switch(o.label){case 0:return n=pa(e),r=ic(n.R)+"/documents",i={writes:t.map((function(e){return sc(n.R,e)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},e.prototype.recordVersion=function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ha();t=_a.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ia(ra.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?nu.updateTime(t):nu.none()},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(_a.min()))throw new ia(ra.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nu.updateTime(t)}return nu.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations.push(e)},e.prototype.ensureCommitNotCalled=function(){},e}(),Ap=function(){function e(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Xh(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.nc()},e.prototype.nc=function(){var e=this;this.Zi.ji((function(){return Zo(e,void 0,void 0,(function(){var e,t,n=this;return ea(this,(function(r){return e=new xp(this.datastore),(t=this.sc(e))&&t.then((function(t){n.asyncQueue.enqueueAndForget((function(){return e.commit().then((function(){n.deferred.resolve(t)})).catch((function(e){n.ic(e)}))}))})).catch((function(e){n.ic(e)})),[2]}))}))}))},e.prototype.sc=function(e){try{var t=this.updateFunction(e);return!La(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},e.prototype.ic=function(e){var t=this;this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return t.nc(),Promise.resolve()}))):this.deferred.reject(e)},e.prototype.rc=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!_u(t)}return!1},e}(),Dp=function(){function e(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=Ah.UNAUTHENTICATED,this.clientId=va.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(t,(function(e){return Zo(r,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return sa("FirestoreClient","Received user=",e.uid),[4,this.credentialListener(e)];case 1:return t.sent(),this.user=e,[2]}}))}))}))}return e.prototype.getConfiguration=function(){return Zo(this,void 0,void 0,(function(){return ea(this,(function(e){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},e.prototype.setCredentialChangeListener=function(e){this.credentialListener=e},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new ia(ra.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Wc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Zo(e,void 0,void 0,(function(){var e,n;return ea(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),t.resolve(),[3,6];case 5:return e=r.sent(),n=xf(e,"Failed to shutdown persistence"),t.reject(n),[3,6];case 6:return[2]}}))}))})),t.promise},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Op(e,t){return Zo(this,void 0,void 0,(function(){var n,r,i=this;return ea(this,(function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),sa("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.initialUser,e.setCredentialChangeListener((function(e){return Zo(i,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return r.isEqual(e)?[3,2]:[4,hh(t.localStore,e)];case 1:n.sent(),r=e,n.label=2;case 2:return[2]}}))}))})),t.persistence.setDatabaseDeletedListener((function(){return e.terminate()})),e.offlineComponents=t,[2]}}))}))}function Mp(e,t){return Zo(this,void 0,void 0,(function(){var n,r;return ea(this,(function(i){switch(i.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,Lp(e)];case 1:return n=i.sent(),sa("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.setCredentialChangeListener((function(e){return function(e,t){return Zo(this,void 0,void 0,(function(){var n,r;return ea(this,(function(i){switch(i.label){case 0:return(n=pa(e)).asyncQueue.verifyOperationInProgress(),sa("RemoteStore","RemoteStore received new credentials"),r=pf(n),n.Or.add(3),[4,af(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(t)];case 2:return i.sent(),n.Or.delete(3),[4,of(n)];case 3:return i.sent(),[2]}}))}))}(t.remoteStore,e)})),e.onlineComponents=t,[2]}}))}))}function Lp(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(sa("FirestoreClient","Using default OfflineComponentProvider"),[4,Op(e,new Ip)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}}))}))}function Fp(e){return Zo(this,void 0,void 0,(function(){return ea(this,(function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(sa("FirestoreClient","Using default OnlineComponentProvider"),[4,Mp(e,new Rp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}}))}))}function jp(e){return Lp(e).then((function(e){return e.persistence}))}function Up(e){return Lp(e).then((function(e){return e.localStore}))}function Vp(e){return Fp(e).then((function(e){return e.remoteStore}))}function qp(e){return Fp(e).then((function(e){return e.syncEngine}))}function Bp(e){return Zo(this,void 0,void 0,(function(){var t,n;return ea(this,(function(r){switch(r.label){case 0:return[4,Fp(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=$f.bind(null,t.syncEngine),n.onUnlisten=Xf.bind(null,t.syncEngine),n)]}}))}))}function Gp(e,t,n){var r=this;void 0===n&&(n={});var i=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(r,void 0,void 0,(function(){var r;return ea(this,(function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new Np({next:function(o){t.enqueueAndForget((function(){return jf(e,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new ia(ra.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new ia(ra.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(e){return i.reject(e)}}),a=new Bf(Ss(n.path),o,{includeMetadataChanges:!0,so:!0});return Ff(e,a)},[4,Bp(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}}))}))})),i.promise}function Kp(e,t,n){var r=this;void 0===n&&(n={});var i=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(r,void 0,void 0,(function(){var r;return ea(this,(function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new Np({next:function(n){t.enqueueAndForget((function(){return jf(e,a)})),n.fromCache&&"server"===r.source?i.reject(new ia(ra.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),a=new Bf(n,o,{includeMetadataChanges:!0,so:!0});return Ff(e,a)},[4,Bp(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}}))}))})),i.promise}var Wp=function(e,t,n,r,i,o,a,s){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},zp=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),Hp=new Map,Qp=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},$p=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){this.changeListener=t,e.enqueueRetryable((function(){return t(Ah.UNAUTHENTICATED)}))},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),Yp=function(){function e(e){this.token=e,this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(this.token)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),Xp=function(){function e(e){var t=this;this.currentUser=Ah.UNAUTHENTICATED,this.oc=new Wc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){t.cc++,t.currentUser=t.ac(),t.oc.resolve(),t.changeListener&&t.asyncQueue.enqueueRetryable((function(){return t.changeListener(t.currentUser)}))};var n=function(e){sa("FirebaseCredentialsProvider","Auth detected"),t.auth=e,t.auth.addAuthTokenListener(t.uc)};e.onInit((function(e){return n(e)})),setTimeout((function(){if(!t.auth){var r=e.getImmediate({optional:!0});r?n(r):(sa("FirebaseCredentialsProvider","Auth not yet detected"),t.oc.resolve())}}),0)}return e.prototype.getToken=function(){var e=this,t=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.cc!==t?(sa("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(fa("string"==typeof n.accessToken),new Qp(n.accessToken,e.currentUser)):null})):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e,t){var n=this;this.asyncQueue=e,this.asyncQueue.enqueueRetryable((function(){return Zo(n,void 0,void 0,(function(){return ea(this,(function(e){switch(e.label){case 0:return[4,this.oc.promise];case 1:return e.sent(),[4,t(this.currentUser)];case 2:return e.sent(),this.changeListener=t,[2]}}))}))}))},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},e.prototype.ac=function(){var e=this.auth&&this.auth.getUid();return fa(null===e||"string"==typeof e),new Ah(e)},e}(),Jp=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n,this.type="FirstParty",this.user=Ah.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.lc},t=this.hc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e},enumerable:!1,configurable:!0}),e}(),Zp=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n}return e.prototype.getToken=function(){return Promise.resolve(new Jp(this.hc,this.lc,this.fc))},e.prototype.setChangeListener=function(e,t){e.enqueueRetryable((function(){return t(Ah.FIRST_PARTY)}))},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ed(e,t,n){if(!n)throw new ia(ra.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function td(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new ia(ra.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function nd(e,t,n,r){if(!0===t&&!0===r)throw new ia(ra.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function rd(e){if(!Ua.isDocumentKey(e))throw new ia(ra.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function id(e){if(Ua.isDocumentKey(e))throw new ia(ra.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function od(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":ha()}function ad(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ia(ra.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=od(e);throw new ia(ra.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function sd(e,t){if(t<=0)throw new ia(ra.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ud=function(){function e(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new ia(ra.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ia(ra.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,nd("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams},e}(),cd=function(){function e(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ud({}),this._settingsFrozen=!1,e instanceof zp?(this._databaseId=e,this._credentials=new $p):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ia(ra.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zp(e.options.projectId)}(e),this._credentials=new Xp(t))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new ia(ra.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(e){if(this._settingsFrozen)throw new ia(ra.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ud(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new $p;switch(e.type){case"gapi":var t=e.client;return fa(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Zp(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new ia(ra.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return this,(e=Hp.get(this))&&(sa("ComponentProvider","Removing Datastore"),Hp.delete(this),e.terminate()),Promise.resolve();var e},e}(),ld=function(){function e(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new fd(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),hd=function(){function e(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),fd=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,Ss(r))||this)._path=r,i.type="collection",i}return Jo(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new ld(this.firestore,null,new Ua(e))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._path)},t}(hd);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pd(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=ot(e),ed("collection","path",t),e instanceof cd)return id(n=Ea.fromString.apply(Ea,ta([t],r))),new fd(e,null,n);if(!(e instanceof ld||e instanceof fd))throw new ia(ra.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return id(n=Ea.fromString.apply(Ea,ta([e.path],r)).child(Ea.fromString(t))),new fd(e.firestore,null,n)}function dd(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=ot(e),1===arguments.length&&(t=va.u()),ed("doc","path",t),e instanceof cd)return rd(n=Ea.fromString.apply(Ea,ta([t],r))),new ld(e,null,new Ua(n));if(!(e instanceof ld||e instanceof fd))throw new ia(ra.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return rd(n=e._path.child(Ea.fromString.apply(Ea,ta([t],r)))),new ld(e.firestore,e instanceof fd?e.converter:null,new Ua(n))}function vd(e,t){return e=ot(e),t=ot(t),(e instanceof ld||e instanceof fd)&&(t instanceof ld||t instanceof fd)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function yd(e,t){return e=ot(e),t=ot(t),e instanceof hd&&t instanceof hd&&e.firestore===t.firestore&&Ds(e._query,t._query)&&e.converter===t.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var md=function(){function e(){var e=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Xh(this,"async_queue_retry"),this.Tc=function(){var t=$h();t&&sa("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=$h();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.Ic(),this.Ac(e)},e.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var e=$h();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Tc)}},e.prototype.enqueue=function(e){return this.Ic(),this._c?new Promise((function(e){})):this.Ac(e)},e.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget((function(){return t.wc.push(e),t.Rc()}))},e.prototype.Rc=function(){return Zo(this,void 0,void 0,(function(){var e,t=this;return ea(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Xc(e=n.sent()))throw e;return sa("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return t.Rc()})),n.label=5;case 5:return[2]}}))}))},e.prototype.Ac=function(e){var t=this,n=this.dc.then((function(){return t.gc=!0,e().catch((function(e){throw t.yc=e,t.gc=!1,ua("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e})).then((function(e){return t.gc=!1,e}))}));return this.dc=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.Ic(),this.Ec.indexOf(e)>-1&&(t=0);var i=Nf.createAndSchedule(this,e,t,n,(function(e){return r.bc(e)}));return this.mc.push(i),i},e.prototype.Ic=function(){this.yc&&ha()},e.prototype.verifyOperationInProgress=function(){},e.prototype.vc=function(){return Zo(this,void 0,void 0,(function(){var e;return ea(this,(function(t){switch(t.label){case 0:return[4,e=this.dc];case 1:t.sent(),t.label=2;case 2:if(e!==this.dc)return[3,0];t.label=3;case 3:return[2]}}))}))},e.prototype.Pc=function(e){for(var t=0,n=this.mc;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.Vc=function(e){var t=this;return this.vc().then((function(){t.mc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));for(var n=0,r=t.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==e&&i.timerId===e)break}return t.vc()}))},e.prototype.Sc=function(e){this.Ec.push(e)},e.prototype.bc=function(e){var t=this.mc.indexOf(e);this.mc.splice(t,1)},e}();function gd(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}var bd=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).type="firestore",r._queue=new md,r._persistenceKey="name"in t?t.name:"[DEFAULT]",r}return Jo(t,e),t.prototype._terminate=function(){return this._firestoreClient||wd(this),this._firestoreClient.terminate()},t}(cd);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _d(e){return e._firestoreClient||wd(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function wd(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new Wp(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Dp(e._credentials,e._queue,r)}function Td(e,t,n){var r=this,i=new Wc;return e.asyncQueue.enqueue((function(){return Zo(r,void 0,void 0,(function(){var r;return ea(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Op(e,n)];case 1:return o.sent(),[4,Mp(e,t)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(e){return"FirebaseError"===e.name?e.code===ra.FAILED_PRECONDITION||e.code===ra.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Cd(e){if(e._initialized||e._terminated)throw new ia(ra.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sd=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new ia(ra.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ka(e)}return e.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},e}(),Ed=function(){function e(e){this._byteString=e}return e.fromBase64String=function(t){try{return new e(Ra.fromBase64String(t))}catch(t){throw new ia(ra.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},e.fromUint8Array=function(t){return new e(Ra.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},e}(),Id=function(e){this._methodName=e},kd=function(){function e(e,t){if(!isFinite(e)||e<-90||e>90)throw new ia(ra.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ia(ra.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(e){return ya(this._lat,e._lat)||ya(this._long,e._long)},e}(),Pd=/^__.*__$/,Rd=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return null!==this.fieldMask?new hu(e,this.data,this.fieldMask,t,this.fieldTransforms):new lu(e,this.data,t,this.fieldTransforms)},e}(),Nd=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return new hu(e,this.data,this.fieldMask,t,this.fieldTransforms)},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function xd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ha()}}var Ad=function(){function e(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),e.prototype.Nc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.xc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Nc({path:n,Fc:!1});return r.kc(e),r},e.prototype.$c=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},e.prototype.Oc=function(e){return this.Nc({path:void 0,Fc:!0})},e.prototype.Mc=function(e){return Jd(e,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))},e.prototype.Dc=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.kc(this.path.get(e))},e.prototype.kc=function(e){if(0===e.length)throw this.Mc("Document fields must not be empty");if(xd(this.Cc)&&Pd.test(e))throw this.Mc('Document fields cannot begin and end with "__"')},e}(),Dd=function(){function e(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||Yh(e)}return e.prototype.qc=function(e,t,n,r){return void 0===r&&(r=!1),new Ad({Cc:e,methodName:t,Bc:n,path:ka.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function Od(e){var t=e._freezeSettings(),n=Yh(e._databaseId);return new Dd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Md(e,t,n,r,i,o){void 0===o&&(o={});var a=e.qc(o.merge||o.mergeFields?2:0,t,n,i);Qd("Data must be an object, but it was:",a,r);var s,u,c=zd(r,a);if(o.merge)s=new Pa(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=$d(t,f[h],n);if(!a.contains(p))throw new ia(ra.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Zd(l,p)||l.push(p)}s=new Pa(l),u=a.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=a.fieldTransforms;return new Rd(new Za(c),s,u)}var Ld=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype._toFieldTransform=function(e){if(2!==e.Cc)throw 1===e.Cc?e.Mc(this._methodName+"() can only appear at the top level of your update data"):e.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},t.prototype.isEqual=function(e){return e instanceof t},t}(Id);function Fd(e,t,n){return new Ad({Cc:3,Bc:t.settings.Bc,methodName:e._methodName,Fc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var jd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype._toFieldTransform=function(e){return new eu(e.path,new zs)},t.prototype.isEqual=function(e){return e instanceof t},t}(Id),Ud=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Uc=n,r}return Jo(t,e),t.prototype._toFieldTransform=function(e){var t=Fd(this,e,!0),n=this.Uc.map((function(e){return Wd(e,t)})),r=new Hs(n);return new eu(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Id),Vd=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Uc=n,r}return Jo(t,e),t.prototype._toFieldTransform=function(e){var t=Fd(this,e,!0),n=this.Uc.map((function(e){return Wd(e,t)})),r=new $s(n);return new eu(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Id),qd=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Qc=n,r}return Jo(t,e),t.prototype._toFieldTransform=function(e){var t=new Xs(e.R,qs(e.R,this.Qc));return new eu(e.path,t)},t.prototype.isEqual=function(e){return this===e},t}(Id);function Bd(e,t,n,r){var i=e.qc(1,t,n);Qd("Data must be an object, but it was:",i,r);var o=[],a=Za.empty();Ta(r,(function(e,r){var s=Xd(t,e,n);r=ot(r);var u=i.$c(s);if(r instanceof Ld)o.push(s);else{var c=Wd(r,u);null!=c&&(o.push(s),a.set(s,c))}}));var s=new Pa(o);return new Nd(a,s,i.fieldTransforms)}function Gd(e,t,n,r,i,o){var a=e.qc(1,t,n),s=[$d(t,r,n)],u=[i];if(o.length%2!=0)throw new ia(ra.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push($d(t,o[c])),u.push(o[c+1]);for(var l=[],h=Za.empty(),f=s.length-1;f>=0;--f)if(!Zd(l,s[f])){var p=s[f],d=u[f];d=ot(d);var v=a.$c(p);if(d instanceof Ld)l.push(p);else{var y=Wd(d,v);null!=y&&(l.push(p),h.set(p,y))}}var m=new Pa(l);return new Nd(h,m,a.fieldTransforms)}function Kd(e,t,n,r){return void 0===r&&(r=!1),Wd(n,e.qc(r?4:3,t))}function Wd(e,t){if(Hd(e=ot(e)))return Qd("Unsupported field value:",t,e),zd(e,t);if(e instanceof Id)return function(e,t){if(!xd(t.Cc))throw t.Mc(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.Mc(e._methodName+"() is not currently supported inside arrays");var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.Cc)throw t.Mc("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=Wd(o[i],t.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ot(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return qs(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=ba.fromDate(e);return{timestampValue:Qu(t.R,n)}}if(e instanceof ba)return n=new ba(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)),{timestampValue:Qu(t.R,n)};if(e instanceof kd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ed)return{bytesValue:$u(t.R,e._byteString)};if(e instanceof ld){n=t.databaseId;var r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ju(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Mc("Unsupported field value: "+od(e))}(e,t)}function zd(e,t){var n={};return Ca(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ta(e,(function(e,r){var i=Wd(r,t.xc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Hd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ba||e instanceof kd||e instanceof Ed||e instanceof ld||e instanceof Id)}function Qd(e,t,n){if(!Hd(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=od(n);throw"an object"===r?t.Mc(e+" a custom object"):t.Mc(e+" "+r)}}function $d(e,t,n){if((t=ot(t))instanceof Sd)return t._internalPath;if("string"==typeof t)return Xd(e,t);throw Jd("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var Yd=new RegExp("[~\\*/\\[\\]]");function Xd(e,t,n){if(t.search(Yd)>=0)throw Jd("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return(new(Sd.bind.apply(Sd,ta([void 0],t.split(".")))))._internalPath}catch(r){throw Jd("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function Jd(e,t,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+t+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new ia(ra.INVALID_ARGUMENT,(s+=". ")+e+u)}function Zd(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ev=function(){function e(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new ld(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return null!==this._document},e.prototype.data=function(){if(this._document){if(this._converter){var e=new tv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}},e.prototype.get=function(e){if(this._document){var t=this._document.data.field(nv("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}},e}(),tv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(ev);function nv(e,t){return"string"==typeof t?Xd(e,t):t instanceof Sd?t._internalPath:t._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rv=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),iv=function(e){function t(t,n,r,i,o,a){var s=this;return(s=e.call(this,t,n,r,i,a)||this)._firestore=t,s._firestoreImpl=t,s.metadata=o,s}return Jo(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new ov(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}},t.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document){var n=this._document.data.field(nv("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}},t}(ev),ov=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype.data=function(t){return void 0===t&&(t={}),e.prototype.data.call(this,t)},t}(iv),av=function(){function e(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new rv(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new ov(n._firestore,n._userDataWriter,r.key,r,new rv(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},e.prototype.docChanges=function(e){void 0===e&&(e={});var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ia(ra.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new ov(e._firestore,e._userDataWriter,t.doc.key,t.doc,new rv(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new ov(e._firestore,e._userDataWriter,t.doc.key,t.doc,new rv(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,o=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(o=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:sv(t.type),doc:n,oldIndex:i,newIndex:o}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e}();function sv(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ha()}}function uv(e,t){return e instanceof iv&&t instanceof iv?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof av&&t instanceof av&&e._firestore===t._firestore&&yd(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cv(e){if(Is(e)&&0===e.explicitOrderBy.length)throw new ia(ra.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lv=function(){};function hv(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o._apply(e)}return e}var fv=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Kc=t,i.jc=n,i.Wc=r,i.type="where",i}return Jo(t,e),t.prototype._apply=function(e){var t=Od(e.firestore),n=function(e,t,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new ia(ra.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){bv(a,o);for(var u=[],c=0,l=a;c<l.length;c++){var h=l[c];u.push(gv(r,e,h))}s={arrayValue:{values:u}}}else s=gv(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||bv(a,o),s=Kd(n,"where",a,"in"===o||"not-in"===o);var f=ss.create(i,o,s);return function(e,t){if(t.g()){var n=Ps(e);if(null!==n&&!n.isEqual(t.field))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");var r=ks(e);null!==r&&_v(e,t.field,r)}var i=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(t.indexOf(i.op)>=0)return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new ia(ra.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new ia(ra.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+i.toString()+"' filters.")}(e,f),f}(e._query,0,t,e.firestore._databaseId,this.Kc,this.jc,this.Wc);return new hd(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new Ts(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))},t}(lv),pv=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Kc=t,r.Gc=n,r.type="orderBy",r}return Jo(t,e),t.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new ia(ra.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ia(ra.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new gs(t,n);return function(e,t){if(null===ks(e)){var n=Ps(e);null!==n&&_v(e,n,t.field)}}(e,r),r}(e._query,this.Kc,this.Gc);return new hd(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new Ts(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))},t}(lv),dv=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.zc=n,i.Hc=r,i}return Jo(t,e),t.prototype._apply=function(e){return new hd(e.firestore,e.converter,As(e._query,this.zc,this.Hc))},t}(lv),vv=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Jc=n,i.Yc=r,i}return Jo(t,e),t.prototype._apply=function(e){var t=mv(e,this.type,this.Jc,this.Yc);return new hd(e.firestore,e.converter,function(e,t){return new Ts(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))},t}(lv),yv=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Jc=n,i.Yc=r,i}return Jo(t,e),t.prototype._apply=function(e){var t=mv(e,this.type,this.Jc,this.Yc);return new hd(e.firestore,e.converter,function(e,t){return new Ts(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))},t}(lv);function mv(e,t,n,r){if(n[0]=ot(n[0]),n[0]instanceof ev)return function(e,t,n,r,i){if(!r)throw new ia(ra.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Ns(e);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(za(t,r.key));else{var c=r.data.field(u.field);if(Oa(c))throw new ia(ra.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new ia(ra.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ys(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=Od(e.firestore);return function(e,t,n,r,i,o){var a=e.explicitOrderBy;if(i.length>a.length)throw new ia(ra.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new ia(ra.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Rs(e)&&-1!==c.indexOf("/"))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=e.path.child(Ea.fromString(c));if(!Ua.isDocumentKey(l))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Ua(l);s.push(za(t,h))}else{var f=Kd(n,r,c);s.push(f)}}return new ys(s,o)}(e._query,e.firestore._databaseId,i,t,n,r)}function gv(e,t,n){if("string"==typeof(n=ot(n))){if(""===n)throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rs(t)&&-1!==n.indexOf("/"))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(Ea.fromString(n));if(!Ua.isDocumentKey(r))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return za(e,new Ua(r))}if(n instanceof ld)return za(e,n._key);throw new ia(ra.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+od(n)+".")}function bv(e,t){if(!Array.isArray(e)||0===e.length)throw new ia(ra.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new ia(ra.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function _v(e,t,n){if(!n.isEqual(t))throw new ia(ra.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wv=function(){function e(){}return e.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),Va(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Aa(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Da(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ha()}},e.prototype.convertObject=function(e,t){var n=this,r={};return Ta(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r},e.prototype.convertGeoPoint=function(e){return new kd(Aa(e.latitude),Aa(e.longitude))},e.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))},e.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=function e(t){var n=t.mapValue.fields.__previous_value__;return Oa(n)?e(n):n}(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ma(e));default:return null}},e.prototype.convertTimestamp=function(e){var t=xa(e);return new ba(t.seconds,t.nanos)},e.prototype.convertDocumentKey=function(e,t){var n=Ea.fromString(e);fa(wc(n));var r=new zp(n.get(1),n.get(3)),i=new Ua(n.popFirst(5));return r.isEqual(t)||ua("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),i},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Tv(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var Cv=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Jo(t,e),t.prototype.convertBytes=function(e){return new Ed(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ld(this.firestore,null,t)},t}(wv),Sv=function(){function e(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Od(e)}return e.prototype.set=function(e,t,n){this._verifyNotCommitted();var r=Ev(e,this._firestore),i=Tv(r.converter,t,n),o=Md(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,nu.none())),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,a=Ev(e,this._firestore);return o="string"==typeof(t=ot(t))||t instanceof Sd?Gd(this._dataReader,"WriteBatch.update",a._key,t,n,r):Bd(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,nu.exists(!0))),this},e.prototype.delete=function(e){this._verifyNotCommitted();var t=Ev(e,this._firestore);return this._mutations=this._mutations.concat(new mu(t._key,nu.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new ia(ra.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ev(e,t){if((e=ot(e)).firestore!==t)throw new ia(ra.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Iv=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Jo(t,e),t.prototype.convertBytes=function(e){return new Ed(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ld(this.firestore,null,t)},t}(wv);function kv(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=ad(e,ld);var o=ad(e.firestore,bd),a=Od(o);return Rv(o,[("string"==typeof(t=ot(t))||t instanceof Sd?Gd(a,"updateDoc",e._key,t,n,r):Bd(a,"updateDoc",e._key,t)).toMutation(e._key,nu.exists(!0))])}function Pv(e){for(var t,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];e=ot(e);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||gd(i[s])||(a=i[s],s++);var u,c,l,h={includeMetadataChanges:a.includeMetadataChanges};if(gd(i[s])){var f=i[s];i[s]=null===(t=f.next)||void 0===t?void 0:t.bind(f),i[s+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[s+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(e instanceof ld)c=ad(e.firestore,bd),l=Ss(e._key.path),u={next:function(t){i[s]&&i[s](Nv(c,e,t))},error:i[s+1],complete:i[s+2]};else{var p=ad(e,hd);c=ad(p.firestore,bd),l=p._query;var d=new Iv(c);u={next:function(e){i[s]&&i[s](new av(c,d,p,e))},error:i[s+1],complete:i[s+2]},cv(e._query)}return function(e,t,n,r){var i=this,o=new Np(r),a=new Bf(t,o,n);return e.asyncQueue.enqueueAndForget((function(){return Zo(i,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return t=Ff,[4,Bp(e)];case 1:return[2,t.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),e.asyncQueue.enqueueAndForget((function(){return Zo(i,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return t=jf,[4,Bp(e)];case 1:return[2,t.apply(void 0,[n.sent(),a])]}}))}))}))}}(_d(c),l,h,u)}function Rv(e,t){return function(e,t){var n=this,r=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var n;return ea(this,(function(i){switch(i.label){case 0:return n=Jf,[4,qp(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(_d(e),t)}function Nv(e,t,n){var r=n.docs.get(t._key),i=new Iv(e);return new iv(e,i,t._key,r,new rv(n.hasPendingWrites,n.fromCache),t.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xv=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this)._firestore=t,r}return Jo(t,e),t.prototype.get=function(t){var n=this,r=Ev(t,this._firestore),i=new Iv(this._firestore);return e.prototype.get.call(this,t).then((function(e){return new iv(n._firestore,i,r._key,e._document,new rv(!1,!1),r.converter)}))},t}(function(){function e(e,t){this._firestore=e,this._transaction=t,this._dataReader=Od(e)}return e.prototype.get=function(e){var t=this,n=Ev(e,this._firestore),r=new Cv(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return ha();var i=e[0];if(i.isFoundDocument())return new ev(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ev(t._firestore,r,n._key,null,n.converter);throw ha()}))},e.prototype.set=function(e,t,n){var r=Ev(e,this._firestore),i=Tv(r.converter,t,n),o=Md(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a=Ev(e,this._firestore);return o="string"==typeof(t=ot(t))||t instanceof Sd?Gd(this._dataReader,"Transaction.update",a._key,t,n,r):Bd(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,o),this},e.prototype.delete=function(e){var t=Ev(e,this._firestore);return this._transaction.delete(t._key),this},e}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Av(){if("undefined"==typeof Uint8Array)throw new ia(ra.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Dv(){if("undefined"==typeof atob)throw new ia(ra.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ov=function(){function e(e){this._delegate=e}return e.fromBase64String=function(t){return Dv(),new e(Ed.fromBase64String(t))},e.fromUint8Array=function(t){return Av(),new e(Ed.fromUint8Array(t))},e.prototype.toBase64=function(){return Dv(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return Av(),this._delegate.toUint8Array()},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),Mv=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){Cd(e=ad(e,bd));var n=_d(e),r=e._freezeSettings(),i=new Rp;return Td(n,i,new kp(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},e.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){Cd(e=ad(e,bd));var t=_d(e),n=e._freezeSettings(),r=new Rp;return Td(t,r,new Pp(r,n.cacheSizeBytes))}(e._delegate)},e.prototype.clearIndexedDbPersistence=function(e){return function(e){var t=this;if(e._initialized&&!e._terminated)throw new ia(ra.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Wc;return e._queue.enqueueAndForgetEvenWhileRestricted((function(){return Zo(t,void 0,void 0,(function(){var t;return ea(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return Qc.yt()?(t=e+"main",[4,Qc.delete(t)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(oh(e._databaseId,e._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise}(e._delegate)},e}(),Lv=function(){function e(e,t,n){var r=this;this._delegate=t,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},e instanceof zp||(this.Zc=e)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||ca("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)},e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),function(e,t,n,r){void 0===r&&(r={});var i=(e=ad(e,cd))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&ca("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},i),{host:t+":"+n,ssl:!1})),r.mockUserToken){var o=De(r.mockUserToken),a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new ia(ra.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");e._credentials=new Yp(new Qp(o,new Ah(a)))}}(this._delegate,e,t,n)},e.prototype.enableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue((function(){return Zo(t,void 0,void 0,(function(){var t,n;return ea(this,(function(r){switch(r.label){case 0:return[4,jp(e)];case 1:return t=r.sent(),[4,Vp(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!0),function(e){var t=pa(e);return t.Or.delete(0),of(t)}(n))]}}))}))}))}(_d(ad(this._delegate,bd)))},e.prototype.disableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue((function(){return Zo(t,void 0,void 0,(function(){var t,n;return ea(this,(function(r){switch(r.label){case 0:return[4,jp(e)];case 1:return t=r.sent(),[4,Vp(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!1),function(e){return Zo(this,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return(t=pa(e)).Or.add(0),[4,af(t)];case 1:return n.sent(),t.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(_d(ad(this._delegate,bd)))},e.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&nd("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(e){var t=this,n=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(t,void 0,void 0,(function(){var t;return ea(this,(function(r){switch(r.label){case 0:return t=ip,[4,qp(e)];case 1:return[2,t.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(_d(ad(this._delegate,bd)))},e.prototype.onSnapshotsInSync=function(e){return function(e,t){return function(e,t){var n=this,r=new Np(t);return e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return t=function(e,t){pa(e).Gr.add(t),t.next()},[4,Bp(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var t;return ea(this,(function(n){switch(n.label){case 0:return t=function(e,t){pa(e).Gr.delete(t)},[4,Bp(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}}))}))}))}}(_d(e=ad(e,bd)),gd(t)?t:{next:t})}(this._delegate,e)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Zc)throw new ia(ra.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new Yv(this,pd(this._delegate,e))}catch(e){throw Bv(e,"collection()","Firestore.collection()")}},e.prototype.doc=function(e){try{return new qv(this,dd(this._delegate,e))}catch(e){throw Bv(e,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(e){try{return new Hv(this,function(e,t){if(e=ad(e,cd),ed("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new ia(ra.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new hd(e,null,function(e){return new Ts(Ea.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw Bv(e,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(e){var t=this;return function(e,t){return function(e,t){var n=this,r=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var n;return ea(this,(function(i){switch(i.label){case 0:return[4,function(e){return Fp(e).then((function(e){return e.datastore}))}(e)];case 1:return n=i.sent(),new Ap(e.asyncQueue,n,t,r).run(),[2]}}))}))})),r.promise}(_d(e),(function(n){return t(new xv(e,n))}))}(this._delegate,(function(n){return e(new jv(t,n))}))},e.prototype.batch=function(){var e=this;return _d(this._delegate),new Uv(new Sv(this._delegate,(function(t){return Rv(e._delegate,t)})))},e.prototype.loadBundle=function(e){throw new ia(ra.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(e){throw new ia(ra.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),Fv=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Jo(t,e),t.prototype.convertBytes=function(e){return new Ov(new Ed(e))},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return qv.tu(t,this.firestore,null)},t}(wv);var jv=function(){function e(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Fv(e)}return e.prototype.get=function(e){var t=this,n=Xv(e);return this._delegate.get(n).then((function(e){return new Wv(t._firestore,new iv(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))},e.prototype.set=function(e,t,n){var r=Xv(e);return n?(td("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Xv(e);return 2===arguments.length?this._delegate.update(a,t):(r=this._delegate).update.apply(r,ta([a,t,n],i)),this},e.prototype.delete=function(e){var t=Xv(e);return this._delegate.delete(t),this},e}(),Uv=function(){function e(e){this._delegate=e}return e.prototype.set=function(e,t,n){var r=Xv(e);return n?(td("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Xv(e);return 2===arguments.length?this._delegate.update(a,t):(r=this._delegate).update.apply(r,ta([a,t,n],i)),this},e.prototype.delete=function(e){var t=Xv(e);return this._delegate.delete(t),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),Vv=function(){function e(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}return e.prototype.fromFirestore=function(e,t){var n=new ov(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zv(this._firestore,n),null!=t?t:{})},e.prototype.toFirestore=function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)},e.eu=function(t,n){var r=e.nu,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new Fv(t),n),i.set(n,o)),o},e}();Vv.nu=new WeakMap;var qv=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fv(e)}return e.su=function(t,n,r){if(t.length%2!=0)throw new ia(ra.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new ld(n._delegate,r,new Ua(t)))},e.tu=function(t,n,r){return new e(n,new ld(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Yv(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new Yv(this.firestore,pd(this._delegate,e))}catch(e){throw Bv(e,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(e){return(e=ot(e))instanceof ld&&vd(this._delegate,e)},e.prototype.set=function(e,t){t=td("DocumentReference.set",t);try{return function(e,t,n){e=ad(e,ld);var r=ad(e.firestore,bd),i=Tv(e.converter,t,n);return Rv(r,[Md(Od(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,nu.none())])}(this._delegate,e,t)}catch(e){throw Bv(e,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?kv(this._delegate,e):kv.apply(void 0,ta([this._delegate,e,t],n))}catch(e){throw Bv(e,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Rv(ad((e=this._delegate).firestore,bd),[new mu(e._key,nu.none())]);var e},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Gv(t),i=Kv(t,(function(t){return new Wv(e.firestore,new iv(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return Pv(this._delegate,r,i)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=ad(e,ld);var t=ad(e.firestore,bd),n=_d(t),r=new Iv(t);return function(e,t){var n=this,r=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var n;return ea(this,(function(i){switch(i.label){case 0:return n=function(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i;return ea(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(e,t){var n=pa(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.Mn.mn(e,t)}))}(e,t)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new ia(ra.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=xf(r,"Failed to get document '"+t+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Up(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(n,e._key).then((function(n){return new iv(t,r,e._key,n,new rv(null!==n&&n.hasLocalMutations,!0),e.converter)}))}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=ad(e,ld);var t=ad(e.firestore,bd);return Gp(_d(t),e._key,{source:"server"}).then((function(n){return Nv(t,e,n)}))}(this._delegate):function(e){e=ad(e,ld);var t=ad(e.firestore,bd);return Gp(_d(t),e._key).then((function(n){return Nv(t,e,n)}))}(this._delegate)).then((function(e){return new Wv(t.firestore,new iv(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Vv.eu(this.firestore,t)):this._delegate.withConverter(null))},e}();function Bv(e,t,n){return e.message=e.message.replace(t,n),e}function Gv(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!gd(r))return r}return{}}function Kv(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=gd(e[0])?e[0]:gd(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Wv=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"ref",{get:function(){return new qv(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(e){return this._delegate.data(e)},e.prototype.get=function(e,t){return this._delegate.get(e,t)},e.prototype.isEqual=function(e){return uv(this._delegate,e._delegate)},e}(),zv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jo(t,e),t.prototype.data=function(e){return this._delegate.data(e)},t}(Wv),Hv=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fv(e)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,hv(this._delegate,function(e,t,n){var r=t,i=nv("where",e);return new fv(i,r,n)}(t,n,r)))}catch(t){throw Bv(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,hv(this._delegate,function(e,t){void 0===t&&(t="asc");var n=t,r=nv("orderBy",e);return new pv(r,n)}(t,n)))}catch(t){throw Bv(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,hv(this._delegate,function(e){return sd("limit",e),new dv("limit",e,"F")}(t)))}catch(t){throw Bv(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,hv(this._delegate,function(e){return sd("limitToLast",e),new dv("limitToLast",e,"L")}(t)))}catch(t){throw Bv(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hv(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new vv("startAt",e,!0)}.apply(void 0,t)))}catch(t){throw Bv(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hv(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new vv("startAfter",e,!1)}.apply(void 0,t)))}catch(t){throw Bv(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hv(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new yv("endBefore",e,!0)}.apply(void 0,t)))}catch(t){throw Bv(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,hv(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new yv("endAt",e,!1)}.apply(void 0,t)))}catch(t){throw Bv(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(e){return yd(this._delegate,e._delegate)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=ad(e,hd);var t=ad(e.firestore,bd),n=_d(t),r=new Iv(t);return function(e,t){var n=this,r=new Wc;return e.asyncQueue.enqueueAndForget((function(){return Zo(n,void 0,void 0,(function(){var n;return ea(this,(function(i){switch(i.label){case 0:return n=function(e,t,n){return Zo(this,void 0,void 0,(function(){var r,i,o,a,s;return ea(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,gh(e,t,!0)];case 1:return s=u.sent(),r=new Wf(t,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=xf(a,"Failed to execute query '"+t+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,Up(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(n,e._query).then((function(n){return new av(t,r,e,n)}))}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=ad(e,hd);var t=ad(e.firestore,bd),n=_d(t),r=new Iv(t);return Kp(n,e._query,{source:"server"}).then((function(n){return new av(t,r,e,n)}))}(this._delegate):function(e){e=ad(e,hd);var t=ad(e.firestore,bd),n=_d(t),r=new Iv(t);return cv(e._query),Kp(n,e._query).then((function(n){return new av(t,r,e,n)}))}(this._delegate)).then((function(e){return new $v(t.firestore,new av(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Gv(t),i=Kv(t,(function(t){return new $v(e.firestore,new av(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return Pv(this._delegate,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Vv.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(),Qv=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new zv(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),$v=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"query",{get:function(){return new Hv(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map((function(t){return new zv(e._firestore,t)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new Qv(t._firestore,e)}))},e.prototype.forEach=function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new zv(n._firestore,r))}))},e.prototype.isEqual=function(e){return uv(this._delegate,e._delegate)},e}(),Yv=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).firestore=t,r._delegate=n,r}return Jo(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new qv(this.firestore,e):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(e){try{return new qv(this.firestore,void 0===e?dd(this._delegate):dd(this._delegate,e))}catch(e){throw Bv(e,"doc()","CollectionReference.doc()")}},t.prototype.add=function(e){var t=this;return function(e,t){var n=ad(e.firestore,bd),r=dd(e),i=Tv(e.converter,t);return Rv(n,[Md(Od(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,nu.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new qv(t.firestore,e)}))},t.prototype.isEqual=function(e){return vd(this._delegate,e._delegate)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Vv.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(Hv);function Xv(e){return ad(e,ld)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jv,Zv=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._delegate=new(Sd.bind.apply(Sd,ta([void 0],e)))}return e.documentId=function(){return new e(ka.keyField().canonicalString())},e.prototype.isEqual=function(e){return(e=ot(e))instanceof Sd&&this._delegate._internalPath.isEqual(e._internalPath)},e}(),ey=function(){function e(e){this._delegate=e}return e.serverTimestamp=function(){var t=new jd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Ld("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Ud("arrayUnion",e)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Vd("arrayRemove",e)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(e){return new qd("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e}(),ty={Firestore:Lv,GeoPoint:kd,Timestamp:ba,Blob:Ov,Transaction:jv,WriteBatch:Uv,DocumentReference:qv,DocumentSnapshot:Wv,Query:Hv,QueryDocumentSnapshot:zv,QuerySnapshot:$v,CollectionReference:Yv,FieldPath:Zv,FieldValue:ey,setLogLevel:function(e){var t;t=e,oa.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(e,t){e.INTERNAL.registerComponent(new ht("firestore",(function(e){return function(e,t){return new Lv(e,new bd(e,t),new Mv)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},ty)))})(Jv=Ft),Jv.registerVersion("@firebase/firestore","2.3.7");
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var ny=function(e,t){return(ny=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function ry(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ny(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var iy=function(){return(iy=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function oy(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function ay(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function sy(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function uy(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function cy(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}var ly="";function hy(e){ly=e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fy=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ke(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Ge(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),py=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return ze(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),dy=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new fy(t)}}catch(e){}return new py},vy=dy("localStorage"),yy=dy("sessionStorage"),my=new Ct("@firebase/database"),gy=function(){var e=1;return function(){return e++}}(),by=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,Ee(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Ye;n.update(t);var r=n.digest();return Pe.encodeByteArray(r)},_y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=_y.apply(null,i):n+="object"==typeof i?Ke(i):i,n+=" "}return n},wy=null,Ty=!0,Cy=function(e,t){Ee(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(my.logLevel=yt.VERBOSE,wy=my.log.bind(my),t&&yy.set("logging_enabled",!0)):"function"==typeof e?wy=e:(wy=null,yy.remove("logging_enabled"))},Sy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===Ty&&(Ty=!1,null===wy&&!0===yy.get("logging_enabled")&&Cy(!0)),wy){var n=_y.apply(null,e);wy(n)}},Ey=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Sy.apply(void 0,cy([e],uy(t)))}},Iy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+_y.apply(void 0,cy([],uy(e)));my.error(n)},ky=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+_y.apply(void 0,cy([],uy(e)));throw my.error(n),new Error(n)},Py=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+_y.apply(void 0,cy([],uy(e)));my.warn(n)},Ry=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ny="[MIN_NAME]",xy="[MAX_NAME]",Ay=function(e,t){if(e===t)return 0;if(e===Ny||t===xy)return-1;if(t===Ny||e===xy)return 1;var n=Vy(e),r=Vy(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},Dy=function(e,t){return e===t?0:e<t?-1:1},Oy=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ke(t))},My=function(e){if("object"!=typeof e||null===e)return Ke(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=Ke(t[i]),r+=":",r+=My(e[t[i]]);return r+="}"},Ly=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fy(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var jy=function(e){Ee(!Ry(e),"Invalid JSON number");var t,n,r,i,o;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();var s=a.join(""),u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()};var Uy=new RegExp("^-?(0*)\\d{1,10}$"),Vy=function(e){if(Uy.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},qy=function(e){try{e()}catch(e){setTimeout((function(){var t=e.stack||"";throw Py("Exception was thrown by user callback.",t),e}),Math.floor(0))}},By=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},Gy=function(){function e(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((function(e){return n.appCheck=e}))}return e.prototype.getToken=function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){Py('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},e}(),Ky=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(e){return r.auth_=e}))}return e.prototype.getToken=function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(Sy("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Py(e)},e}(),Wy=function(){function e(e){this.accessToken=e}return e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.OWNER="owner",e}(),zy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Hy=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vy.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vy.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+t},e}();function Qy(e,t,n){var r;if(Ee("string"==typeof t,"typeof type must == string"),Ee("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return Fy(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $y=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),ze(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Ne(this.counters_)},e}(),Yy={},Xy={};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jy(e){var t=e.toString();return Yy[t]||(Yy[t]=new $y),Yy[t]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Zy=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&qy((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},e}(),em=function(){function e(e,t,n,r,i,o,a){var s=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ey(e),this.stats_=Jy(t),this.urlFn=function(e){return s.appCheckToken&&(e.ac=s.appCheckToken),Qy(t,"long_polling",e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Zy(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new tm((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=uy(e,5),i=r[0],o=r[1],a=r[2];r[3],r[4];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=o,n.password=a;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=uy(e,2),i=r[0],o=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&zy.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!!e.forceAllow_||!(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Ke(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n,r=(n=ke(t),Pe.encodeByteArray(n,!0)),i=Ly(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},e.prototype.incrementIncomingBytes_=function(e){var t=Ke(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),tm=function(){function e(t,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=gy(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(e){Sy("frame writing exception"),e.stack&&Sy(e.stack),Sy(e)}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Sy("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))},e.prototype.addTag=function(e,t){var n=this;setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){Sy("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(e){}}),Math.floor(1))},e}(),nm=null;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */"undefined"!=typeof MozWebSocket?nm=MozWebSocket:"undefined"!=typeof WebSocket&&(nm=WebSocket);var rm=function(){function e(t,n,r,i,o,a,s){this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ey(this.connId),this.stats_=Jy(n),this.connURL=e.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return e.connectionURL_=function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&zy.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),Qy(e,"websocket",i)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vy.set("previous_websocket_failure",!0);try{if(je()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+ly+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.nodeAdmin?i.headers.Authorization=this.authToken||"":i.headers["X-Firebase-AppCheck"]=this.appCheckToken||"";var o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new nm(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new nm(this.connURL,[],i)}}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==nm&&!e.forceDisallow_},e.previouslyFailed=function(){return vy.isInMemoryStorage||!0===vy.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){vy.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Ge(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(Ee(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Ke(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=Ly(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),im=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[em,rm]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=rm&&rm.isAvailable(),o=i&&!rm.previouslyFailed();if(t.webSocketOnly&&(i||Py("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[rm];else{var a=this.transports_=[];try{for(var s=sy(e.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var c=u.value;c&&c.isAvailable()&&a.push(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),om=function(){function e(e,t,n,r,i,o,a,s,u,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ey("c:"+this.id+":"),this.transportManager_=new im(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=By((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=Oy("t",e),n=Oy("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=Oy("t",e),n=Oy("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=Oy("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Iy("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Iy("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Py("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),By((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):By((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vy.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),am=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.refreshAppCheckToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),sm=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=cy([],uy(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Ee(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},e}(),um=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Me()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return ry(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Ee("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(sm),cm=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lm(){return new cm("")}function hm(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function fm(e){return e.pieces_.length-e.pieceNum_}function pm(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new cm(e.pieces_,t)}function dm(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function vm(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function ym(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new cm(t,0)}function mm(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof cm)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new cm(n,0)}function gm(e){return e.pieceNum_>=e.pieces_.length}function bm(e,t){var n=hm(e),r=hm(t);if(null===n)return t;if(n===r)return bm(pm(e),pm(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function _m(e,t){for(var n=vm(e,0),r=vm(t,0),i=0;i<n.length&&i<r.length;i++){var o=Ay(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function wm(e,t){if(fm(e)!==fm(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Tm(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(fm(e)>fm(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Cm=function(e,t){this.errorPrefix_=t,this.parts_=vm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=it(this.parts_[n]);Sm(this)};function Sm(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Em(e))}function Em(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Im,km,Pm=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))}),!1),r}return ry(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Ee("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(sm),Rm=function(e){function t(n,r,i,o,a,s,u,c){var l=e.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=o,l.onServerInfoUpdate_=a,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=t.nextPersistentConnectionId_++,l.log_=Ey("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=1e3,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!je())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Pm.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&um.getInstance().on("online",l.onOnline_,l),l}return ry(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Ke(i)),Ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this;this.initConnection_();var n=new Ae,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise},t.prototype.listen=function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ee(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;t.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))}))},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&ze(e,"w")){var n=He(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();Py("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){var t;(e&&40===e.length||"object"==typeof(t=We(e).claims)&&!0===t.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},t.prototype.tryAuth=function(){var e,t=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(e=We(n).claims)&&"object"==typeof e&&e.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,(function(e){var r=e.s,i=e.d||"error";t.authToken_===n&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},t.prototype.tryAppCheck=function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Ke(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Iy("Unrecognized action received from server: "+Ke(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},t.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){return oy(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,v=this;return ay(this,(function(y){switch(y.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,s=null,u=function(){s?s.close():(a=!0,r())},c=function(e){Ee(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)},this.realtime_={close:u,sendRequest:c},l=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)])];case 2:return h=uy.apply(void 0,[y.sent(),2]),f=h[0],p=h[1],a?Sy("getToken() completed but was canceled"):(Sy("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=p&&p.token,s=new om(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,(function(e){Py(e+" ("+v.repoInfo_.toString()+")"),v.interrupt("server_kill")}),o)),[3,4];case 3:return d=y.sent(),this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&Py(d),u()),[3,4];case 4:return[2]}}))}))},t.prototype.interrupt=function(e){Sy("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){Sy("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Qe(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map((function(e){return My(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new cm(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){Sy("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onAppCheckRevoked_=function(e,t){Sy("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=sy(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,sy(a.values())),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},t.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+ly.replace(/\./g,"-")]=1,Me()?e["framework.cordova"]=1:Fe()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=um.getInstance().currentlyOnline();return Qe(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(am),Nm=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),xm=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new Nm(Ny,e),r=new Nm(Ny,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return Nm.MIN},e}(),Am=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Im},set:function(e){Im=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return Ay(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Ie("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return Nm.MIN},t.prototype.maxPost=function(){return new Nm(xy,Im)},t.prototype.makePost=function(e,t){return Ee("string"==typeof e,"KeyIndex indexValue must always be a string."),new Nm(e,Im)},t.prototype.toString=function(){return".key"},t}(xm),Dm=new Am,Om=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Mm=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:Fm.EMPTY_NODE,this.right=null!=o?o:Fm.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Fm.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Fm.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Lm=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Mm(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Fm=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Mm.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Mm.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Om(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Om(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Om(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Om(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Lm,e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function jm(e,t){return Ay(e.name,t.name)}function Um(e,t){return Ay(e,t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Vm,qm,Bm,Gm=function(e){return"number"==typeof e?"number:"+jy(e):"string:"+e},Km=function(e){if(e.isLeafNode()){var t=e.val();Ee("string"==typeof t||"number"==typeof t||"object"==typeof t&&ze(t,".sv"),"Priority must be a string or number.")}else Ee(e===km||e.isEmpty(),"priority of unexpected type.");Ee(e===km||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Wm=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Ee(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Km(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return Vm},set:function(e){Vm=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return gm(t)?this:".priority"===hm(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=hm(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Ee(".priority"!==r||1===fm(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(pm(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Gm(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?jy(this.value_):this.value_,this.lazyHash_=by(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Ee(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return Ee(i>=0,"Unknown leaf type: "+n),Ee(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();var zm,Hm,Qm=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Ay(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return Nm.MIN},t.prototype.maxPost=function(){return new Nm(xy,new Wm("[PRIORITY-POST]",Bm))},t.prototype.makePost=function(e,t){var n=qm(e);return new Nm(t,new Wm("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(xm)),$m=Math.log(2),Ym=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/$m,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Xm=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,a,s=r-t;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Mm(a,o.node,Mm.BLACK,null,null);var u=parseInt(s/2,10)+t,c=i(t,u),l=i(u+1,r);return o=e[u],a=n?n(o):o,new Mm(a,o.node,Mm.BLACK,c,l)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var c=i(o+1,s),l=e[o],h=n?n(l):l;u(new Mm(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,Mm.BLACK):(s(h,Mm.BLACK),s(h,Mm.RED))}return o}(new Ym(e.length));return new Fm(r||t,o)},Jm={},Zm=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Ee(Jm&&Qm,"ChildrenNode.ts has not been loaded"),zm=zm||new e({".priority":Jm},{".priority":Qm})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=He(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fm?t:null},e.prototype.hasIndex=function(e){return ze(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Ee(t!==Dm,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(Nm.Wrap),s=a.getNext();s;)o=o||t.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?Xm(i,t.getCompare()):Jm;var u=t.toString(),c=iy({},this.indexSet_);c[u]=t;var l=iy({},this.indexes_);return l[u]=r,new e(l,c)},e.prototype.addToIndexes=function(t,n){var r=this;return new e($e(this.indexes_,(function(e,i){var o=He(r.indexSet_,i);if(Ee(o,"Missing index implementation for "+i),e===Jm){if(o.isDefinedOn(t.node)){for(var a=[],s=n.getIterator(Nm.Wrap),u=s.getNext();u;)u.name!==t.name&&a.push(u),u=s.getNext();return a.push(t),Xm(a,o.getCompare())}return Jm}var c=n.get(t.name),l=e;return c&&(l=l.remove(new Nm(t.name,c))),l.insert(t,t.node)})),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e($e(this.indexes_,(function(e){if(e===Jm)return e;var r=n.get(t.name);return r?e.remove(new Nm(t.name,r)):e})),this.indexSet_)},e}(),eg=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Km(this.priorityNode_),this.children_.isEmpty()&&Ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return Hm||(Hm=new e(new Fm(Um),null,Zm.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||Hm},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Hm:t},e.prototype.getChild=function(e){var t=hm(e);return null===t?this:this.getImmediateChild(t).getChild(pm(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Ee(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new Nm(t,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?Hm:this.priorityNode_;return new e(i,a,o)},e.prototype.updateChild=function(e,t){var n=hm(e);if(null===n)return t;Ee(".priority"!==hm(e)||1===fm(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(pm(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Qm,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Gm(this.getPriority().val())+":"),this.forEachChild(Qm,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":by(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Nm(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new Nm(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new Nm(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Nm.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Nm.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===tg?-1:0},e.prototype.withIndex=function(t){if(t===Dm||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Dm||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Qm),r=t.getIterator(Qm),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Dm?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),tg=new(function(e){function t(){return e.call(this,new Fm(Um),eg.EMPTY_NODE,Zm.Default)||this}return ry(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return eg.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(eg));Object.defineProperties(Nm,{MIN:{value:new Nm(Ny,eg.EMPTY_NODE)},MAX:{value:new Nm(xy,tg)}}),Am.__EMPTY_NODE=eg.EMPTY_NODE,Wm.__childrenNodeConstructor=eg,km=tg,function(e){Bm=e}(tg);function ng(e,t){if(void 0===t&&(t=null),null===e)return eg.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Ee(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Wm(e,ng(t));if(e instanceof Array){var n=eg.EMPTY_NODE;return Fy(e,(function(t,r){if(ze(e,t)&&"."!==t.substring(0,1)){var i=ng(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(ng(t))}var r=[],i=!1;if(Fy(e,(function(e,t){if("."!==e.substring(0,1)){var n=ng(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Nm(e,n)))}})),0===r.length)return eg.EMPTY_NODE;var o=Xm(r,jm,(function(e){return e.name}),Um);if(i){var a=Xm(r,Qm.getCompare());return new eg(o,ng(t),new Zm({".priority":a},{".priority":Qm}))}return new eg(o,ng(t),Zm.Default)}!function(e){qm=e}(ng);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var rg,ig,og=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Ee(!gm(t)&&".priority"!==hm(t),"Can't create PathIndex with empty path or .priority key"),n}return ry(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Ay(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=ng(e),r=eg.EMPTY_NODE.updateChild(this.indexPath_,n);return new Nm(t,r)},t.prototype.maxPost=function(){var e=eg.EMPTY_NODE.updateChild(this.indexPath_,tg);return new Nm(xy,e)},t.prototype.toString=function(){return vm(this.indexPath_,0).join("/")},t}(xm),ag=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?Ay(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return Nm.MIN},t.prototype.maxPost=function(){return Nm.MAX},t.prototype.makePost=function(e,t){var n=ng(e);return new Nm(t,n)},t.prototype.toString=function(){return".value"},t}(xm)),sg="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ug=(rg=0,ig=[],function(e){var t,n=e===rg;rg=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=sg.charAt(e%64),e=Math.floor(e/64);Ee(0===e,"Cannot push at time == 0");var i=r.join("");if(n){for(t=11;t>=0&&63===ig[t];t--)ig[t]=0;ig[t]++}else for(t=0;t<12;t++)ig[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)i+=sg.charAt(ig[t]);return Ee(20===i.length,"nextPushId: Length should be 20."),i}),cg=function(e){if("2147483647"===e)return"-";var t=Vy(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return xy;var o=n[i],a=sg.charAt(sg.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},lg=function(e){if("-2147483648"===e)return Ny;var t=Vy(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=sg.charAt(sg.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function hg(e){return{type:"value",snapshotNode:e}}function fg(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function pg(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function dg(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var vg=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){Ee(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(pg(t,a)):Ee(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(fg(t,n)):o.trackChildChange(dg(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Qm,(function(e,r){t.hasChild(e)||n.trackChildChange(pg(e,r))})),t.isLeafNode()||t.forEachChild(Qm,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(dg(t,r,i))}else n.trackChildChange(fg(t,r))}))),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?eg.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),yg=function(){function e(t){this.indexedFilter_=new vg(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new Nm(t,n))||(n=eg.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=eg.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(eg.EMPTY_NODE);var i=this;return t.forEachChild(Qm,(function(e,t){i.matches(new Nm(e,t))||(r=r.updateImmediateChild(e,eg.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),mg=function(){function e(e){this.rangedFilter_=new yg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Nm(t,n))||(n=eg.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=eg.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=eg.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(eg.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(e,t){return l(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,eg.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;Ee(s.numChildren()===this.limit_,"");var u=new Nm(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(l&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(dg(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(pg(t,h));var d=s.updateImmediateChild(t,eg.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(fg(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?e:l&&o(c,u)>=0?(null!=i&&(i.trackChildChange(pg(c.name,c.node)),i.trackChildChange(fg(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,eg.EMPTY_NODE)):e},e}(),gg=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qm}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ny},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xy},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Ee(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Qm},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bg(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function _g(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function wg(e,t){var n=e.copy();return n.index_=t,n}function Tg(e){var t,n={};return e.isDefault()||(e.index_===Qm?t="$priority":e.index_===ag?t="$value":e.index_===Dm?t="$key":(Ee(e.index_ instanceof og,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Ke(t),e.startSet_&&(n.startAt=Ke(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+Ke(e.indexStartName_))),e.endSet_&&(n.endAt=Ke(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+Ke(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function Cg(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Qm&&(t.i=e.index_.toString()),t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sg=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=Ey("p:rest:"),o.listens_={},o}return ry(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);var s=t.getListenId_(e,r),u={};this.listens_[s]=u;var c=Tg(e._queryParams);this.restRequest_(a+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),He(o.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=Tg(e._queryParams),r=e._path.toString(),i=new Ae;return this.restRequest_(r+".json",n,(function(e,n){var o=n;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;return void 0===t&&(t={}),t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var o=uy(i,2),a=o[0],s=o[1];a&&a.accessToken&&(t.auth=a.accessToken),s&&s.token&&(t.ac=s.token);var u=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""}(t);r.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(n&&4===c.readyState){r.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=Ge(c.responseText)}catch(e){Py("Failed to parse JSON response for "+u+": "+c.responseText)}n(null,e)}else 401!==c.status&&404!==c.status&&Py("Got unsuccessful REST response for "+u+" Status: "+c.status),n(c.status);n=null}},c.open("GET",u,!0),c.send()}))},t}(am),Eg=function(){function e(){this.rootNode_=eg.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ig(){return{value:null,children:new Map}}function kg(e,t,n){if(gm(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=hm(t);e.children.has(r)||e.children.set(r,Ig()),kg(e.children.get(r),t=pm(t),n)}}function Pg(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,(function(e,r){Pg(r,new cm(t.toString()+"/"+e),n)}))}var Rg,Ng=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=iy({},e);return this.last_&&Fy(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},e}(),xg=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ng(e);var n=1e4+2e4*Math.random();By(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;Fy(t,(function(t,i){i>0&&ze(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),By(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ag(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Rg||(Rg={}));var Dg,Og=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Rg.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e.prototype.operationForChild=function(t){if(gm(this.path)){if(null!=this.affectedTree.value)return Ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new cm(t));return new e(lm(),n,this.revert)}return Ee(hm(this.path)===t,"operationForChild called for unrelated child."),new e(pm(this.path),this.affectedTree,this.revert)},e}(),Mg=function(){function e(e,t){this.source=e,this.path=t,this.type=Rg.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return gm(this.path)?new e(this.source,lm()):new e(this.source,pm(this.path))},e}(),Lg=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Rg.OVERWRITE}return e.prototype.operationForChild=function(t){return gm(this.path)?new e(this.source,lm(),this.snap.getImmediateChild(t)):new e(this.source,pm(this.path),this.snap)},e}(),Fg=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Rg.MERGE}return e.prototype.operationForChild=function(t){if(gm(this.path)){var n=this.children.subtree(new cm(t));return n.isEmpty()?null:n.value?new Lg(this.source,lm(),n.value):new e(this.source,lm(),n)}return Ee(hm(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,pm(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),jg=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(gm(e))return this.isFullyInitialized()&&!this.filtered_;var t=hm(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Ug=function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vg(e,t,n,r,i,o){var a=r.filter((function(e){return e.type===n}));a.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Ie("Should only compare child_ events.");var r=new Nm(t.childName,t.snapshotNode),i=new Nm(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t,n)})),a.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function qg(e,t){return{eventCache:e,serverCache:t}}function Bg(e,t,n,r){return qg(new jg(t,n,r),e.serverCache)}function Gg(e,t,n,r){return qg(e.eventCache,new jg(t,n,r))}function Kg(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Wg(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zg=function(){function e(e,t){void 0===t&&(Dg||(Dg=new Fm(Dy)),t=Dg),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return Fy(t,(function(e,t){n=n.set(new cm(e),t)})),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:lm(),value:this.value};if(gm(e))return null;var n=hm(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(pm(e),t);return null!=i?{path:mm(new cm(n),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},e.prototype.subtree=function(t){if(gm(t))return this;var n=hm(t),r=this.children.get(n);return null!==r?r.subtree(pm(t)):new e(null)},e.prototype.set=function(t,n){if(gm(t))return new e(n,this.children);var r=hm(t),i=(this.children.get(r)||new e(null)).set(pm(t),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(gm(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=hm(t),r=this.children.get(n);if(r){var i=r.remove(pm(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(gm(e))return this.value;var t=hm(e),n=this.children.get(t);return n?n.get(pm(e)):null},e.prototype.setTree=function(t,n){if(gm(t))return n;var r=hm(t),i=(this.children.get(r)||new e(null)).setTree(pm(t),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(lm(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(mm(e,r),t)})),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,lm(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(gm(e))return null;var i=hm(e),o=this.children.get(i);return o?o.findOnPath_(pm(e),mm(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,lm(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(gm(t))return this;this.value&&r(n,this.value);var i=hm(t),o=this.children.get(i);return o?o.foreachOnPath_(pm(t),mm(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(lm(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(mm(e,n),t)})),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},e}(),Hg=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new zg(null))},e}();function Qg(e,t,n){if(gm(t))return new Hg(new zg(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=bm(i,t);return o=o.updateChild(a,n),new Hg(e.writeTree_.set(i,o))}var s=new zg(n),u=e.writeTree_.setTree(t,s);return new Hg(u)}function $g(e,t,n){var r=e;return Fy(n,(function(e,n){r=Qg(r,mm(t,e),n)})),r}function Yg(e,t){if(gm(t))return Hg.empty();var n=e.writeTree_.setTree(t,new zg(null));return new Hg(n)}function Xg(e,t){return null!=Jg(e,t)}function Jg(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(bm(n.path,t)):null}function Zg(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Qm,(function(e,n){t.push(new Nm(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Nm(e,n.value))})),t}function eb(e,t){if(gm(t))return e;var n=Jg(e,t);return new Hg(null!=n?new zg(n):e.writeTree_.subtree(t))}function tb(e){return e.writeTree_.isEmpty()}function nb(e,t){return function e(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal((function(n,o){".priority"===n?(Ee(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e(mm(t,n),o,r)})),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(mm(t,".priority"),i)),r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(lm(),e.writeTree_,t)}function rb(e,t){return yb(t,e)}function ib(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));Ee(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,o=!1,a=e.allWrites.length-1;i&&a>=0;){var s=e.allWrites[a];s.visible&&(a>=n&&ob(s,r.path)?i=!1:Tm(r.path,s.path)&&(o=!0)),a--}if(i){if(o)return function(e){e.visibleWrites=sb(e.allWrites,ab,lm()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Yg(e.visibleWrites,r.path):Fy(r.children,(function(t){e.visibleWrites=Yg(e.visibleWrites,mm(r.path,t))}));return!0}return!1}function ob(e,t){if(e.snap)return Tm(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Tm(mm(e.path,n),t))return!0;return!1}function ab(e){return e.visible}function sb(e,t,n){for(var r=Hg.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)Tm(n,a)?r=Qg(r,s=bm(n,a),o.snap):Tm(a,n)&&(s=bm(a,n),r=Qg(r,lm(),o.snap.getChild(s)));else{if(!o.children)throw Ie("WriteRecord should have .snap or .children");if(Tm(n,a))r=$g(r,s=bm(n,a),o.children);else if(Tm(a,n))if(gm(s=bm(a,n)))r=$g(r,lm(),o.children);else{var u=He(o.children,hm(s));if(u){var c=u.getChild(pm(s));r=Qg(r,lm(),c)}}}}}return r}function ub(e,t,n,r,i){if(r||i){var o=eb(e.visibleWrites,t);if(!i&&tb(o))return n;if(i||null!=n||Xg(o,lm())){return nb(sb(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Tm(e.path,t)||Tm(t,e.path))}),t),n||eg.EMPTY_NODE)}return null}var a=Jg(e.visibleWrites,t);if(null!=a)return a;var s=eb(e.visibleWrites,t);return tb(s)?n:null!=n||Xg(s,lm())?nb(s,n||eg.EMPTY_NODE):null}function cb(e,t,n,r){return ub(e.writeTree,e.treePath,t,n,r)}function lb(e,t){return function(e,t,n){var r=eg.EMPTY_NODE,i=Jg(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Qm,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=eb(e.visibleWrites,t);return n.forEachChild(Qm,(function(e,t){var n=nb(eb(o,new cm(e)),t);r=r.updateImmediateChild(e,n)})),Zg(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Zg(eb(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function hb(e,t,n,r){return function(e,t,n,r,i){Ee(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=mm(t,n);if(Xg(e.visibleWrites,o))return null;var a=eb(e.visibleWrites,o);return tb(a)?i.getChild(n):nb(a,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function fb(e,t){return function(e,t){return Jg(e.visibleWrites,t)}(e.writeTree,mm(e.treePath,t))}function pb(e,t,n,r,i,o){return function(e,t,n,r,i,o,a){var s,u=eb(e.visibleWrites,t),c=Jg(u,lm());if(null!=c)s=c;else{if(null==n)return[];s=nb(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),p=f.getNext();p&&l.length<i;)0!==h(p,r)&&l.push(p),p=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,o)}function db(e,t,n){return function(e,t,n,r){var i=mm(t,n),o=Jg(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?nb(eb(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function vb(e,t){return yb(mm(e.treePath,t),e.writeTree)}function yb(e,t){return{treePath:e,writeTree:t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mb=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Ee("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Ee(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,dg(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,pg(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,fg(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ie("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,dg(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),gb=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),bb=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new jg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return db(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Wg(this.viewCache_),i=pb(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _b(e,t,n,r,i){var o,a,s=new mb;if(n.type===Rg.OVERWRITE){var u=n;u.source.fromUser?o=Cb(e,t,u.path,u.snap,r,i,s):(Ee(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.serverCache.isFiltered()&&!gm(u.path),o=Tb(e,t,u.path,u.snap,r,i,a,s))}else if(n.type===Rg.MERGE){var c=n;c.source.fromUser?o=function(e,t,n,r,i,o,a){var s=t;return r.foreach((function(r,u){var c=mm(n,r);Sb(t,hm(c))&&(s=Cb(e,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=mm(n,r);Sb(t,hm(c))||(s=Cb(e,s,c,u,i,o,a))})),s}(e,t,c.path,c.children,r,i,s):(Ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=Ib(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Rg.ACK_USER_WRITE){var l=n;o=l.revert?function(e,t,n,r,i,o){var a;if(null!=fb(r,n))return t;var s=new bb(r,t,i),u=t.eventCache.getNode(),c=void 0;if(gm(n)||".priority"===hm(n)){var l=void 0;if(t.serverCache.isFullyInitialized())l=cb(r,Wg(t));else{var h=t.serverCache.getNode();Ee(h instanceof eg,"serverChildren would be complete if leaf node"),l=lb(r,h)}l=l,c=e.filter.updateFullNode(u,l,o)}else{var f=hm(n),p=db(r,f,t.serverCache);null==p&&t.serverCache.isCompleteForChild(f)&&(p=u.getImmediateChild(f)),(c=null!=p?e.filter.updateChild(u,f,p,pm(n),s,o):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(u,f,eg.EMPTY_NODE,pm(n),s,o):u).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=cb(r,Wg(t))).isLeafNode()&&(c=e.filter.updateFullNode(c,a,o))}return a=t.serverCache.isFullyInitialized()||null!=fb(r,lm()),Bg(t,c,a,e.filter.filtersNodes())}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t,l.path,r,i,s):function(e,t,n,r,i,o,a){if(null!=fb(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(gm(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Tb(e,t,n,u.getNode().getChild(n),i,o,s,a);if(gm(n)){var c=new zg(null);return u.getNode().forEachChild(Dm,(function(e,t){c=c.set(new cm(e),t)})),Ib(e,t,n,c,i,o,s,a)}return t}var l=new zg(null);return r.foreach((function(e,t){var r=mm(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),Ib(e,t,n,l,i,o,s,a)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==Rg.LISTEN_COMPLETE)throw Ie("Unknown operation type: "+n.type);o=function(e,t,n,r,i){var o=t.serverCache,a=Gg(t,o.getNode(),o.isFullyInitialized()||gm(n),o.isFiltered());return wb(e,a,n,r,gb,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Kg(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(hg(Kg(t)))}}(t,o,h),{viewCache:o,changes:h}}function wb(e,t,n,r,i,o){var a=t.eventCache;if(null!=fb(r,n))return t;var s=void 0,u=void 0;if(gm(n))if(Ee(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=Wg(t),l=lb(r,c instanceof eg?c:eg.EMPTY_NODE);s=e.filter.updateFullNode(t.eventCache.getNode(),l,o)}else{var h=cb(r,Wg(t));s=e.filter.updateFullNode(t.eventCache.getNode(),h,o)}else{var f=hm(n);if(".priority"===f){Ee(1===fm(n),"Can't have a priority with additional path components");var p=a.getNode(),d=hb(r,n,p,u=t.serverCache.getNode());s=null!=d?e.filter.updatePriority(p,d):a.getNode()}else{var v=pm(n),y=void 0;if(a.isCompleteForChild(f)){u=t.serverCache.getNode();var m=hb(r,n,a.getNode(),u);y=null!=m?a.getNode().getImmediateChild(f).updateChild(v,m):a.getNode().getImmediateChild(f)}else y=db(r,f,t.serverCache);s=null!=y?e.filter.updateChild(a.getNode(),f,y,v,i,o):a.getNode()}}return Bg(t,s,a.isFullyInitialized()||gm(n),e.filter.filtersNodes())}function Tb(e,t,n,r,i,o,a,s){var u,c=t.serverCache,l=a?e.filter:e.filter.getIndexedFilter();if(gm(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=hm(n);if(!c.isCompleteForPath(n)&&fm(n)>1)return t;var p=pm(n),d=c.getNode().getImmediateChild(f).updateChild(p,r);u=".priority"===f?l.updatePriority(c.getNode(),d):l.updateChild(c.getNode(),f,d,p,gb,null)}var v=Gg(t,u,c.isFullyInitialized()||gm(n),l.filtersNodes());return wb(e,v,n,i,new bb(i,v,o),s)}function Cb(e,t,n,r,i,o,a){var s,u,c=t.eventCache,l=new bb(i,t,o);if(gm(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=Bg(t,u,!0,e.filter.filtersNodes());else{var h=hm(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=Bg(t,u,c.isFullyInitialized(),c.isFiltered());else{var f=pm(n),p=c.getNode().getImmediateChild(h),d=void 0;if(gm(f))d=r;else{var v=l.getCompleteChild(h);d=null!=v?".priority"===dm(f)&&v.getChild(ym(f)).isEmpty()?v:v.updateChild(f,r):eg.EMPTY_NODE}if(p.equals(d))s=t;else s=Bg(t,e.filter.updateChild(c.getNode(),h,d,f,l,a),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function Sb(e,t){return e.eventCache.isCompleteForChild(t)}function Eb(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Ib(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=gm(n)?r:new zg(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=Eb(0,t.serverCache.getNode().getImmediateChild(n),r);c=Tb(e,c,new cm(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=Eb(0,t.serverCache.getNode().getImmediateChild(n),r);c=Tb(e,c,new cm(n),h,i,o,a,s)}})),c}var kb,Pb=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new vg(r.getIndex()),o=(n=r).loadsAllData()?new vg(n.getIndex()):n.hasLimit()?new mg(n):new yg(n);this.processor_=
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){return{filter:e}}(o);var a=t.serverCache,s=t.eventCache,u=i.updateFullNode(eg.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(eg.EMPTY_NODE,s.getNode(),null),l=new jg(u,a.isFullyInitialized(),i.filtersNodes()),h=new jg(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=qg(h,l),this.eventGenerator_=new Ug(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function Rb(e,t){var n=Wg(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!gm(t)&&!n.getImmediateChild(hm(t)).isEmpty())?n.getChild(t):null}function Nb(e){return 0===e.eventRegistrations_.length}function xb(e,t,n){var r=[];if(n){Ee(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var o=[],a=0;a<e.eventRegistrations_.length;++a){var s=e.eventRegistrations_[a];if(s.matches(t)){if(t.hasAnyCallback()){o=o.concat(e.eventRegistrations_.slice(a+1));break}}else o.push(s)}e.eventRegistrations_=o}else e.eventRegistrations_=[];return r}function Ab(e,t,n,r){t.type===Rg.MERGE&&null!==t.source.queryId&&(Ee(Wg(e.viewCache_),"We should always have a full cache before handling merges"),Ee(Kg(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,o,a=e.viewCache_,s=_b(e.processor_,a,t,n,r);return i=e.processor_,o=s.viewCache,Ee(o.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),Ee(o.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),Ee(s.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Db(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Db(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],o=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Vg(e,i,"child_removed",t,r,n),Vg(e,i,"child_added",t,r,n),Vg(e,i,"child_moved",o,r,n),Vg(e,i,"child_changed",t,r,n),Vg(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ob,Mb=function(){this.views=new Map};function Lb(e,t,n,r){var i,o,a=t.source.queryId;if(null!==a){var s=e.views.get(a);return Ee(null!=s,"SyncTree gave us an op for an invalid query."),Ab(s,t,n,r)}var u=[];try{for(var c=sy(e.views.values()),l=c.next();!l.done;l=c.next()){s=l.value;u=u.concat(Ab(s,t,n,r))}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return u}function Fb(e,t,n,r,i){var o=t._queryIdentifier,a=e.views.get(o);if(!a){var s=cb(n,i?r:null),u=!1;s?u=!0:r instanceof eg?(s=lb(n,r),u=!1):(s=eg.EMPTY_NODE,u=!1);var c=qg(new jg(s,u,!1),new jg(r,i,!1));return new Pb(t,c)}return a}function jb(e,t,n,r,i,o){var a=Fb(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Qm,(function(e,t){r.push(fg(e,t))})),n.isFullyInitialized()&&r.push(hg(n.getNode())),Db(e,r,n.getNode(),t)}(a,n)}function Ub(e,t,n,r){var i,o,a=t._queryIdentifier,s=[],u=[],c=Kb(e);if("default"===a)try{for(var l=sy(e.views.entries()),h=l.next();!h.done;h=l.next()){var f=uy(h.value,2),p=f[0],d=f[1];u=u.concat(xb(d,n,r)),Nb(d)&&(e.views.delete(p),d.query._queryParams.loadsAllData()||s.push(d.query))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}else(d=e.views.get(a))&&(u=u.concat(xb(d,n,r)),Nb(d)&&(e.views.delete(a),d.query._queryParams.loadsAllData()||s.push(d.query)));return c&&!Kb(e)&&s.push(new(Ee(kb,"Reference.ts has not been loaded"),kb)(t._repo,t._path)),{removed:s,events:u}}function Vb(e){var t,n,r=[];try{for(var i=sy(e.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function qb(e,t){var n,r,i=null;try{for(var o=sy(e.views.values()),a=o.next();!a.done;a=o.next()){var s=a.value;i=i||Rb(s,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Bb(e,t){if(t._queryParams.loadsAllData())return Wb(e);var n=t._queryIdentifier;return e.views.get(n)}function Gb(e,t){return null!=Bb(e,t)}function Kb(e){return null!=Wb(e)}function Wb(e){var t,n;try{for(var r=sy(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zb=1,Hb=function(e){this.listenProvider_=e,this.syncPointTree_=new zg(null),this.pendingWriteTree_={visibleWrites:Hg.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Qb(e,t,n,r,i){return function(e,t,n,r,i){Ee(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Qg(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?n_(e,new Lg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function $b(e,t,n,r){!function(e,t,n,r){Ee(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=$g(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=zg.fromObject(n);return n_(e,new Fg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Yb(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(ib(e.pendingWriteTree_,t)){var i=new zg(null);return null!=r.snap?i=i.set(lm(),!0):Fy(r.children,(function(e){i=i.set(new cm(e),!0)})),n_(e,new Og(r.path,i,n))}return[]}function Xb(e,t,n){return n_(e,new Lg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Jb(e,t,n,r){var i=t._path,o=e.syncPointTree_.get(i),a=[];if(o&&("default"===t._queryIdentifier||Gb(o,t))){var s=Ub(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(e){return e._queryParams.loadsAllData()})),l=e.syncPointTree_.findOnPath(i,(function(e,t){return Kb(t)}));if(c&&!l){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=function(e){return e.fold((function(e,t,n){if(t&&Kb(t))return[Wb(t)];var r=[];return t&&(r=Vb(t)),Fy(n,(function(e,t){r=r.concat(t)})),r}))}(h),p=0;p<f.length;++p){var d=f[p],v=d.query,y=r_(e,d);e.listenProvider_.startListening(c_(v),i_(e,v),y.hashFn,y.onComplete)}}if(!l&&u.length>0&&!r)if(c){e.listenProvider_.stopListening(c_(t),null)}else u.forEach((function(t){var n=e.queryToTagMap.get(o_(t));e.listenProvider_.stopListening(c_(t),n)}));!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=o_(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,u)}return a}function Zb(e,t,n){var r=t._path,i=null,o=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){var n=bm(e,r);i=i||qb(t,n),o=o||Kb(t)}));var a,s=e.syncPointTree_.get(r);(s?(o=o||Kb(s),i=i||qb(s,lm())):(s=new Mb,e.syncPointTree_=e.syncPointTree_.set(r,s)),null!=i)?a=!0:(a=!1,i=eg.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((function(e,t){var n=qb(t,lm());n&&(i=i.updateImmediateChild(e,n))})));var u=Gb(s,t);if(!u&&!t._queryParams.loadsAllData()){var c=o_(t);Ee(!e.queryToTagMap.has(c),"View does not exist, but we have a tag");var l=zb++;e.queryToTagMap.set(c,l),e.tagToQueryMap.set(l,c)}var h=jb(s,t,n,rb(e.pendingWriteTree_,r),i,a);if(!u&&!o){var f=Bb(s,t);h=h.concat(function(e,t,n){var r=t._path,i=i_(e,t),o=r_(e,n),a=e.listenProvider_.startListening(c_(t),i,o.hashFn,o.onComplete),s=e.syncPointTree_.subtree(r);if(i)Ee(!Kb(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(e,t,n){if(!gm(e)&&t&&Kb(t))return[Wb(t).query];var r=[];return t&&(r=r.concat(Vb(t).map((function(e){return e.query})))),Fy(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<u.length;++c){var l=u[c];e.listenProvider_.stopListening(c_(l),i_(e,l))}return a}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t,f))}return h}function e_(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=qb(n,bm(e,t));if(r)return r}));return ub(r,t,i,n,!0)}function t_(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=bm(e,n);r=r||qb(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||qb(i,lm()):(i=new Mb,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new jg(r,!0,!1):null;return function(e){return Kg(e.viewCache_)}(Fb(i,t,rb(e.pendingWriteTree_,t._path),o?a.getNode():eg.EMPTY_NODE,o))}function n_(e,t){return function e(t,n,r,i){if(gm(t.path))return function e(t,n,r,i){var o=n.get(lm());null==r&&null!=o&&(r=qb(o,lm()));var a=[];n.children.inorderTraversal((function(n,o){var s=r?r.getImmediateChild(n):null,u=vb(i,n),c=t.operationForChild(n);c&&(a=a.concat(e(c,o,s,u)))})),o&&(a=a.concat(Lb(o,t,i,r)));return a}(t,n,r,i);var o=n.get(lm());null==r&&null!=o&&(r=qb(o,lm()));var a=[],s=hm(t.path),u=t.operationForChild(s),c=n.children.get(s);if(c&&u){var l=r?r.getImmediateChild(s):null,h=vb(i,s);a=a.concat(e(u,c,l,h))}return o&&(a=a.concat(Lb(o,t,i,r))),a}(t,e.syncPointTree_,null,rb(e.pendingWriteTree_,lm()))}function r_(e,t){var n=t.query,r=i_(e,n);return{hashFn:function(){return(function(e){return e.viewCache_.serverCache.getNode()}(t)||eg.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=a_(e,n);if(r){var i=s_(r),o=i.path,a=i.queryId,s=bm(o,t);return u_(e,o,new Mg(Ag(a),s))}return[]}(e,n._path,r):function(e,t){return n_(e,new Mg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Jb(e,n,null,i)}}}function i_(e,t){var n=o_(t);return e.queryToTagMap.get(n)}function o_(e){return e._path.toString()+"$"+e._queryIdentifier}function a_(e,t){return e.tagToQueryMap.get(t)}function s_(e){var t=e.indexOf("$");return Ee(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new cm(e.substr(0,t))}}function u_(e,t,n){var r=e.syncPointTree_.get(t);return Ee(r,"Missing sync point for query tag that we're tracking"),Lb(r,n,rb(e.pendingWriteTree_,t),null)}function c_(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Ee(Ob,"Reference.ts has not been loaded"),Ob)(e._repo,e._path):e}var l_=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),h_=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=mm(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return e_(this.syncTree_,this.path_)},e}(),f_=function(e,t,n){return e&&"object"==typeof e?(Ee(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?p_(e[".sv"],t,n):"object"==typeof e[".sv"]?d_(e[".sv"],t):void Ee(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},p_=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Ee(!1,"Unexpected server value: "+e)}},d_=function(e,t,n){e.hasOwnProperty("increment")||Ee(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&Ee(!1,"Unexpected increment value: "+r);var i=t.node();if(Ee(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},v_=function(e,t,n,r){return m_(t,new h_(n,e),r)},y_=function(e,t,n){return m_(e,new l_(t),n)};function m_(e,t,n){var r,i=e.getPriority().val(),o=f_(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=f_(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new Wm(s,ng(o)):e}var u=e;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Wm(o))),u.forEachChild(Qm,(function(e,i){var o=m_(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))})),r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var g_=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n};function b_(e,t){for(var n=t instanceof cm?t:new cm(t),r=e,i=hm(n);null!==i;){var o=He(r.node.children,i)||{children:{},childCount:0};r=new g_(i,r,o),i=hm(n=pm(n))}return r}function __(e){return e.node.value}function w_(e,t){e.node.value=t,E_(e)}function T_(e){return e.node.childCount>0}function C_(e,t){Fy(e.node.children,(function(n,r){t(new g_(n,e,r))}))}function S_(e){return new cm(null===e.parent?e.name:S_(e.parent)+"/"+e.name)}function E_(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===__(e)&&!T_(e)}(n),i=ze(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,E_(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,E_(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e.parent,e.name,e)}var I_=/[\[\].#$\/\u0000-\u001F\u007F]/,k_=/[\[\].#$\u0000-\u001F\u007F]/,P_=function(e){return"string"==typeof e&&0!==e.length&&!I_.test(e)},R_=function(e){return"string"==typeof e&&0!==e.length&&!k_.test(e)},N_=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Ry(e)||e&&"object"==typeof e&&ze(e,".sv")},x_=function(e,t,n,r){r&&void 0===t||A_(tt(e,"value"),t,n)},A_=function(e,t,n){var r=n instanceof cm?new Cm(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Em(r));if("function"==typeof t)throw new Error(e+"contains a function "+Em(r)+" with contents = "+t.toString());if(Ry(t))throw new Error(e+"contains "+t.toString()+" "+Em(r));if("string"==typeof t&&t.length>10485760/3&&it(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Em(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(Fy(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!P_(t)))throw new Error(e+" contains an invalid key ("+t+") "+Em(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,s;!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=it(t),Sm(e)}(r,t),A_(e,n,r),s=(a=r).parts_.pop(),a.byteLength_-=it(s),a.parts_.length>0&&(a.byteLength_-=1)})),i&&o)throw new Error(e+' contains ".value" child '+Em(r)+" in addition to actual children.")}},D_=function(e,t,n,r){if(!r||void 0!==t){var i=tt(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var o=[];Fy(t,(function(e,t){var r=new cm(e);if(A_(i,t,mm(n,r)),".priority"===dm(r)&&!N_(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=vm(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!P_(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(_m);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&Tm(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,o)}},O_=function(e,t,n){if(!n||void 0!==t){if(Ry(t))throw new Error(tt(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!N_(t))throw new Error(tt(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},M_=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(tt(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},L_=function(e,t,n,r){if(!(r&&void 0===n||P_(n)))throw new Error(tt(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},F_=function(e,t,n,r){if(!(r&&void 0===n||R_(n)))throw new Error(tt(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},j_=function(e,t){if(".info"===hm(t))throw new Error(e+" failed = Can't modify data under /.info/")},U_=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!P_(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),R_(e)}(n))throw new Error(tt(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},V_=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(tt(e,t)+"must be a boolean.")},q_=function(){this.eventLists_=[],this.recursionDepth_=0};function B_(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||wm(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function G_(e,t,n){B_(e,n),W_(e,(function(e){return wm(e,t)}))}function K_(e,t,n){B_(e,n),W_(e,(function(e){return Tm(e,t)||Tm(t,e)}))}function W_(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(z_(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function z_(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();wy&&Sy("event: "+n.toString()),qy(r)}}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var H_=function(){function e(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new q_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ig(),this.transactionQueueTree_=new g_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function Q_(e,t,n){if(e.stats_=Jy(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Sg(e.repoInfo_,(function(t,n,r,i){X_(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return J_(e,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ke(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Rm(e.repoInfo_,t,(function(t,n,r,i){X_(e,t,n,r,i)}),(function(t){J_(e,t)}),(function(t){!function(e,t){Fy(t,(function(t,n){Z_(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,i,o;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=(r=e.repoInfo_,i=function(){return new xg(e.stats_,e.server_)},o=r.toString(),Xy[o]||(Xy[o]=i()),Xy[o]),e.infoData_=new Eg,e.infoSyncTree_=new Hb({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=Xb(e.infoSyncTree_,t._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Z_(e,"connected",!1),e.serverSyncTree_=new Hb({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var o=i(n,r);K_(e.eventQueue_,t._path,o)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function $_(e){var t=e.infoData_.getNode(new cm(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Y_(e){return(t=(t={timestamp:$_(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function X_(e,t,n,r,i){e.dataUpdateCount++;var o=new cm(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var a=[];if(i)if(r){var s=$e(n,(function(e){return ng(e)}));a=function(e,t,n,r){var i=a_(e,r);if(i){var o=s_(i),a=o.path,s=o.queryId,u=bm(a,t),c=zg.fromObject(n);return u_(e,a,new Fg(Ag(s),u,c))}return[]}(e.serverSyncTree_,o,s,i)}else{var u=ng(n);a=function(e,t,n,r){var i=a_(e,r);if(null!=i){var o=s_(i),a=o.path,s=o.queryId,u=bm(a,t);return u_(e,a,new Lg(Ag(s),u,n))}return[]}(e.serverSyncTree_,o,u,i)}else if(r){var c=$e(n,(function(e){return ng(e)}));a=function(e,t,n){var r=zg.fromObject(n);return n_(e,new Fg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,c)}else{var l=ng(n);a=Xb(e.serverSyncTree_,o,l)}var h=o;a.length>0&&(h=lw(e,o)),K_(e.eventQueue_,h,a)}function J_(e,t){Z_(e,"connected",t),!1===t&&function(e){aw(e,"onDisconnectEvents");var t=Y_(e),n=Ig();Pg(e.onDisconnect_,lm(),(function(r,i){var o=v_(r,i,e.serverSyncTree_,t);kg(n,r,o)}));var r=[];Pg(n,lm(),(function(t,n){r=r.concat(Xb(e.serverSyncTree_,t,n));var i=dw(e,t);lw(e,i)})),e.onDisconnect_=Ig(),K_(e.eventQueue_,lm(),r)}(e)}function Z_(e,t,n){var r=new cm("/.info/"+t),i=ng(n);e.infoData_.updateSnapshot(r,i);var o=Xb(e.infoSyncTree_,r,i);K_(e.eventQueue_,r,o)}function ew(e){return e.nextWriteId_++}function tw(e,t,n,r,i){aw(e,"set",{path:t.toString(),value:n,priority:r});var o=Y_(e),a=ng(n,r),s=e_(e.serverSyncTree_,t),u=y_(a,s,o),c=ew(e),l=Qb(e.serverSyncTree_,t,u,c,!0);B_(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||Py("set at "+t+" failed: "+n);var a=Yb(e.serverSyncTree_,c,!o);K_(e.eventQueue_,t,a),sw(e,i,n,r)}));var h=dw(e,t);lw(e,h),K_(e.eventQueue_,h,[])}function nw(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&function e(t,n){if(gm(n))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var r=t.value;return t.value=null,r.forEachChild(Qm,(function(e,n){kg(t,new cm(e),n)})),e(t,n)}if(t.children.size>0){var i=hm(n);if(n=pm(n),t.children.has(i))e(t.children.get(i),n)&&t.children.delete(i);return 0===t.children.size}return!0}(e.onDisconnect_,t),sw(e,n,r,i)}))}function rw(e,t,n,r){var i=ng(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,o){"ok"===n&&kg(e.onDisconnect_,t,i),sw(e,r,n,o)}))}function iw(e,t,n){var r;r=".info"===hm(t._path)?Jb(e.infoSyncTree_,t,n):Jb(e.serverSyncTree_,t,n),G_(e.eventQueue_,t._path,r)}function ow(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}function aw(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),Sy.apply(void 0,cy([r],uy(t)))}function sw(e,t,n,r){t&&qy((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}}))}function uw(e,t,n){return e_(e.serverSyncTree_,t,n)||eg.EMPTY_NODE}function cw(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||pw(e,t),__(t)){var n=fw(e,t);Ee(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=uw(e,t,r),o=i,a=i.hash(),s=0;s<n.length;s++){var u=n[s];Ee(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=bm(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var l=o.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){aw(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(t){n[t].status=2,i=i.concat(Yb(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)a(s);pw(e,b_(e.transactionQueueTree_,t)),cw(e,e.transactionQueueTree_),K_(e.eventQueue_,t,i);for(s=0;s<o.length;s++)qy(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{Py("transaction at "+h.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}lw(e,t)}}),a)}(e,S_(t),n)}else T_(t)&&C_(t,(function(t){cw(e,t)}))}function lw(e,t){var n=hw(e,t),r=S_(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],o=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),a=function(a){var s,u,c=t[a],l=bm(n,c.path),h=!1;if(Ee(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,s=c.abortReason,i=i.concat(Yb(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,s="maxretry",i=i.concat(Yb(e.serverSyncTree_,c.currentWriteId,!0));else{var f=uw(e,c.path,o);c.currentInputSnapshot=f;var p=t[a].update(f.val());if(void 0!==p){A_("transaction failed: Data returned ",p,c.path);var d=ng(p);"object"==typeof p&&null!=p&&ze(p,".priority")||(d=d.updatePriority(f.getPriority()));var v=c.currentWriteId,y=Y_(e),m=y_(d,f,y);c.currentOutputSnapshotRaw=d,c.currentOutputSnapshotResolved=m,c.currentWriteId=ew(e),o.splice(o.indexOf(v),1),i=(i=i.concat(Qb(e.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat(Yb(e.serverSyncTree_,v,!0))}else h=!0,s="nodata",i=i.concat(Yb(e.serverSyncTree_,c.currentWriteId,!0))}K_(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,u=t[a].unwatcher,setTimeout(u,Math.floor(0)),t[a].onComplete&&("nodata"===s?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(s),!1,null)}))))},s=0;s<t.length;s++)a(s);pw(e,e.transactionQueueTree_);for(s=0;s<r.length;s++)qy(r[s]);cw(e,e.transactionQueueTree_)}(e,fw(e,n),r),r}function hw(e,t){var n,r=e.transactionQueueTree_;for(n=hm(t);null!==n&&void 0===__(r);)r=b_(r,n),n=hm(t=pm(t));return r}function fw(e,t){var n=[];return function e(t,n,r){var i=__(n);if(i)for(var o=0;o<i.length;o++)r.push(i[o]);C_(n,(function(n){e(t,n,r)}))}(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function pw(e,t){var n=__(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,w_(t,n.length>0?n:void 0)}C_(t,(function(t){pw(e,t)}))}function dw(e,t){var n=S_(hw(e,t)),r=b_(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){vw(e,t)})),vw(e,r),function e(t,n,r,i){r&&!i&&n(t),C_(t,(function(t){e(t,n,!0,i)})),r&&i&&n(t)}(r,(function(t){vw(e,t)})),n}function vw(e,t){var n=__(t);if(n){for(var r=[],i=[],o=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(Ee(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):(Ee(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(Yb(e.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?w_(t,void 0):n.length=o+1,K_(e.eventQueue_,S_(t),i);for(a=0;a<r.length;a++)qy(r[a])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yw=function(e,t){var n=mw(e),r=n.namespace;"firebase.com"===n.domain&&ky(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||ky("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Py("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Hy(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new cm(n.pathString)}},mw=function(e){var t="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=sy(e.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Py("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var d=t.indexOf(".");r=t.substring(0,d).toLowerCase(),n=t.substring(d+1),o=r}"ns"in f&&(o=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},gw=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Ke(this.snapshot.exportVal())},e}(),bw=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),_w=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),ww=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new Ae;return nw(this._repo,this._path,e.wrapCallback((function(){}))),e.promise},e.prototype.remove=function(){j_("OnDisconnect.remove",this._path);var e=new Ae;return rw(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise},e.prototype.set=function(e){j_("OnDisconnect.set",this._path),x_("OnDisconnect.set",e,this._path,!1);var t=new Ae;return rw(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e.prototype.setWithPriority=function(e,t){j_("OnDisconnect.setWithPriority",this._path),x_("OnDisconnect.setWithPriority",e,this._path,!1),O_("OnDisconnect.setWithPriority",t,!1);var n=new Ae;return function(e,t,n,r,i){var o=ng(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),(function(n,r){"ok"===n&&kg(e.onDisconnect_,t,o),sw(e,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise},e.prototype.update=function(e){j_("OnDisconnect.update",this._path),D_("OnDisconnect.update",e,this._path,!1);var t=new Ae;return function(e,t,n,r){if(Qe(n))return Sy("onDisconnect().update() called with empty data.  Don't do anything."),void sw(e,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,o){"ok"===i&&Fy(n,(function(n,r){var i=ng(r);kg(e.onDisconnect_,mm(t,n),i)})),sw(e,r,i,o)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e}(),Tw=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return gm(this._path)?null:dm(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Iw(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=Cg(this._queryParams),t=My(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return Cg(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!((t=ot(t))instanceof e))return!1;var n=this._repo===t._repo,r=wm(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},e}();function Cw(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Sw(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Dm){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Ny)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==xy)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Qm){if(null!=t&&!N_(t)||null!=n&&!N_(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ee(e.getIndex()instanceof og||e.getIndex()===ag,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ew(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Iw=function(e){function t(t,n){return e.call(this,t,n,new gg,!1)||this}return ry(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=ym(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(Tw),kw=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new cm(t),r=Nw(this.ref,t);return new e(this._node.getChild(n),r,Qm)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,Nw(n.ref,r),Qm))}))},e.prototype.hasChild=function(e){var t=new cm(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function Pw(e,t){return(e=ot(e))._checkNotDeleted("ref"),void 0!==t?Nw(e._root,t):e._root}function Rw(e,t){(e=ot(e))._checkNotDeleted("refFromURL");var n=yw(t,e._repo.repoInfo_.nodeAdmin);U_("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||ky("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Pw(e,n.path.toString())}function Nw(e,t){var n,r,i,o;return null===hm((e=ot(e))._path)?(n="child",r="path",o=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),F_(n,r,i,o)):F_("child","path",t,!1),new Iw(e._repo,mm(e._path,t))}function xw(e,t){e=ot(e),j_("push",e._path),x_("push",t,e._path,!0);var n,r=$_(e._repo),i=ug(r),o=Nw(e,i),a=Nw(e,i);return n=null!=t?Dw(a,t).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),o}function Aw(e){return j_("remove",e._path),Dw(e,null)}function Dw(e,t){e=ot(e),j_("set",e._path),x_("set",t,e._path,!1);var n=new Ae;return tw(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Ow(e,t){e=ot(e),j_("setPriority",e._path),O_("setPriority",t,!1);var n=new Ae;return tw(e._repo,mm(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function Mw(e,t,n){if(j_("setWithPriority",e._path),x_("setWithPriority",t,e._path,!1),O_("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new Ae;return tw(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function Lw(e,t){D_("update",t,e._path,!1);var n=new Ae;return function(e,t,n,r){aw(e,"update",{path:t.toString(),value:n});var i=!0,o=Y_(e),a={};if(Fy(n,(function(n,r){i=!1,a[n]=v_(mm(t,n),ng(r),e.serverSyncTree_,o)})),i)Sy("update() called with empty data.  Don't do anything."),sw(e,r,"ok",void 0);else{var s=ew(e),u=$b(e.serverSyncTree_,t,a,s);B_(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var o="ok"===n;o||Py("update at "+t+" failed: "+n);var a=Yb(e.serverSyncTree_,s,!o),u=a.length>0?lw(e,t):t;K_(e.eventQueue_,u,a),sw(e,r,n,i)})),Fy(n,(function(n){var r=dw(e,mm(t,n));lw(e,r)})),K_(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function Fw(e){return function(e,t){var n=t_(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=ng(n).withIndex(t._queryParams.getIndex()),i=Xb(e.serverSyncTree_,t._path,r);return G_(e.eventQueue_,t._path,i),Promise.resolve(r)}),(function(n){return aw(e,"get for query "+Ke(t)+" failed: "+n),Promise.reject(new Error(n))}))}((e=ot(e))._repo,e).then((function(t){return new kw(t,new Iw(e._repo,e._path),e._queryParams.getIndex())}))}var jw=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new gw("value",this,new kw(e.snapshotNode,new Iw(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new bw(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),Uw=function(){function e(e,t){this.eventType=e,this.callbackContext=t}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new bw(this,e,t):null},e.prototype.createEvent=function(e,t){Ee(null!=e.childName,"Child events should have a childName.");var n=Nw(new Iw(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new gw(e.type,this,new kw(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))},e.prototype.hasAnyCallback=function(){return!!this.callbackContext},e}();function Vw(e,t,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(t,n){iw(e._repo,e,c),a(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new _w(n,o||void 0),c="value"===t?new jw(u):new Uw(t,u);return function(e,t,n){var r;r=".info"===hm(t._path)?Zb(e.infoSyncTree_,t,n):Zb(e.serverSyncTree_,t,n),G_(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return iw(e._repo,e,c)}}function qw(e,t,n,r){return Vw(e,"value",t,n,r)}function Bw(e,t,n,r){return Vw(e,"child_added",t,n,r)}function Gw(e,t,n,r){return Vw(e,"child_changed",t,n,r)}function Kw(e,t,n,r){return Vw(e,"child_moved",t,n,r)}function Ww(e,t,n,r){return Vw(e,"child_removed",t,n,r)}function zw(e,t,n){var r=null,i=n?new _w(n):null;"value"===t?r=new jw(i):t&&(r=new Uw(t,i)),iw(e._repo,e,r)}var Hw=function(){},Qw=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ry(t,e),t.prototype._apply=function(e){x_("endAt",this._value,e._path,!0);var t=_g(e._queryParams,this._value,this._key);if(Ew(t),Sw(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Tw(e._repo,e._path,t,e._orderByCalled)},t}(Hw);function $w(e,t){return L_("endAt","key",t,!0),new Qw(e,t)}var Yw=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ry(t,e),t.prototype._apply=function(e){x_("endBefore",this._value,e._path,!1);var t,n,r,i,o=(t=e._queryParams,n=this._value,r=this._key,t.index_===Dm?("string"==typeof n&&(n=lg(n)),i=_g(t,n,r)):i=_g(t,n,null==r?Ny:lg(r)),i.endBeforeSet_=!0,i);if(Ew(o),Sw(o),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Tw(e._repo,e._path,o,e._orderByCalled)},t}(Hw);function Xw(e,t){return L_("endBefore","key",t,!0),new Yw(e,t)}var Jw=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ry(t,e),t.prototype._apply=function(e){x_("startAt",this._value,e._path,!0);var t=bg(e._queryParams,this._value,this._key);if(Ew(t),Sw(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Tw(e._repo,e._path,t,e._orderByCalled)},t}(Hw);function Zw(e,t){return void 0===e&&(e=null),L_("startAt","key",t,!0),new Jw(e,t)}var eT=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ry(t,e),t.prototype._apply=function(e){x_("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;if(e.index_===Dm)"string"==typeof t&&(t=cg(t)),r=bg(e,t,n);else{r=bg(e,t,null==n?xy:cg(n))}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Ew(t),Sw(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Tw(e._repo,e._path,t,e._orderByCalled)},t}(Hw);function tT(e,t){return L_("startAfter","key",t,!0),new eT(e,t)}var nT=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return ry(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Tw(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),e._orderByCalled);var t,n,r},t}(Hw);function rT(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new nT(e)}var iT=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return ry(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Tw(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),e._orderByCalled);var t,n,r},t}(Hw);function oT(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new iT(e)}var aT=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return ry(t,e),t.prototype._apply=function(e){Cw(e,"orderByChild");var t=new cm(this._path);if(gm(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new og(t),r=wg(e._queryParams,n);return Sw(r),new Tw(e._repo,e._path,r,!0)},t}(Hw);function sT(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return F_("orderByChild","path",e,!1),new aT(e)}var uT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),t.prototype._apply=function(e){Cw(e,"orderByKey");var t=wg(e._queryParams,Dm);return Sw(t),new Tw(e._repo,e._path,t,!0)},t}(Hw);function cT(){return new uT}var lT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),t.prototype._apply=function(e){Cw(e,"orderByPriority");var t=wg(e._queryParams,Qm);return Sw(t),new Tw(e._repo,e._path,t,!0)},t}(Hw);function hT(){return new lT}var fT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ry(t,e),t.prototype._apply=function(e){Cw(e,"orderByValue");var t=wg(e._queryParams,ag);return Sw(t),new Tw(e._repo,e._path,t,!0)},t}(Hw);function pT(){return new fT}var dT=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ry(t,e),t.prototype._apply=function(e){if(x_("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Qw(this._value,this._key)._apply(new Jw(this._value,this._key)._apply(e))},t}(Hw);function vT(e,t){return L_("equalTo","key",t,!0),new dT(e,t)}function yT(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=ot(e);try{for(var a=sy(r),s=a.next();!s.done;s=a.next()){var u=s.value;o=u._apply(o)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}!function(e){Ee(!kb,"__referenceConstructor has already been defined"),kb=e}(Iw),function(e){Ee(!Ob,"__referenceConstructor has already been defined"),Ob=e}(Iw);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var mT={},gT=!1;function bT(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||ky("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Sy("Using default host for project ",e.options.projectId),o=e.options.projectId+"-default-rtdb.firebaseio.com");var a,s=yw(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=yw(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new Wy(Wy.OWNER):new Ky(e.name,e.options,t);U_("Invalid Firebase Database URL",s),gm(s.path)||ky("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=mT[t.name];i||(i={},mT[t.name]=i);var o=i[e.toURLString()];o&&ky("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new H_(e,gT,n,r),i[e.toURLString()]=o,o}(u,e,l,new Gy(e.name,n));return new _T(h,e)}var _T=function(){function e(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(Q_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Iw(this._repo,lm())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){var e,t,n;return this._checkNotDeleted("delete"),e=this._repo,t=this.app.name,(n=mT[t])&&n[e.key]===e||ky("Database "+t+"("+e.repoInfo_+") has already been deleted."),ow(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&ky("Cannot call "+e+" on a deleted database.")},e}();function wT(e,t,n,r){void 0===r&&(r={}),(e=ot(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&ky("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,o=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ky('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Wy(Wy.OWNER);else if(r.mockUserToken){var a=De(r.mockUserToken,e.app.options.projectId);o=new Wy(a)}!function(e,t,n,r){e.repoInfo_=new Hy(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,o)}function TT(e){(e=ot(e))._checkNotDeleted("goOffline"),ow(e._repo)}function CT(e){var t;(e=ot(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume("repo_interrupt")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ST={".sv":"timestamp"};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ET=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function IT(e,t,n){var r;if(e=ot(e),j_("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,o=new Ae,a=qw(e,(function(){}));return function(e,t,n,r,i,o){aw(e,"transaction on "+t);var a={path:t,update:n,onComplete:r,status:null,order:gy(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=uw(e,t,void 0);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{A_("transaction failed: Data returned ",u,a.path),a.status=0;var c=b_(e.transactionQueueTree_,t),l=__(c)||[];l.push(a),w_(c,l);var h=void 0;if("object"==typeof u&&null!==u&&ze(u,".priority"))h=He(u,".priority"),Ee(N_(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else h=(e_(e.serverSyncTree_,t)||eg.EMPTY_NODE).getPriority().val();var f=Y_(e),p=ng(u,h),d=y_(p,s,f);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=d,a.currentWriteId=ew(e);var v=Qb(e.serverSyncTree_,t,d,a.currentWriteId,a.applyLocally);K_(e.eventQueue_,t,v),cw(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?o.reject(t):(i=new kw(r,new Iw(e._repo,e._path),Qm),o.resolve(new ET(n,i)))}),a,i),o.promise}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var kT=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){et("OnDisconnect.cancel",0,1,arguments.length),nt("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.remove=function(e){et("OnDisconnect.remove",0,1,arguments.length),nt("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.set=function(e,t){et("OnDisconnect.set",1,2,arguments.length),nt("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},e.prototype.setWithPriority=function(e,t,n){et("OnDisconnect.setWithPriority",2,3,arguments.length),nt("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},e.prototype.update=function(e,t){if(et("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Py("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nt("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},e}(),PT=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return et("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),RT=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return et("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return et("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return et("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return et("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return et("DataSnapshot.child",0,1,arguments.length),t=String(t),F_("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return et("DataSnapshot.hasChild",1,1,arguments.length),F_("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return et("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return et("DataSnapshot.forEach",1,1,arguments.length),nt("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))},e.prototype.hasChildren=function(){return et("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return et("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return et("DataSnapshot.ref",0,0,arguments.length),new xT(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),NT=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,i){var o,a=this;et("Query.on",2,4,arguments.length),nt("Query.on","callback",n,!1);var s=e.getCancelAndContextArgs_("Query.on",r,i),u=function(e,t){n.call(s.context,new RT(a.database,e),t)};u.userCallback=n,u.context=s.context;var c=null===(o=s.cancel)||void 0===o?void 0:o.bind(s.context);switch(t){case"value":return qw(this._delegate,u,c),n;case"child_added":return Bw(this._delegate,u,c),n;case"child_removed":return Ww(this._delegate,u,c),n;case"child_changed":return Gw(this._delegate,u,c),n;case"child_moved":return Kw(this._delegate,u,c),n;default:throw new Error(tt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(et("Query.off",0,3,arguments.length),M_("Query.off",e,!0),nt("Query.off","callback",t,!0),rt("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,zw(this._delegate,e,r)}else zw(this._delegate,e)},e.prototype.get=function(){var e=this;return Fw(this._delegate).then((function(t){return new RT(e.database,t)}))},e.prototype.once=function(t,n,r,i){var o=this;et("Query.once",1,4,arguments.length),nt("Query.once","callback",n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),s=new Ae,u=function(e,t){var r=new RT(o.database,e);n&&n.call(a.context,r,t),s.resolve(r)};u.userCallback=n,u.context=a.context;var c=function(e){a.cancel&&a.cancel.call(a.context,e),s.reject(e)};switch(t){case"value":qw(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":Bw(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":Ww(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":Gw(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":Kw(this._delegate,u,c,{onlyOnce:!0});break;default:throw new Error(tt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise},e.prototype.limitToFirst=function(t){return et("Query.limitToFirst",1,1,arguments.length),new e(this.database,yT(this._delegate,rT(t)))},e.prototype.limitToLast=function(t){return et("Query.limitToLast",1,1,arguments.length),new e(this.database,yT(this._delegate,oT(t)))},e.prototype.orderByChild=function(t){return et("Query.orderByChild",1,1,arguments.length),new e(this.database,yT(this._delegate,sT(t)))},e.prototype.orderByKey=function(){return et("Query.orderByKey",0,0,arguments.length),new e(this.database,yT(this._delegate,cT()))},e.prototype.orderByPriority=function(){return et("Query.orderByPriority",0,0,arguments.length),new e(this.database,yT(this._delegate,hT()))},e.prototype.orderByValue=function(){return et("Query.orderByValue",0,0,arguments.length),new e(this.database,yT(this._delegate,pT()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),et("Query.startAt",0,2,arguments.length),new e(this.database,yT(this._delegate,Zw(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),et("Query.startAfter",0,2,arguments.length),new e(this.database,yT(this._delegate,tT(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),et("Query.endAt",0,2,arguments.length),new e(this.database,yT(this._delegate,$w(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),et("Query.endBefore",0,2,arguments.length),new e(this.database,yT(this._delegate,Xw(t,n)))},e.prototype.equalTo=function(t,n){return et("Query.equalTo",1,2,arguments.length),new e(this.database,yT(this._delegate,vT(t,n)))},e.prototype.toString=function(){return et("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return et("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(et("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,nt(e,"cancel",r.cancel,!0),r.context=n,rt(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(tt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new xT(this.database,new Iw(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),xT=function(e){function t(t,n){var r=e.call(this,t,new Tw(n._repo,n._path,new gg,!1))||this;return r.database=t,r._delegate=n,r}return ry(t,e),t.prototype.getKey=function(){return et("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return et("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new t(this.database,Nw(this._delegate,e))},t.prototype.getParent=function(){et("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return et("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){et("Reference.set",1,2,arguments.length),nt("Reference.set","onComplete",t,!0);var n=Dw(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.update=function(e,t){if(et("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Py("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}j_("Reference.update",this._delegate._path),nt("Reference.update","onComplete",t,!0);var i=Lw(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},t.prototype.setWithPriority=function(e,t,n){et("Reference.setWithPriority",2,3,arguments.length),nt("Reference.setWithPriority","onComplete",n,!0);var r=Mw(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},t.prototype.remove=function(e){et("Reference.remove",0,1,arguments.length),nt("Reference.remove","onComplete",e,!0);var t=Aw(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},t.prototype.transaction=function(e,t,n){var r=this;et("Reference.transaction",1,3,arguments.length),nt("Reference.transaction","transactionUpdate",e,!1),nt("Reference.transaction","onComplete",t,!0),V_("Reference.transaction","applyLocally",n,!0);var i=IT(this._delegate,e,{applyLocally:n}).then((function(e){return new PT(e.committed,new RT(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i},t.prototype.setPriority=function(e,t){et("Reference.setPriority",1,2,arguments.length),nt("Reference.setPriority","onComplete",t,!0);var n=Ow(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.push=function(e,n){var r=this;et("Reference.push",0,2,arguments.length),nt("Reference.push","onComplete",n,!0);var i=xw(this._delegate,e),o=i.then((function(e){return new t(r.database,e)}));n&&o.then((function(){return n(null)}),(function(e){return n(e)}));var a=new t(this.database,i);return a.then=o.then.bind(o),a.catch=o.catch.bind(o,void 0),a},t.prototype.onDisconnect=function(){return j_("Reference.onDisconnect",this._delegate._path),new kT(new ww(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(NT),AT=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),wT(this._delegate,e,t,n)},e.prototype.ref=function(e){if(et("database.ref",0,1,arguments.length),e instanceof xT){var t=Rw(this._delegate,e.toString());return new xT(this,t)}t=Pw(this._delegate,e);return new xT(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";et(t,1,1,arguments.length);var n=Rw(this._delegate,e);return new xT(this,n)},e.prototype.goOffline=function(){return et("database.goOffline",0,0,arguments.length),TT(this._delegate)},e.prototype.goOnline=function(){return et("database.goOnline",0,0,arguments.length),CT(this._delegate)},e.ServerValue={TIMESTAMP:ST,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}},e}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var DT=Object.freeze({__proto__:null,forceLongPolling:function(){rm.forceDisallow(),em.forceAllow()},forceWebSockets:function(){em.forceDisallow()},isWebSocketsAvailable:function(){return rm.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var n;t?(e.statsListener_||(e.statsListener_=new Ng(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce((function(e,t){return Math.max(t.length,e)}),0);Fy(n,(function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)}))}}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace,a=e.nodeAdmin,s=void 0!==a&&a;hy(r);var u=new ft("auth-internal",new dt("database-standalone"));return u.setComponent(new ht("auth-internal",(function(){return i}),"PRIVATE")),{instance:new AT(bT(t,u,void 0,n,s),t),namespace:o}}}),OT=Rm;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Rm.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Rm.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var MT=om,LT=Hy,FT=Object.freeze({__proto__:null,DataConnection:OT,RealTimeConnection:MT,hijackHash:function(e){var t=Rm.prototype.put;return Rm.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Rm.prototype.put=t}},ConnectionTarget:LT,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){!function(e){gT=e}(e)}}),jT=AT.ServerValue;!function(e){hy(e.SDK_VERSION),e.INTERNAL.registerComponent(new ht("database",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new AT(bT(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:xT,Query:NT,Database:AT,DataSnapshot:RT,enableLogging:Cy,INTERNAL:DT,ServerValue:jT,TEST_ACCESS:FT}).setMultipleInstances(!0)),e.registerVersion("@firebase/database","0.10.5")}(Ft);Ft.initializeApp({apiKey:"AIzaSyAcT5oGP6ZFtJ5sHXsqxVa6DwgwxBzVexw",authDomain:"remotecamera-6f583.firebaseapp.com",databaseURL:"https://remotecamera-6f583-default-rtdb.firebaseio.com",projectId:"remotecamera-6f583",storageBucket:"remotecamera-6f583.appspot.com",messagingSenderId:"828538172310",appId:"1:828538172310:web:827aa1ba489b3bb53aa3b7",measurementId:"G-247RTVTFW6"});Ft.firestore();const UT=Ft.auth(),VT=Ft.database();new Ft.auth.GoogleAuthProvider;function qT(e,{delay:n=0,duration:r=400,easing:i=t}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>`opacity: ${e*o}`}}function BT(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var GT=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){parcelRequire=function(t,n,r,i){var o,a="function"==typeof parcelRequire&&parcelRequire,s=BT;function u(e,r){if(!n[e]){if(!t[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!r&&i)return i(e,!0);if(a)return a(e,!0);if(s&&"string"==typeof e)return s(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var c=n[e]=new u.Module(e);t[e][0].call(c.exports,l,c,c.exports,this)}return n[e].exports;function l(e){return u(l.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=t,u.cache=n,u.parent=a,u.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var c=0;c<r.length;c++)try{u(r[c])}catch(t){o||(o=t)}if(r.length){var l=u(r[r.length-1]);e.exports=l}if(parcelRequire=u,o)throw o;return u}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures,o={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new r}function u(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=o,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},a.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,u).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),a=t<<31|n+1023<<20|i/o&1048575,s=i%o;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=a(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=a(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=a(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=a(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},n.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(n,r){var i=s(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,o))}),{}):t},n.walkStats=u,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&u(e,n,i)}))})),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?u(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){u(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var n=e&&e.navigator;if(n.mediaDevices){var r=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,a){if(t.version>=61)return a(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===i(e.video)){var u=e.video.facingMode;u=u&&("object"===i(u)?u:{ideal:u});var c,l=t.version<66;if(u&&("user"===u.exact||"environment"===u.exact||"user"===u.ideal||"environment"===u.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===u.exact||"environment"===u.ideal?c=["back","rear"]:"user"!==u.exact&&"user"!==u.ideal||(c=["front"]),c))return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return c.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&c.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=u.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),o("chrome: "+JSON.stringify(e)),a(e)}));e.video=r(e.video)}return o("chrome: "+JSON.stringify(e)),a(e)},s=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){a(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(s(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(s(e))}))}))}}}};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")).log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==u(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===u(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===u(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,i]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(a(o(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(a(o(e)))},r])})).then(r,i)}}},n.shimSenderReceiverGetStats=function(e){if("object"===u(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(n?r=!0:n=e),e.track===i})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=u(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return u(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],n=t.sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})),o.apply(this,arguments)):o.apply(this,arguments);var e,t,n};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:u(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function u(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}))},n.fixNegotiationNeeded=function(e,t){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,"a=ice-ufrag:")[0],i=r.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),u=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=u.length?r.parseFmtp(u[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),u=s.length>0&&s[0].ssrc,c=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===u&&(t=c[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10)};u&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&u&&n.push({ssrc:u});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var u="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+u,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+u,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+u,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function u(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function c(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw u("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw u("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw u("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw u("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw u("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,u=!s||0===Object.keys(s).length;if(u)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var c=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(c)),a.candidate.candidate=c,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var h=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),u||i._dispatchEvent("icecandidate",a),h&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(u("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(u("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],u=a.iceGatherer,c=a.iceTransport,l=a.dtlsTransport,h=a.localCapabilities,f=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=r.getIceParameters(e,n),d=r.getDtlsParameters(e,n);s&&(d.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===c.state&&c.start(u,p,s?"controlling":"controlled"),"new"===l.state&&l.start(d));var v=o(h,f);i._transceive(a,v.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(u("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(u("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var h={};l.remoteStreams.forEach((function(e){h[e.id]=e}));var f=[],p=r.splitSections(i.sdp),d=p.shift(),v=r.matchPrefix(d,"a=ice-lite").length>0,y=r.matchPrefix(d,"a=group:BUNDLE ").length>0;l.usingBundle=y;var m=r.matchPrefix(d,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,u){var c=r.splitLines(a),p=r.getKind(a),m=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,g=c[0].substr(2).split(" ")[2],b=r.getDirection(a,d),_=r.parseMsid(a),w=r.getMid(a)||r.generateIdentifier();if(m||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))l.transceivers[u]={mid:w,kind:p,protocol:g,rejected:!0};else{var T,C,S,E,I,k,P,R,N;!m&&l.transceivers[u]&&l.transceivers[u].rejected&&(l.transceivers[u]=l._createTransceiver(p,!0));var x,A,D=r.parseRtpParameters(a);m||(x=r.getIceParameters(a,d),(A=r.getDtlsParameters(a,d)).role="client"),P=r.parseRtpEncodingParameters(a);var O=r.parseRtcpParameters(a),M=r.matchPrefix(a,"a=end-of-candidates",d).length>0,L=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!m&&y&&u>0&&l.transceivers[u]&&(l._disposeIceAndDtlsTransports(u),l.transceivers[u].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[u].iceTransport=l.transceivers[0].iceTransport,l.transceivers[u].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[u].rtpSender&&l.transceivers[u].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[u].rtpReceiver&&l.transceivers[u].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||m)"answer"!==i.type||m||(C=(T=l.transceivers[u]).iceGatherer,S=T.iceTransport,E=T.dtlsTransport,I=T.rtpReceiver,k=T.sendEncodingParameters,R=T.localCapabilities,l.transceivers[u].recvEncodingParameters=P,l.transceivers[u].remoteCapabilities=D,l.transceivers[u].rtcpParameters=O,L.length&&"new"===S.state&&(!v&&!M||y&&0!==u?L.forEach((function(e){s(T.iceTransport,e)})):S.setRemoteCandidates(L)),y&&0!==u||("new"===S.state&&S.start(C,x,"controlling"),"new"===E.state&&E.start(A)),!o(T.localCapabilities,T.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&T.sendEncodingParameters[0].rtx&&delete T.sendEncodingParameters[0].rtx,l._transceive(T,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!I||"sendrecv"!==b&&"sendonly"!==b?delete T.rtpReceiver:(N=I.track,_?(h[_.stream]||(h[_.stream]=new e.MediaStream),n(N,h[_.stream]),f.push([N,I,h[_.stream]])):(h.default||(h.default=new e.MediaStream),n(N,h.default),f.push([N,I,h.default]))));else{(T=l.transceivers[u]||l._createTransceiver(p)).mid=w,T.iceGatherer||(T.iceGatherer=l._createIceGatherer(u,y)),L.length&&"new"===T.iceTransport.state&&(!M||y&&0!==u?L.forEach((function(e){s(T.iceTransport,e)})):T.iceTransport.setRemoteCandidates(L)),R=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(R.codecs=R.codecs.filter((function(e){return"rtx"!==e.name}))),k=T.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var F,j=!1;"sendrecv"===b||"sendonly"===b?(j=!T.rtpReceiver,I=T.rtpReceiver||new e.RTCRtpReceiver(T.dtlsTransport,p),j&&(N=I.track,_&&"-"===_.stream||(_?(h[_.stream]||(h[_.stream]=new e.MediaStream,Object.defineProperty(h[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(N,"id",{get:function(){return _.track}}),F=h[_.stream]):(h.default||(h.default=new e.MediaStream),F=h.default)),F&&(n(N,F),T.associatedRemoteMediaStreams.push(F)),f.push([N,I,F]))):T.rtpReceiver&&T.rtpReceiver.track&&(T.associatedRemoteMediaStreams.forEach((function(t){var n,r,i=t.getTracks().find((function(e){return e.id===T.rtpReceiver.track.id}));i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),T.associatedRemoteMediaStreams=[]),T.localCapabilities=R,T.remoteCapabilities=D,T.rtpReceiver=I,T.rtcpParameters=O,T.sendEncodingParameters=k,T.recvEncodingParameters=P,l._transceive(l.transceivers[u],!1,j)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(h).forEach((function(t){var n=h[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}f.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&c(l,t,r,[n])}))}})),f.forEach((function(e){e[2]||c(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var c=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,s=i.kind,u=i.mid||r.generateIdentifier();i.mid=u,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=c,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(c+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){c+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(u("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var u;e.stream&&("audio"===e.kind?u=e.stream.getAudioTracks()[0]:"video"===e.kind&&(u=e.stream.getVideoTracks()[0]),u&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var c=o(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,c,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(c)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(u("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var c=0;c<n.transceivers.length;c++)if(n.transceivers[c].mid===e.sdpMid){a=c;break}var l=n.transceivers[a];if(!l)return o(u("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var h=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port))return i();if(h.component&&1!==h.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,h))return o(u("OperationError","Can not add ICE candidate"));var f=e.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(h.type?f:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw u("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var h=["createOffer","createAnswer"];return h.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(h=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,o.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./filtericeservers"),o=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia");function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===o(e)&&"object"===o(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},i&&i.prototype.getSettings){var u=i.prototype.getSettings;i.prototype.getSettings=function(){var e=u.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var c=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===o(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e,t){if("object"===s(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,i,o]=arguments;return r.apply(this,[e||null]).then((function(e){if(t.version<53&&!i)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}},n.shimSenderGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:i}=r,o=i.getParameters();"encodings"in o&&(1!==o.encodings.length||0!==Object.keys(o.encodings[0]).length)||(o.encodings=e.sendEncodings,i.sendEncodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return r})}},n.shimGetParameters=function(e){if("object"===s(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}},n.shimCreateOffer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i&&i.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var u=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=u,u=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=u,u=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=u}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}},n.shimTrackEventTransceiver=function(e){"object"===o(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}},n.shimAudioContext=function(e){"object"!==o(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.default.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var i,o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(c=o,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===c?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],o);i=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var u={};Object.defineProperty(u,"maxMessageSize",{get:function(){return i}}),this._sctp=u}var c,l;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeExtmapAllowMixed=function(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var r=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return n.apply(this,arguments)}}},n.shimAddIceCandidateNullOrEmpty=function(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,c=r.detectBrowser(e),l={browserDetails:c,commonShim:u,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;if(null===c.version)return n("Chrome shim can not determine version, not shimming."),l;n("adapter.js shimming chrome."),l.browserShim=i,u.shimAddIceCandidateNullOrEmpty(e,c),i.shimGetUserMedia(e,c),i.shimMediaStream(e,c),i.shimPeerConnection(e,c),i.shimOnTrack(e,c),i.shimAddTrackRemoveTrack(e,c),i.shimGetSendersWithDtmf(e,c),i.shimGetStats(e,c),i.shimSenderReceiverGetStats(e,c),i.fixNegotiationNeeded(e,c),u.shimRTCIceCandidate(e,c),u.shimConnectionState(e,c),u.shimMaxMessageSize(e,c),u.shimSendThrowTypeError(e,c),u.removeExtmapAllowMixed(e,c);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=a,u.shimAddIceCandidateNullOrEmpty(e,c),a.shimGetUserMedia(e,c),a.shimPeerConnection(e,c),a.shimOnTrack(e,c),a.shimRemoveStream(e,c),a.shimSenderGetStats(e,c),a.shimReceiverGetStats(e,c),a.shimRTCDataChannel(e,c),a.shimAddTransceiver(e,c),a.shimGetParameters(e,c),a.shimCreateOffer(e,c),a.shimCreateAnswer(e,c),u.shimRTCIceCandidate(e,c),u.shimConnectionState(e,c),u.shimMaxMessageSize(e,c),u.shimSendThrowTypeError(e,c);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),l;n("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e,c),o.shimGetDisplayMedia(e,c),o.shimPeerConnection(e,c),o.shimReplaceTrack(e,c),u.shimMaxMessageSize(e,c),u.shimSendThrowTypeError(e,c);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=s,u.shimAddIceCandidateNullOrEmpty(e,c),s.shimRTCIceServerUrls(e,c),s.shimCreateOfferLegacy(e,c),s.shimCallbacksAPI(e,c),s.shimLocalStreamsAPI(e,c),s.shimRemoteStreamsAPI(e,c),s.shimTrackEventTransceiver(e,c),s.shimGetUserMedia(e,c),s.shimAudioContext(e,c),u.shimRTCIceCandidate(e,c),u.shimMaxMessageSize(e,c),u.shimSendThrowTypeError(e,c),u.removeExtmapAllowMixed(e,c);break;default:n("Unsupported browser!")}return l};var r=l(e("./utils")),i=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),s=l(e("./safari/safari_shim")),u=l(e("./common_shim"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.webRTCAdapter=void 0;var i=r(e("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Supports=void 0;var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(e){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.util=void 0;var a=o(e("peerjs-js-binarypack")),s=e("./supports"),u={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=u,this.browser=s.Supports.getBrowser(),this.browserVersion=s.Supports.getVersion(),this.supports=function(){var e,t={browser:s.Supports.isBrowserSupported(),webRTC:s.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(u),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!s.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=a.pack,this.unpack=a.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/n.util.chunkedMTU),o=0,a=0;a<r;){var s=Math.min(r,a+n.util.chunkedMTU),u=e.slice(a,s),c={__peerData:this._dataCount,n:o,data:u,total:i};t.push(c),a=s,o++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,void 0!==t&&(t.exports=c)},{}],WOs9:[function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(n,"__esModule",{value:!0}),n.LogLevel=void 0;var o,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(o=n.LogLevel||(n.LogLevel={}));var s=function(){function e(){this._logLevel=o.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,i([o.All],r(e)))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,i([o.Warnings],r(e)))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,i([o.Errors],r(e)))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=i([a],r(t));for(var u in s)s[u]instanceof Error&&(s[u]="("+s[u].name+") "+s[u].message);e>=o.All?console.log.apply(console,i([],r(s))):e>=o.Warnings?console.warn.apply(console,i(["WARNING"],r(s))):e>=o.Errors&&console.error.apply(console,i(["ERROR"],r(s)))},e}();n.default=new s},{}],ZRYf:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ServerMessageType=n.SocketEventType=n.SerializationType=n.PeerErrorType=n.PeerEventType=n.ConnectionType=n.ConnectionEventType=void 0,function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Socket=void 0;var u=e("eventemitter3"),c=s(e("./logger")),l=e("./enums"),h=function(e){function t(t,n,r,i,o,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!0,s._messagesQueue=[];var u=t?"wss://":"ws://";return s._baseUrl=u+n+":"+r+i+"peerjs?key="+o,s}return r(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),c.default.log("Server message received:",t)}catch(t){return void c.default.log("Invalid server message",e.data)}n.emit(l.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(c.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(l.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),c.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else c.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=o([],i(this._messagesQueue));this._messagesQueue=[];try{for(var r=a(n),s=r.next();!s.done;s=r.next()){var u=s.value;this.send(u)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(u.EventEmitter);n.Socket=h},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Negotiator=void 0;var s=e("./util"),u=a(e("./logger")),c=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===c.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===c.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){u.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;u.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(u.default.log("Received ICE candidates for "+n+":",e.candidate),o.socket.send({type:c.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":u.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(c.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":u.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(c.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":u.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(c.ConnectionEventType.IceStateChanged,e.iceConnectionState)},u.default.log("Listening for data channel"),e.ondatachannel=function(e){u.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},u.default.log("Listening for remote stream"),e.ontrack=function(e){u.default.log("Received remote stream");var i=e.streams[0],a=o.getConnection(n,r);if(a.type===c.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(i,s)}}},e.prototype.cleanup=function(){u.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===c.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,n,i,a,l,h;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),u.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===c.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:c.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=o.sent())&&(t.emitError(c.PeerErrorType.WebRTC,l),u.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return h=o.sent(),t.emitError(c.PeerErrorType.WebRTC,h),u.default.log("Failed to createOffer, ",h),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),u.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:c.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(c.PeerErrorType.WebRTC,r),u.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(c.PeerErrorType.WebRTC,i),u.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,u.default.log("Setting remote description",t),i=this,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return o.sent(),u.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return a=o.sent(),r.emitError(c.PeerErrorType.WebRTC,a),u.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,n,r,i,a,s;return o(this,(function(o){switch(o.label){case 0:u.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),u.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=o.sent(),a.emitError(c.PeerErrorType.WebRTC,s),u.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(u.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return u.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){u.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.BaseConnection=void 0;var i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=i},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MediaConnection=void 0;var s=e("./util"),u=a(e("./logger")),c=e("./negotiator"),l=e("./enums"),h=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+s.util.randomToken(),o._negotiator=new c.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),t.prototype.addStream=function(t){u.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:u.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)u.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(i(i({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=o(a),c=s.next();!c.done;c=s.next()){var l=c.value;this.handleMessage(l)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=h},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.EncodingQueue=void 0;var o=e("eventemitter3"),a=i(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(o.EventEmitter);n.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DataConnection=void 0;var a=e("./util"),s=o(e("./logger")),u=e("./negotiator"),c=e("./enums"),l=e("./baseconnection"),h=e("./encodingQueue"),f=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.stringify=JSON.stringify,o.parse=JSON.parse,o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new h.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+a.util.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||c.SerializationType.Binary,o.reliable=!!o.options.reliable,o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){s.default.error("DC#"+o.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),o.close()})),o._negotiator=new u.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return c.ConnectionType.Data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(c.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);n.emit(c.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)o=a.util.unpack(r);else if(i===String){var s=a.util.binaryStringToArrayBuffer(r);o=a.util.unpack(s)}}else this.serialization===c.SerializationType.JSON&&(o=this.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,c.ConnectionEventType.Data,o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,c.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===c.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,c.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var o=i(r),u=o.next();!u.done;u=o.next()){var c=u.value;this.send(c,!0)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case c.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case c.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);n.DataConnection=f},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.API=void 0;var a=e("./util"),s=o(e("./logger")),u=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=i.sent(),s.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status){if(401===t.status)throw"",n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=i.sent(),s.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=u},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Peer=void 0;var u=e("eventemitter3"),c=e("./util"),l=s(e("./logger")),h=e("./socket"),f=e("./mediaconnection"),p=e("./dataconnection"),d=e("./enums"),v=e("./api"),y=function(e){function t(n,r){var o,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(o=n.toString()),r=i({debug:0,host:c.util.CLOUD_HOST,port:c.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:c.util.randomToken(),config:c.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==c.util.CLOUD_HOST?a._options.secure=c.util.isSecure():a._options.host==c.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&l.default.setLogFunction(a._options.logFunction),l.default.logLevel=a._options.debug||0,a._api=new v.API(r),a._socket=a._createServerConnection(),c.util.supports.audioVideo||c.util.supports.data?o&&!c.util.validateId(o)?(a._delayedAbort(d.PeerErrorType.InvalidID,'ID "'+o+'" is invalid'),a):(o?a._initialize(o):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(d.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(d.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=o(this._connections),i=r.next();!i.done;i=r.next()){var s=a(i.value,2),u=s[0],c=s[1];n[u]=c}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new h.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(d.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(d.SocketEventType.Error,(function(t){e._abort(d.PeerErrorType.SocketError,t)})),t.on(d.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(d.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(d.SocketEventType.Close,(function(){e.disconnected||e._abort(d.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,a=e.src;switch(r){case d.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(d.PeerEventType.Open,this.id);break;case d.ServerMessageType.Error:this._abort(d.PeerErrorType.ServerError,i.msg);break;case d.ServerMessageType.IdTaken:this._abort(d.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case d.ServerMessageType.InvalidKey:this._abort(d.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case d.ServerMessageType.Leave:l.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case d.ServerMessageType.Expire:this.emitError(d.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case d.ServerMessageType.Offer:var s=i.connectionId;if((y=this.getConnection(a,s))&&(y.close(),l.default.warn("Offer received for existing Connection ID:"+s)),i.type===d.ConnectionType.Media)y=new f.MediaConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata}),this._addConnection(a,y),this.emit(d.PeerEventType.Call,y);else{if(i.type!==d.ConnectionType.Data)return void l.default.warn("Received malformed connection type:"+i.type);y=new p.DataConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(a,y),this.emit(d.PeerEventType.Connection,y)}var u=this._getMessages(s);try{for(var c=o(u),h=c.next();!h.done;h=c.next()){var v=h.value;y.handleMessage(v)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}break;default:if(!i)return void l.default.warn("You received a malformed message from "+a+" of type "+r);var y;s=i.connectionId,(y=this.getConnection(a,s))&&y.peerConnection?y.handleMessage(e):s?this._storeMessage(s,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new p.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new f.MediaConnection(e,this,n);return this._addConnection(e,r),r}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.connectionId===t)return u}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;l.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(d.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(l.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(d.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=o(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=o(r),a=i.next();!a.done;a=i.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;l.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(d.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(d.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(u.EventEmitter);n.Peer=y},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.peerjs=void 0;var r=e("./util"),i=e("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])})));let KT,WT,zT="";class HT{constructor(e){this.connections=[],this.peer=e,this.pingInterval=void 0,this.subscribedActions=[],this.isHost=!1}startPingRoutine(){this.subscribeToAll("data",e=>{try{let t=JSON.parse(e);if("pong"==t.type)for(let e of this.connections)e.id==t.from&&(e.pingStrikes=2)}catch(e){}}),this.pingInterval=setInterval(()=>{this.broadcast('{"type": "ping"}');let e=this.connections.filter(e=>{if(e.pingStrikes-=1,e.pingStrikes<=0){return e.conn.close(),!1}return!0});this.connections=e;for(let[e,t]of this.subscribedActions)"ping"==e&&t()},5e3)}subscribeToAll(e,t){if(this.subscribedActions.push([e,t]),"ping"!=e)for(let n of this.connections){n.conn.on(e,t)}}broadcast(e){for(let{conn:t}of this.connections)t.send(e)}addConnection(e,t,n){if(0==this.connections.reduce((e,t)=>t.id==n||e,!1)){this.connections.push({displayName:t,conn:e,id:n,pingStrikes:2});for(let t of this.subscribedActions){let[n,r]=t;e.on(n,r)}}console.log(this.connections)}}async function QT(){let e=(t="localStream",O().$$.context.get(t));var t;if(e instanceof MediaStream==0){try{let t=await navigator.mediaDevices.enumerateDevices();console.log(t),e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})}catch(e){console.error("Failed to get local stream",e)}M("localStream",e)}return e}pe.subscribe(e=>{"string"==typeof e?(zT=e,KT=new GT(e),KT.on("open",e=>{console.log("peer id: "+e),WT=new HT(KT)}),KT.on("disconnected",()=>{console.log("%cdisconnected from peer!","color: crimson")})):null==e&&KT instanceof GT&&(KT.disconnect(),KT.destroy(),console.log("%cDestroying the WebRTC Connection","color: red; font-size: 21px"))});const $T=()=>{const e=new AudioContext,t=e.createOscillator(),n=t.connect(e.createMediaStreamDestination());t.start();const r=n.stream.getAudioTracks()[0];return Object.assign(r,{enabled:!1})},YT=({width:e,height:t})=>{const n=Object.assign(document.createElement("canvas"),{width:e,height:t});n.getContext("2d").fillRect(0,0,e,t);const r=n.captureStream().getVideoTracks()[0];return Object.assign(r,{enabled:!1})};async function XT(e,t,n){if(KT instanceof GT==0)return void console.warn("peer is not defined yet");const r=new MediaStream([$T(),YT({width:640,height:480})]);let i=KT.connect(e),o=UT.currentUser;WT.addConnection(i,"host",e),i.on("open",()=>{console.log("%cconnected with the host","color: orange");let e={from:zT,type:"handshake",displayName:o.displayName};i.send(JSON.stringify(e))}),i.on("data",e=>{try{let t=JSON.parse(e);if("ping"!=t.type){console.groupCollapsed(`data received from %chost%c - %c${t.type}`,"color: cyan","color: white","color: orange");for(let e of Object.keys(t))0==["type","from","displayName"].includes(e)&&(console.group(e),console.log(t[e]),console.groupEnd());console.groupEnd()}if(n(t),"ping"==t.type){let e={from:zT,type:"pong",displayName:o.displayName};i.send(JSON.stringify(e))}}catch(e){console.error(`data received in wrong format from host: ${e}`)}}),KT.call(e,r).on("stream",e=>{M("remoteStream",e),t&&t(e)})}function JT(e){return"[object Date]"===Object.prototype.toString.call(e)}function ZT(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((t,n)=>ZT(e[n],t));return e=>n.map(t=>t(e))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(JT(e)&&JT(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),r={};return n.forEach(n=>{r[n]=ZT(e[n],t[n])}),e=>{const t={};return n.forEach(n=>{t[n]=r[n](e)}),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}function eC(e,r={}){const i=le(e);let o,a=e;function s(s,u){if(null==e)return i.set(e=s),Promise.resolve();a=s;let c=o,h=!1,{delay:f=0,duration:p=400,easing:v=t,interpolate:y=ZT}=n(n({},r),u);const m=l()+f;let g;return o=d(t=>{if(t<m)return!0;h||(g=y(e,s),"function"==typeof p&&(p=p(e,s)),h=!0),c&&(c.abort(),c=null);const n=t-m;return n>p?(i.set(e=s),!1):(i.set(e=g(v(n/p))),!0)}),o.promise}return{set:s,update:(t,n)=>s(t(a,e),n),subscribe:i.subscribe}}function tC(t){let n,r,i,a,s,u,c,l,h,f,p,d,b,C,S,k,P;return{c(){n=g("div"),r=g("div"),i=g("div"),a=g("div"),a.innerHTML='<div class="box box--rotate"><div class="box__face box__face--front"></div> \n                    <div class="box__face box__face--back"></div> \n                    <div class="box__face box__face--right"></div> \n                    <div class="box__face box__face--left"></div> \n                    <div class="box__face box__face--top"></div> \n                    <div class="box__face box__face--bottom"></div></div>',s=_(),u=g("div"),c=g("div"),l=g("div"),l.innerHTML='<div class="box box--rotate"><div class="box__face box__face--front"></div> \n                    <div class="box__face box__face--back"></div> \n                    <div class="box__face box__face--right"></div> \n                    <div class="box__face box__face--left"></div> \n                    <div class="box__face box__face--top"></div> \n                    <div class="box__face box__face--bottom"></div></div>',h=_(),f=g("div"),p=g("div"),d=g("div"),d.innerHTML='<div class="box box--rotate"><div class="box__face box__face--front"></div> \n                    <div class="box__face box__face--back"></div> \n                    <div class="box__face box__face--right"></div> \n                    <div class="box__face box__face--left"></div> \n                    <div class="box__face box__face--top"></div> \n                    <div class="box__face box__face--bottom"></div></div>',b=_(),C=g("div"),S=g("div"),k=g("div"),k.innerHTML='<div class="box box--rotate"><div class="box__face box__face--front"></div> \n                    <div class="box__face box__face--back"></div> \n                    <div class="box__face box__face--right"></div> \n                    <div class="box__face box__face--left"></div> \n                    <div class="box__face box__face--top"></div> \n                    <div class="box__face box__face--bottom"></div></div>',T(a,"class","scene scene--box"),T(i,"class","btn1"),E(i,"--x",uC(t[4],t[5])[0].x),E(i,"--y",uC(t[4],t[5])[0].y),T(r,"class","outerBtn1"),I(r,"active",t[0][0]),T(l,"class","scene scene--box"),T(c,"class","btn2"),E(c,"--x",uC(t[4],t[5])[1].x),E(c,"--y",uC(t[4],t[5])[1].y),T(u,"class","outerBtn2"),I(u,"active",t[0][1]),T(d,"class","scene scene--box"),T(p,"class","btn3"),E(p,"--x",uC(t[4],t[5])[2].x),E(p,"--y",uC(t[4],t[5])[2].y),T(f,"class","outerBtn3"),I(f,"active",t[0][2]),T(k,"class","scene scene--box"),T(S,"class","btn4"),E(S,"--x",uC(t[4],t[5])[3].x),E(S,"--y",uC(t[4],t[5])[3].y),T(C,"class","outerBtn4"),I(C,"active",t[0][3]),T(n,"id","controlsContainer"),E(n,"left",t[2].x),E(n,"top",t[2].y),E(n,"--scale",t[3].scale),I(n,"btnMode",t[1])},m(e,o){y(e,n,o),v(n,r),v(r,i),v(i,a),v(n,s),v(n,u),v(u,c),v(c,l),v(n,h),v(n,f),v(f,p),v(p,d),v(n,b),v(n,C),v(C,S),v(S,k),P=[w(r,"click",t[10]),w(u,"click",t[11]),w(f,"click",t[12]),w(C,"click",t[13])]},p(e,[t]){48&t&&E(i,"--x",uC(e[4],e[5])[0].x),48&t&&E(i,"--y",uC(e[4],e[5])[0].y),1&t&&I(r,"active",e[0][0]),48&t&&E(c,"--x",uC(e[4],e[5])[1].x),48&t&&E(c,"--y",uC(e[4],e[5])[1].y),1&t&&I(u,"active",e[0][1]),48&t&&E(p,"--x",uC(e[4],e[5])[2].x),48&t&&E(p,"--y",uC(e[4],e[5])[2].y),1&t&&I(f,"active",e[0][2]),48&t&&E(S,"--x",uC(e[4],e[5])[3].x),48&t&&E(S,"--y",uC(e[4],e[5])[3].y),1&t&&I(C,"active",e[0][3]),4&t&&E(n,"left",e[2].x),4&t&&E(n,"top",e[2].y),8&t&&E(n,"--scale",e[3].scale),2&t&&I(n,"btnMode",e[1])},i:e,o:e,d(e){e&&m(n),o(P)}}}const nC=eC({x:0,y:0},{duration:5e3}),rC=eC({x:0,y:0},{duration:5e3});let iC="floatOpening";const oC=le(!1),aC=le({x:0,y:0});function sC(e,t){nC.update(t=>({x:e,y:t.y+1})),rC.update(t=>({x:e,y:t.y+1}))}function uC(e,t){let n=e=>parseFloat((100*Math.sin(e)).toFixed(4)),r=e=>parseFloat((100*Math.cos(e)).toFixed(4));switch(iC){case"floatOpening":return[{x:"-33vw",y:`${r(e.y)-70+100}px`},{x:"-33vw",y:`${n(t.y+Math.PI/6)-70-100}px`},{x:" 33vw",y:`${r(e.y)-70+100}px`},{x:" 33vw",y:`${n(t.y+Math.PI/6)-70-100}px`}];case"btnMode":default:return[{x:"0",y:"0"},{x:"0",y:"0"},{x:"0",y:"0"},{x:"0",y:"0"}]}}let cC;function lC(e){switch(iC=e,"floatOpening"!=e&&(nC.set({x:0,y:0}),rC.set({x:0,y:0}),clearInterval(cC)),e){case"floatOpening":oC.set(!1),aC.set({x:"50vw",y:"50vh"}),sC(0),cC=setInterval(()=>{sC(0)},500);break;case"btnMode":oC.set(!0),aC.set({x:"50vw",y:"calc(100vh - 150px)"})}}function hC(e,t,n){let r,i,o,a,s,c,l;u(e,fe,e=>n(7,r=e)),u(e,he,e=>n(8,i=e)),u(e,oC,e=>n(1,o=e)),u(e,aC,e=>n(2,a=e)),u(e,me,e=>n(3,s=e)),u(e,nC,e=>n(4,c=e)),u(e,rC,e=>n(5,l=e));let{buttonsState:h=[!1,!1,!1,!1]}=t;async function f(e){r&&ge.run(i,e)}return e.$set=e=>{"buttonsState"in e&&n(0,h=e.buttonsState)},[h,o,a,s,c,l,f,r,i,[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],()=>f(0),()=>f(1),()=>f(2),()=>f(3)]}class fC extends ue{constructor(e){super(),se(this,e,hC,tC,s,{buttonsState:0})}}const pC=le("");function dC(e,t,n){const r=e.slice();return r[19]=t[n],r[20]=t,r[21]=n,r}function vC(e){let t,n,r,i,a,s,u,c,l,h,f,p,d,S,E,I,k,P,R,N=e[19].name+"";function x(){e[13].call(s,e[19])}function A(){e[15].call(h,e[19])}function D(){e[16].call(S,e[19])}return{c(){t=g("li"),n=g("span"),r=b(N),i=_(),a=g("div"),s=g("input"),l=_(),h=g("input"),d=_(),S=g("input"),P=_(),T(n,"class","svelte-gyuu60"),T(s,"watcher",u=e[19].name),T(s,"type","radio"),s.__value=c=0,s.value=s.__value,T(s,"class","svelte-gyuu60"),e[14][0].push(s),T(h,"watcher",f=e[19].name),T(h,"type","radio"),h.__value=p=1,h.value=h.__value,T(h,"class","svelte-gyuu60"),e[14][0].push(h),T(S,"watcher",E=e[19].name),T(S,"type","radio"),S.__value=I=2,S.value=S.__value,T(S,"class","svelte-gyuu60"),e[14][0].push(S),T(a,"style",k=`pointer-events: ${WT.isHost?"auto":"none"}`),T(t,"class","svelte-gyuu60")},m(o,u){y(o,t,u),v(t,n),v(n,r),v(t,i),v(t,a),v(a,s),s.checked=s.__value===e[19].controlLevel,v(a,l),v(a,h),h.checked=h.__value===e[19].controlLevel,v(a,d),v(a,S),S.checked=S.__value===e[19].controlLevel,v(t,P),R=[w(s,"change",e[6]),w(s,"change",x),w(h,"change",e[6]),w(h,"change",A),w(S,"change",e[6]),w(S,"change",D)]},p(t,n){e=t,2&n&&N!==(N=e[19].name+"")&&C(r,N),2&n&&u!==(u=e[19].name)&&T(s,"watcher",u),2&n&&(s.checked=s.__value===e[19].controlLevel),2&n&&f!==(f=e[19].name)&&T(h,"watcher",f),2&n&&(h.checked=h.__value===e[19].controlLevel),2&n&&E!==(E=e[19].name)&&T(S,"watcher",E),2&n&&(S.checked=S.__value===e[19].controlLevel)},d(n){n&&m(t),e[14][0].splice(e[14][0].indexOf(s),1),e[14][0].splice(e[14][0].indexOf(h),1),e[14][0].splice(e[14][0].indexOf(S),1),o(R)}}}function yC(e){let t,n,r,i,a,s,u,c,l,h,f,p;return{c(){t=g("div"),n=g("h2"),n.textContent="compartilhe o cdigo abaixo para outras pessoas entrarem na sua chamada",r=_(),i=g("div"),a=g("span"),a.textContent="clique para copiar",s=_(),u=g("div"),c=g("p"),l=b(e[5]),T(n,"class","svelte-gyuu60"),T(a,"class","svelte-gyuu60"),T(c,"class","svelte-gyuu60"),I(c,"active",e[3]),T(u,"class","svelte-gyuu60"),T(i,"class","svelte-gyuu60"),T(t,"class","copyPanel svelte-gyuu60")},m(o,h){y(o,t,h),v(t,n),v(t,r),v(t,i),v(i,a),v(i,s),v(i,u),v(u,c),v(c,l),f=!0,p=[w(c,"click",e[7]),w(t,"mouseleave",e[18])]},p(e,t){(!f||32&t)&&C(l,e[5]),8&t&&I(c,"active",e[3])},i(e){f||(B(()=>{h||(h=ne(t,qT,{},!0)),h.run(1)}),f=!0)},o(e){h||(h=ne(t,qT,{},!1)),h.run(0),f=!1},d(e){e&&m(t),e&&h&&h.end(),o(p)}}}function mC(e){let t,n,r,i,a,s,u,c,l,h,f,p,d,C,S,E,k,P,R=e[1],N=[];for(let t=0;t<R.length;t+=1)N[t]=vC(dC(e,R,t));let x=e[4]&&yC(e);return{c(){t=g("div"),n=g("video"),r=_(),i=g("div"),a=g("div"),a.innerHTML='<i class="fas fa-share fa-2x svelte-gyuu60"></i>',s=_(),u=g("div"),u.innerHTML='<i class="fas fa-user-friends fa-2x svelte-gyuu60"></i>',c=_(),l=g("div"),h=g("h2"),h.textContent="Participantes",f=_(),p=g("div"),p.innerHTML='<span class="svelte-gyuu60">Nome</span> \n            <span class="svelte-gyuu60">Nvel de Controle</span>',d=_(),C=g("ul");for(let e=0;e<N.length;e+=1)N[e].c();S=_(),x&&x.c(),E=b(""),T(n,"id","webcamVideo"),n.autoplay=!0,n.playsInline=!0,T(n,"class","svelte-gyuu60"),T(t,"class","flexColumn svelte-gyuu60"),T(a,"class","svelte-gyuu60"),T(u,"class","svelte-gyuu60"),T(i,"class","floatingIcons svelte-gyuu60"),T(h,"class","svelte-gyuu60"),T(p,"class","listHeader svelte-gyuu60"),T(C,"class","svelte-gyuu60"),T(l,"class","slideFromRightContainer svelte-gyuu60"),I(l,"open",e[2])},m(o,m){y(o,t,m),v(t,n),e[10](n),y(o,r,m),y(o,i,m),v(i,a),v(i,s),v(i,u),y(o,c,m),y(o,l,m),v(l,h),v(l,f),v(l,p),v(l,d),v(l,C);for(let e=0;e<N.length;e+=1)N[e].m(C,null);y(o,S,m),x&&x.m(o,m),y(o,E,m),k=!0,P=[w(a,"click",e[11]),w(u,"click",e[12]),w(l,"mouseleave",e[17])]},p(e,[t]){if(66&t){let n;for(R=e[1],n=0;n<R.length;n+=1){const r=dC(e,R,n);N[n]?N[n].p(r,t):(N[n]=vC(r),N[n].c(),N[n].m(C,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=R.length}4&t&&I(l,"open",e[2]),e[4]?x?(x.p(e,t),Z(x,1)):(x=yC(e),x.c(),Z(x,1),x.m(E.parentNode,E)):x&&(X(),ee(x,1,1,()=>{x=null}),J())},i(e){k||(Z(x),k=!0)},o(e){ee(x),k=!1},d(n){n&&m(t),e[10](null),n&&m(r),n&&m(i),n&&m(c),n&&m(l),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(N,n),n&&m(S),x&&x.d(n),n&&m(E),o(P)}}}function gC(e,t,n){let r,i,o;u(e,pC,e=>n(8,r=e)),u(e,pe,e=>n(5,i=e)),u(e,be,e=>n(9,o=e)),ye.assignFunction("main",()=>{console.log("%cPARECE QUE FOI!","color: purple;font-size: 20px")});let a=null;if(window.addEventListener("resize",()=>{let e=window.outerWidth;me.set({scale:e/880})}),0!=r.length)XT(r,e=>{n(0,a.srcObject=e,a)},e=>{if(!WT.isHost&&"users"==e.type){n(1,c=e.content);let t=c.filter(e=>e.id==i);t.length?t[0].controlLevel>0?lC("btnMode"):lC("floatOpening"):WT.peer.disconnect()}}),ge.assignFunction("main",e=>{if("number"!=typeof e)return;const t={type:"controls",from:WT.peer.id,content:e,displayName:UT.currentUser.displayName};WT.broadcast(JSON.stringify(t))}),WT.subscribeToAll("data",async e=>{try{let t=JSON.parse(e);"controlsState"==t.type&&be.update(e=>{for(let n=0;n<t.content.length;n++)e[n]=!!t.content[n];return e})}catch(e){}});else{lC("btnMode"),ge.assignFunction("main",async e=>{let t={0:3,1:2,2:1,3:0},n=VT.ref(`users/${i}/direction`),o=await n.get();o=o.val()||[0,0,0,0],o[e]=1==o[e]?0:1,1==o[t[e]]&&(o[t[e]]=1==o[e]?0:1),n.set(o);const a={type:"controlsState",from:WT.peer.id,content:o,displayName:r};WT.broadcast(JSON.stringify(a))}),WT.subscribeToAll("data",async e=>{try{let t=JSON.parse(e);if("controls"==t.type){if(!(1==c.filter(e=>e.id==t.from&&e.controlLevel>0).length))return;let e=t.content,n={0:3,1:2,2:1,3:0},o=VT.ref(`users/${i}/direction`),a=await o.get();a=a.val()||[0,0,0,0],a[e]=1==a[e]?0:1,1==a[n[e]]&&(a[n[e]]=1==a[e]?0:1),o.set(a);const s={type:"controlsState",from:WT.peer.id,content:a,displayName:r};WT.broadcast(JSON.stringify(s))}}catch(e){}}),VT.ref(`users/${i}/direction`).on("value",e=>{const t=e.val();t&&be.update(e=>{for(let n=0;n<t.length;n++)e[n]=!!t[n];return e})}),async function(e,t){if(KT instanceof GT==0)return void console.warn("peer is not defined yet");let n=await QT();WT.startPingRoutine(),WT.isHost=!0,console.log("i am hosting"),KT.on("call",e=>{e.answer(n),console.log(KT.connections)}),KT.on("connection",e=>{console.log("%cnew peer connected!","color: lightgreen"),e.on("data",n=>{try{let r=JSON.parse(n);if("pong"!=r.type){console.groupCollapsed(`data received from %c${r.displayName}%c - %c${r.type}`,"color: cyan","color: white","color: orange");for(let e of Object.keys(r))0==["type","from","displayName"].includes(e)&&(console.group(e),console.log(r[e]),console.groupEnd());console.groupEnd()}"handshake"==r.type&&WT.addConnection(e,r.displayName,r.from),t&&(t(r),WT.subscribeToAll("ping",t))}catch(e){console.error(`data received in wrong format from unknown peer: ${e}`)}})}),M("localStream",n),e(n)}(e=>{n(0,a.srcObject=e,a)},e=>{if(!WT.isHost)return;if(e&&"handshake"==e.type){const e={type:"controlsState",from:WT.peer.id,content:o.map(e=>e?1:0),displayName:r};WT.broadcast(JSON.stringify(e))}let t=[],i=[],a=Array.from(c);for(let e of WT.connections){a=a.filter(t=>t.id!=e.id);let n=!1;for(let r of c)if(r.id==e.id){n=!0,t.push(Object.assign({controlLevel:r.controlLevel},e));break}n||i.push(e)}n(1,c=[]);for(let e of[...t,...i])n(1,c=[...c,{name:e.displayName,id:e.id,controlLevel:"number"==typeof e.controlLevel?e.controlLevel:1}]);(i.length||a.length)&&s()})}function s(){if(!WT.isHost)return;this&&n(1,c=c.map(e=>e.name==this.getAttribute("watcher")?(e.controlLevel=parseInt(this.value),e):e));const e={type:"users",from:i,content:c};WT.broadcast(JSON.stringify(e))}let c=[],l=!1,h=!1;let f=!1;return[a,c,l,h,f,i,s,function(){n(3,h=!0),navigator.clipboard.writeText(this.innerText).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)})),setTimeout(()=>{n(3,h=!1)},800)},r,o,function(e){F[e?"unshift":"push"](()=>{n(0,a=e)})},()=>n(4,f=!0),()=>n(2,l=!0),function(e){e.controlLevel=this.__value,n(1,c)},[[]],function(e){e.controlLevel=this.__value,n(1,c)},function(e){e.controlLevel=this.__value,n(1,c)},()=>n(2,l=!1),()=>n(4,f=!1)]}class bC extends ue{constructor(e){super(),se(this,e,gC,mC,s,{})}}function _C(e){let t,n,r;return{c(){t=g("div"),t.innerHTML='<div class="svelte-1uwdsae"><h1 class="title">Remote Camera</h1></div>',T(t,"class","svelte-1uwdsae")},m(e,n){y(e,t,n),r=!0},i(e){r||(B(()=>{n||(n=ne(t,qT,{},!0)),n.run(1)}),r=!0)},o(e){n||(n=ne(t,qT,{},!1)),n.run(0),r=!1},d(e){e&&m(t),e&&n&&n.end()}}}function wC(e){let t,n,r,i;const o=new bC({});return{c(){t=g("div"),n=g("div"),re(o.$$.fragment),T(n,"class","svelte-1uwdsae"),T(t,"class","svelte-1uwdsae")},m(e,r){y(e,t,r),v(t,n),ie(o,n,null),i=!0},i(e){i||(Z(o.$$.fragment,e),B(()=>{r||(r=ne(t,qT,{},!0)),r.run(1)}),i=!0)},o(e){ee(o.$$.fragment,e),r||(r=ne(t,qT,{},!1)),r.run(0),i=!1},d(e){e&&m(t),oe(o),e&&r&&r.end()}}}function TC(e){let t,n,r,i,s,u,c,l,h,f,p,d,b,C,S,E,k,P,R,N;const x=[wC,_C],A=[];function D(e,t){return e[2]?0:1}return E=D(e),k=A[E]=x[E](e),{c(){t=g("div"),n=g("div"),r=g("div"),r.innerHTML='<i class="fas fa-cog fa-2x"></i>',i=_(),s=g("ul"),u=g("li"),u.textContent="Perfil",c=_(),l=g("li"),l.textContent="Configuraes",h=_(),f=g("li"),f.textContent="Log out",p=_(),d=g("div"),b=g("div"),b.innerHTML='<i class="fas fa-arrow-left fa-2x"></i>',C=_(),S=g("div"),k.c(),T(r,"id","configBtn"),T(l,"id","cameraConfigBtn"),T(f,"id","logoutBtn"),T(s,"id","configItems"),T(n,"class","configContainer svelte-1uwdsae"),I(n,"disabled",e[0]),T(b,"class","backBtn"),T(d,"class","backContainer svelte-1uwdsae"),I(d,"disabled",!e[1]||!e[0]),T(S,"class","header svelte-1uwdsae"),T(t,"class","topContent svelte-1uwdsae")},m(o,m){y(o,t,m),v(t,n),v(n,r),v(n,i),v(n,s),v(s,u),v(s,c),v(s,l),v(s,h),v(s,f),v(t,p),v(t,d),v(d,b),v(t,C),v(t,S),A[E].m(S,null),R=!0,N=[w(l,"click",(function(){a(ye.run(e[3]))&&ye.run(e[3]).apply(this,arguments)})),w(f,"click",e[9]),w(b,"click",e[4])]},p(t,[r]){e=t,1&r&&I(n,"disabled",e[0]),3&r&&I(d,"disabled",!e[1]||!e[0]);let i=E;E=D(e),E!==i&&(X(),ee(A[i],1,1,()=>{A[i]=null}),J(),k=A[E],k||(k=A[E]=x[E](e),k.c()),Z(k,1),k.m(S,null))},i(e){R||(Z(k),B(()=>{P||(P=ne(t,qT,{},!0)),P.run(1)}),R=!0)},o(e){ee(k),P||(P=ne(t,qT,{},!1)),P.run(0),R=!1},d(e){e&&m(t),A[E].d(),e&&P&&P.end(),o(N)}}}function CC(e,t){de.update(n=>{let r=!1;return n.map(n=>n[0]==e?(r=!0,[e,t]):n),1==r||n.push([e,t]),n})}function SC(e,t,n){let r,i;u(e,he,e=>n(3,r=e)),u(e,de,e=>n(5,i=e));let o=!0,a=!1,s=!1,c=["login","cameraOwner","selectCameraToConnect"],l=["cameraOwner","selectCameraToConnect"],h=document.body;he.subscribe(e=>{-1!=c.indexOf(e)?n(0,o=!0):n(0,o=!1),-1!=l.indexOf(e)?n(1,a=!0):n(1,a=!1)});return e.$$.update=()=>{8&e.$$.dirty&&n(2,s="main"==r),8&e.$$.dirty&&("main"==r?h.classList.add("videoEnabled"):h.classList.remove("videoEnabled"))},[o,a,s,r,function(){for(let e of i)e[0]==r&&e[1]()},i,c,l,h,()=>UT.signOut()]}class EC extends ue{constructor(e){super(),se(this,e,SC,TC,s,{})}}function IC(e){let t,n,r;return{c(){t=g("p"),t.textContent="credenciais incorretas",T(t,"class","warning svelte-1gofwly")},m(e,n){y(e,t,n),r=!0},i(e){r||(B(()=>{n||(n=ne(t,qT,{duration:200},!0)),n.run(1)}),r=!0)},o(e){n||(n=ne(t,qT,{duration:200},!1)),n.run(0),r=!1},d(e){e&&m(t),e&&n&&n.end()}}}function kC(e){let t,n,r,i,a,s,u,c,l,h,f=e[1]&&IC();return{c(){t=g("div"),f&&f.c(),n=_(),r=g("div"),i=g("div"),a=g("input"),s=_(),u=g("div"),u.innerHTML="<p>Login</p>",T(a,"type","text"),T(a,"placeholder","Nome de Usurio"),T(a,"class","transparentInput svelte-1gofwly"),T(i,"class","inputWrapper svelte-1gofwly"),I(i,"wrongCredentials",e[1]),T(u,"class","transparentBtn"),T(r,"class","flexColumn svelte-1gofwly"),T(t,"id","login-form"),E(t,"position","absolute"),T(t,"class","svelte-1gofwly")},m(o,c){y(o,t,c),f&&f.m(t,null),v(t,n),v(t,r),v(r,i),v(i,a),S(a,e[0]),v(r,s),v(r,u),l=!0,h=[w(a,"input",e[3]),w(u,"click",e[2])]},p(e,[r]){e[1]?f?Z(f,1):(f=IC(),f.c(),Z(f,1),f.m(t,n)):f&&(X(),ee(f,1,1,()=>{f=null}),J()),1&r&&a.value!==e[0]&&S(a,e[0]),2&r&&I(i,"wrongCredentials",e[1])},i(e){l||(Z(f),B(()=>{c||(c=ne(t,qT,{},!0)),c.run(1)}),l=!0)},o(e){ee(f),c||(c=ne(t,qT,{},!1)),c.run(0),l=!1},d(e){e&&m(t),f&&f.d(),e&&c&&c.end(),o(h)}}}function PC(e,t,n){let r="",i=!1;return[r,i,function(){UT.signInAnonymously().then(()=>{UT.currentUser.updateProfile({displayName:r}).catch(e=>{console.error(e)})}).catch(e=>{var t=e.code,r=e.message;console.error(t+"\n"+r),n(1,i=!0)})},function(){r=this.value,n(0,r)}]}class RC extends ue{constructor(e){super(),se(this,e,PC,kC,s,{})}}function NC(e){let t,n,r,i;return{c(){t=g("p"),n=b(e[0]),T(t,"class","warningText svelte-14i8abj")},m(e,r){y(e,t,r),v(t,n),i=!0},p(e,t){(!i||1&t)&&C(n,e[0])},i(e){i||(B(()=>{r||(r=ne(t,qT,{},!0)),r.run(1)}),i=!0)},o(e){r||(r=ne(t,qT,{},!1)),r.run(0),i=!1},d(e){e&&m(t),e&&r&&r.end()}}}function xC(e){let t,n,r,i,a,s,u,c,l,h=e[0]&&NC(e);return{c(){t=g("div"),n=g("div"),r=g("div"),r.innerHTML='<p class="svelte-14i8abj">Utilizar a prpria cmera</p>',i=_(),a=g("div"),a.innerHTML="<p>Conectar a uma cmera</p>",u=_(),h&&h.c(),T(r,"class","transparentBtn svelte-14i8abj"),I(r,"disabledBtn",e[0]),T(a,"class","transparentBtn"),T(n,"id","cameraOwner"),T(n,"class","container"),T(t,"class","flexColumn svelte-14i8abj"),E(t,"position","absolute")},m(o,s){y(o,t,s),v(t,n),v(n,r),v(n,i),v(n,a),v(t,u),h&&h.m(t,null),c=!0,l=[w(r,"click",e[3]),w(a,"click",e[4])]},p(e,[n]){1&n&&I(r,"disabledBtn",e[0]),e[0]?h?(h.p(e,n),Z(h,1)):(h=NC(e),h.c(),Z(h,1),h.m(t,null)):h&&(X(),ee(h,1,1,()=>{h=null}),J())},i(e){c||(B(()=>{s||(s=ne(n,qT,{},!0)),s.run(1)}),Z(h),c=!0)},o(e){s||(s=ne(n,qT,{},!1)),s.run(0),ee(h),c=!1},d(e){e&&m(t),e&&s&&s.end(),h&&h.d(),o(l)}}}function AC(e,t,n){CC("cameraOwner",()=>{UT.signOut(),console.log("signing out")});let r=[];const i=()=>{navigator.mediaDevices.enumerateDevices().then(e=>{n(1,r=[]);for(let t of e)"videoinput"==t.kind&&r.push(t);0==r.length&&n(0,o="Nenhuma camra detectada")})};setInterval(i,2e3),i();let o="";return e.$$.update=()=>{2&e.$$.dirty&&r.length>0&&n(0,o="")},[o,r,i,()=>{o||he.set("main")},()=>he.set("selectCameraToConnect")]}class DC extends ue{constructor(e){super(),se(this,e,AC,xC,s,{})}}function OC(e){let t,n,r,i,a,s,u,c,l;return{c(){t=g("div"),n=g("h3"),n.textContent="A quem voc deseja se conectar?",r=_(),i=g("input"),a=_(),s=g("div"),s.innerHTML="<p>Prximo</p>",T(n,"class","svelte-12sbr24"),T(i,"type","text"),T(i,"class","transparentInput svelte-12sbr24"),T(i,"placeholder","Digite Aqui"),T(s,"class","transparentBtn"),E(t,"position","absolute"),T(t,"class","container svelte-12sbr24")},m(o,u){y(o,t,u),v(t,n),v(t,r),v(t,i),S(i,e[0]),v(t,a),v(t,s),c=!0,l=[w(i,"input",e[2]),w(s,"click",e[1])]},p(e,[t]){1&t&&i.value!==e[0]&&S(i,e[0])},i(e){c||(B(()=>{u||(u=ne(t,qT,{},!0)),u.run(1)}),c=!0)},o(e){u||(u=ne(t,qT,{},!1)),u.run(0),c=!1},d(e){e&&m(t),e&&u&&u.end(),o(l)}}}function MC(e,t,n){let r="";return CC("selectCameraToConnect",()=>{he.set("cameraOwner"),console.log("changing to cameraOwner")}),[r,function(){pC.set(r),he.set("main")},function(){r=this.value,n(0,r)}]}class LC extends ue{constructor(e){super(),se(this,e,MC,OC,s,{})}}function FC(e){let t;const n=new LC({});return{c(){re(n.$$.fragment)},m(e,r){ie(n,e,r),t=!0},i(e){t||(Z(n.$$.fragment,e),t=!0)},o(e){ee(n.$$.fragment,e),t=!1},d(e){oe(n,e)}}}function jC(e){let t;const n=new DC({});return{c(){re(n.$$.fragment)},m(e,r){ie(n,e,r),t=!0},i(e){t||(Z(n.$$.fragment,e),t=!0)},o(e){ee(n.$$.fragment,e),t=!1},d(e){oe(n,e)}}}function UC(e){let t;const n=new RC({});return{c(){re(n.$$.fragment)},m(e,r){ie(n,e,r),t=!0},i(e){t||(Z(n.$$.fragment,e),t=!0)},o(e){ee(n.$$.fragment,e),t=!1},d(e){oe(n,e)}}}function VC(e){let t,n,r,i,o,a,s,u;const c=new EC({}),l=[UC,jC,FC],h=[];function f(e,t){return"login"==e[0]?0:"cameraOwner"==e[0]?1:"selectCameraToConnect"==e[0]?2:-1}~(o=f(e))&&(a=h[o]=l[o](e));const p=new fC({props:{buttonsState:e[1]}});return{c(){t=g("div"),t.innerHTML='<div class="circle" style="--size: 500px; --left: 5; --order: 5;"></div> \n  <div class="circle" style="--size: 400px; --left: 2; --order: 4;"></div> \n  <div class="circle" style="--size: 300px; --left: 3; --order: 3;"></div> \n  <div class="" style="--size: 200px; --left: 1; --order: 2;"></div> \n  <div class="circle" style="--size: 100px; --left: 4; --order: 2.5;"></div> \n  <div style="--size: 100px; --left: 4; --order: 2.5;"></div>',n=_(),re(c.$$.fragment),r=_(),i=g("div"),a&&a.c(),s=_(),re(p.$$.fragment),T(t,"class","shapes"),T(i,"class","midContent")},m(e,a){y(e,t,a),y(e,n,a),ie(c,e,a),y(e,r,a),y(e,i,a),~o&&h[o].m(i,null),v(i,s),ie(p,i,null),u=!0},p(e,[t]){let n=o;o=f(e),o!==n&&(a&&(X(),ee(h[n],1,1,()=>{h[n]=null}),J()),~o?(a=h[o],a||(a=h[o]=l[o](e),a.c()),Z(a,1),a.m(i,s)):a=null);const r={};2&t&&(r.buttonsState=e[1]),p.$set(r)},i(e){u||(Z(c.$$.fragment,e),Z(a),Z(p.$$.fragment,e),u=!0)},o(e){ee(c.$$.fragment,e),ee(a),ee(p.$$.fragment,e),u=!1},d(e){e&&m(t),e&&m(n),oe(c,e),e&&m(r),e&&m(i),~o&&h[o].d(),oe(p)}}}function qC(e,t,n){let r,i,o;return u(e,pe,e=>n(2,r=e)),u(e,he,e=>n(0,i=e)),u(e,be,e=>n(1,o=e)),lC("floatOpening"),UT.onAuthStateChanged(e=>{e?(fe.set(!0),pe.set(e.uid),he.set("cameraOwner"),console.log(r)):(fe.set(!1),pe.set(null),lC("floatOpening"),he.set("login"))}),[i,o]}return new class extends ue{constructor(e){super(),se(this,e,qC,VC,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
